(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    422730,      11067]
NotebookOptionsPosition[    419204,      11004]
NotebookOutlinePosition[    419603,      11020]
CellTagsIndexPosition[    419560,      11017]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Double Schwarzschild solution", "Title",
 CellChangeTimes->{{3.887585850792977*^9, 
  3.887585861839162*^9}},ExpressionUUID->"fc423760-45d4-40f3-aabe-\
a95f96d1c21d"],

Cell[CellGroupData[{

Cell["Pacchetto EDCRGTCcode (evaluate if not installed)", "Section",
 CellChangeTimes->{{3.808895557102236*^9, 3.808895582117584*^9}, {
  3.828390231898506*^9, 3.828390273581134*^9}, {3.8875857923943377`*^9, 
  3.887585793651283*^9}},ExpressionUUID->"fd81dfb5-26cd-4d84-81af-\
14ec576f95e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"::", "Package", "::"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
  "(*", "***********************************************************************)"}\
], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "file", " ", "was", " ", "generated", " ", "automatically", 
    " ", "by", " ", "the", " ", "Mathematica", " ", "front", " ", 
    RowBox[{"end", "."}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "It", " ", "contains", " ", "Initialization", " ", "cells", " ", "from", 
     " ", "a", " ", "Notebook", " ", "file"}], ",", "which"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "typically", " ", "will", " ", "have", " ", "the", " ", "same", " ", 
    "name", " ", "as", " ", "this", " ", "file", " ", "except", " ", "ending",
     " ", "in"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"\"\<.nb\>\"", " ", "instead", " ", "of", " ", 
    RowBox[{"\"\<.m\>\"", "."}]}], "*)"}], 
  RowBox[{"(*", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "file", " ", "is", " ", "intended", " ", "to", " ", "be", " ",
     "loaded", " ", "into", " ", "the", " ", "Mathematica", " ", "kernel", 
    " ", "using"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "package", " ", "loading", " ", "commands", " ", "Get", " ", 
    "or", " ", 
    RowBox[{"Needs", ".", "Doing"}], " ", "so", " ", "is", " ", 
    "equivalent"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "to", " ", "using", " ", "the", " ", "Evaluate", " ", "Initialization", 
    " ", "Cells", " ", "menu", " ", "command", " ", "in", " ", "the", " ", 
    "front"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"end", "."}], "*)"}], 
  RowBox[{"(*", "*)"}], 
  RowBox[{"(*", 
   RowBox[{"DO", " ", "NOT", " ", "EDIT", " ", "THIS", " ", 
    RowBox[{"FILE", ".", "This"}], " ", "entire", " ", "file", " ", "is", " ",
     "regenerated"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "automatically", " ", "each", " ", "time", " ", "the", " ", "parent", " ", 
    "Notebook", " ", "file", " ", "is", " ", "saved", " ", "in", " ", "the"}],
    "*)"}], 
  RowBox[{"(*", 
   RowBox[{"Mathematica", " ", "front", " ", 
    RowBox[{"end", ".", "Any"}], " ", "changes", " ", "you", " ", "make", " ",
     "to", " ", "this", " ", "file", " ", "will", " ", "be"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"overwritten", "."}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
  "(*", "***********************************************************************)"}\
], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{
      RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
      RowBox[{"General", "::", "\"\<spell1\>\""}], ",", 
      RowBox[{"Remove", "::", "\"\<rmnsm\>\""}], ",", 
      RowBox[{"UpSet", "::", "\"\<write\>\""}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Unprotect", "[", "\"\<Global`*\>\"", "]"}], ";", 
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";", 
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";", 
    RowBox[{"Unprotect", "[", "$", "]"}], ";", 
    RowBox[{"ClearAll", "[", 
     RowBox[{"Wedge", ",", "K", ",", "$"}], "]"}], ";", 
    RowBox[{"Protect", "[", "$", "]"}], ";", 
    RowBox[{"Unprotect", "[", 
     RowBox[{"In", ",", "Out"}], "]"}], ";", 
    RowBox[{"Clear", "[", 
     RowBox[{"In", ",", "Out"}], "]"}], ";", 
    RowBox[{"Protect", "[", 
     RowBox[{"In", ",", "Out"}], "]"}], ";", 
    RowBox[{"$Line", "=", "0"}], ";", 
    RowBox[{"$RecursionLimit", "=", "256"}], ";", 
    RowBox[{"$IterationLimit", "=", "4096"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Forms", "[", "i_", "]"}], ":=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"AllScalForms", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{
     RowBox[{"matForms", "[", "i_", "]"}], ":=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"AllMatForms", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"AllDifForms", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"AllMatrices", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"AllSymbols", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"FormVars", "=", 
     RowBox[{"{", 
      RowBox[{"_Wedge", ",", "_d"}], "}"}]}], ";", 
    RowBox[{"ZeroVars", "=", 
     RowBox[{"{", 
      RowBox[{"_Wedge", ",", "_tr"}], "}"}]}], ";", 
    RowBox[{"HeadList", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"ScalHeadList", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"MatFormHeadList", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"ZeroHeads", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"AllMatHeads", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"nodHeads", "=", 
     RowBox[{"{", 
      RowBox[{
      "tr", ",", "Bar", ",", "Pattern", ",", "Blank", ",", "Condition", ",", 
       "RuleDelayed", ",", "SeriesData"}], "}"}]}], ";", 
    RowBox[{"$EDCversion", "=", "389"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"zeroQ", "[", "0", "]"}], "=", "True"}], ";", 
    RowBox[{
     RowBox[{"zeroQ", "[", "x_List", "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"zeroQ", "/@", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", "x", "]"}], "]"}]}], ")"}]}]}], ";", 
    RowBox[{
     RowBox[{"zeroQ", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", "True", ",", "False"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"zeroQ", "[", "x_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"indepTerms", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"opt_", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", 
       RowBox[{"x", "/.", 
        RowBox[{"_Wedge", "\[Rule]", "1"}]}], "]"}], ",", 
      RowBox[{"reWrite", "[", 
       RowBox[{"indep$cTerms", "[", 
        RowBox[{
         RowBox[{"Factor", "[", "x", "]"}], ",", "opt"}], "]"}], "]"}], ",", 
      RowBox[{"indep$cTerms", "[", 
       RowBox[{"x", ",", "opt"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"indepCoefs", "[", "y_", "]"}], ":=", 
     RowBox[{"indepTerms", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "y", "]"}], ">", "0"}], "||", 
         RowBox[{"MatQ", "[", "y", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#1", "\[Wedge]", "$", "\[Wedge]", "$"}], "&"}], ")"}], 
            "/@", 
            RowBox[{"indepTerms", "[", "y", "]"}]}], "//.", 
           RowBox[{
            RowBox[{
             RowBox[{"a_Wedge", " ", "x_"}], "+", 
             RowBox[{"(", 
              RowBox[{"z_", ":", "Null"}], ")"}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "z"}], "}"}]}]}], "]"}], "/.", 
         RowBox[{"Null", "\[Rule]", 
          RowBox[{"Sequence", "[", "]"}]}]}], ",", "y"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"Bar", ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", "Blank", "]"}], "=", "Blank"}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", "x"}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
     RowBox[{"Complex", "[", 
      RowBox[{"x", ",", 
       RowBox[{"-", "y"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{
      "x_Plus", "|", "x_Times", "|", "x_Wedge", "|", "x_Power", "|", "x_Rule",
        "|", "x_Equal"}], "]"}], ":=", 
     RowBox[{"Bar", "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", "x"}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", "x_RuleDelayed", "]"}], ":=", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"Bar", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Bar", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "/.", 
      RowBox[{"Rule", "\[Rule]", "RuleDelayed"}]}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "x", "]"}], "\[Rule]", 
         RowBox[{"Bar", "[", 
          RowBox[{"First", "[", "x", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
         RowBox[{"Bar", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
         RowBox[{"Bar", "/@", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{"DirectedInfinity", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"DirectedInfinity", "[", 
      RowBox[{"Bar", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"tr", "[", "x_", "]"}], "]"}], "]"}], ":=", 
     RowBox[{"tr", "[", 
      RowBox[{"Bar", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{"d", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"d", "[", 
      RowBox[{"Bar", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", "x_Condition", "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Bar", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "x__", "]"}], "[", "y_", "]"}], "[", "z__",
        "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Bar", "[", 
          RowBox[{"{", "z", "}"}], "]"}], "]"}], "===", 
        RowBox[{"Union", "[", 
         RowBox[{"{", "z", "}"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "x", "}"}], ".", 
              RowBox[{"{", "z", "}"}]}], ",", 
             RowBox[{"Bar", "[", 
              RowBox[{"{", "z", "}"}], "]"}]}], "]"}]}], "]"}], "[", 
         RowBox[{"Bar", "[", "y", "]"}], "]"}], "[", "z", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", "x", "]"}], "[", 
         RowBox[{"Bar", "[", "y", "]"}], "]"}], "[", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Bar", "[", 
          RowBox[{"{", "z", "}"}], "]"}]}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Bar", "[", 
      RowBox[{
       RowBox[{"h_", "[", "y__", "]"}], "/;", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"nodHeads", ",", "h"}], "]"}], "&&", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"h", ",", "Derivative"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Bar", "[", 
           RowBox[{"{", "y", "}"}], "]"}], "]"}], "===", 
         RowBox[{"Union", "[", 
          RowBox[{"{", "y", "}"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Bar", "[", "h", "]"}], "[", "y", "]"}], ",", 
        RowBox[{
         RowBox[{"Bar", "[", "h", "]"}], "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Bar", "[", 
           RowBox[{"{", "y", "}"}], "]"}]}], "]"}]}], "]"}], "/;", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "Integer", ",", "Blank", ",", "BlankSequence", ",", "Pattern", ",", 
          "Condition"}], "}"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"First", "[", 
          RowBox[{"{", "y", "}"}], "]"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Qvalue", "[", "x_List", "]"}], ":=", 
    RowBox[{"Length", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"OrderedQ", "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"Rest", "[", "x", "]"}]}], "}"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"#", "===", "False"}], "&"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"AllCaseTable", "[", "x_List", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rvstr", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Transpose", ",", "x"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"-", "z_"}], "\[RuleDelayed]", "z"}]}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"traceOption", "===", "2"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Qvalue", "[", 
               RowBox[{"RotateLeft", "[", 
                RowBox[{"x", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"RotateLeft", "[", 
               RowBox[{"x", ",", "i"}], "]"}], ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Qvalue", "[", 
               RowBox[{"RotateRight", "[", 
                RowBox[{"rvstr", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"RotateRight", "[", 
               RowBox[{"rvstr", ",", "i"}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", "i"}], "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qvalue", "[", 
             RowBox[{"RotateLeft", "[", 
              RowBox[{"x", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"RotateLeft", "[", 
             RowBox[{"x", ",", "i"}], "]"}], ",", "i"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"bestOrd", "[", "x_List", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp$", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"AllCaseTable", "[", "x", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"tmp$", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"tmp$", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "===", 
             RowBox[{"tmp$", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "tmp$", "]"}], ">", "1"}], ",", 
          RowBox[{"First", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"tmp$", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "===", 
                 RowBox[{"tmp$", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}]}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "<", 
               RowBox[{"Abs", "[", 
                RowBox[{"Last", "[", "#2", "]"}], "]"}]}], "&"}]}], "]"}], 
           "]"}], ",", 
          RowBox[{"First", "[", "tmp$", "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"splitFDprod", "[", 
      RowBox[{"n_", ",", "FDx_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Take", "[", 
         RowBox[{"FDx", ",", "n"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Drop", "[", 
         RowBox[{"FDx", ",", "n"}], "]"}]}], ")"}]}]}], ";", 
    RowBox[{
     RowBox[{"allFDprods", "[", "FDx_List", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FDx", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Drop", "[", 
           RowBox[{"FDx", ",", "i"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "FDx", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"traceOption", "=", "2"}], ";", 
    RowBox[{
     RowBox[{"tr", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"FacSimp", "[", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}], "/;", 
      RowBox[{"MatrixQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", "x_Plus", "]"}], ":=", 
     RowBox[{"tr", "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
         RowBox[{"tr", "/@", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
         RowBox[{"{", "}"}]}]}], ")"}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"x__", " ", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", " ", 
        RowBox[{"tr", "[", "y", "]"}]}], ")"}], "/;", 
      RowBox[{"!", 
       RowBox[{"MatQ", "[", "x", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"d", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"d", "[", 
      RowBox[{"tr", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"x__", "\[Wedge]", "y__"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "\[Wedge]", 
        RowBox[{"tr", "[", 
         RowBox[{"Wedge", "[", "y", "]"}], "]"}]}], ")"}], "/;", 
      RowBox[{"ScalFormQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"tr", "[", "x", "]"}], "=", "0"}], ")"}], "/;", 
      RowBox[{"AntisymQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evalHx", "=", 
         RowBox[{"tr", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Bar", "[", "evalHx", "]"}], "/;", 
        RowBox[{
         RowBox[{"Head", "[", "evalHx", "]"}], "=!=", "tr"}]}]}], "]"}]}], 
    ";", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"x_Wedge", "/;", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Head", "/@", 
          RowBox[{"Level", "[", 
           RowBox[{"x", ",", "1"}], "]"}]}], "]"}], "===", 
        RowBox[{"{", "Bar", "}"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evalHx", "=", 
         RowBox[{"tr", "[", 
          RowBox[{"Bar", "/@", "x"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Bar", "[", "evalHx", "]"}], "/;", 
        RowBox[{
         RowBox[{"Head", "[", "evalHx", "]"}], "=!=", "tr"}]}]}], "]"}]}], 
    ";", 
    RowBox[{
     RowBox[{"tr", "[", "x_Wedge", "]"}], ":=", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"inpList", "=", 
           RowBox[{"List", "@@", "x"}]}], ",", "resList", ",", "FDx"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"resList", "=", 
          RowBox[{"bestOrd", "[", "inpList", "]"}]}], ";", 
         RowBox[{"FDx", "=", 
          RowBox[{"FormDegree", "/@", "inpList"}]}], ";", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "resList", "]"}], ">", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"splitFDprod", "[", 
              RowBox[{
               RowBox[{"Last", "[", "resList", "]"}], ",", "FDx"}], "]"}]}], 
            RowBox[{"tr", "[", 
             RowBox[{"Wedge", "@@", 
              RowBox[{"resList", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Last", "[", "resList", "]"}], "===", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"allFDprods", "[", "FDx", "]"}], "+", 
               RowBox[{"Length", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{"inpList", ",", "AntisymQ"}], "]"}], "]"}]}], 
              ")"}]}], 
            RowBox[{"tr", "[", 
             RowBox[{"Wedge", "@@", 
              RowBox[{"resList", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Last", "[", "resList", "]"}], "<", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"allFDprods", "[", "FDx", "]"}], "+", 
               RowBox[{"splitFDprod", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"1", "+", 
                   RowBox[{"Last", "[", "resList", "]"}]}], "]"}], ",", 
                 "FDx"}], "]"}], "+", 
               RowBox[{"Length", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{"inpList", ",", "AntisymQ"}], "]"}], "]"}]}], 
              ")"}]}], 
            RowBox[{"tr", "[", 
             RowBox[{"Wedge", "@@", 
              RowBox[{"resList", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], "]"}], 
      "/;", 
      RowBox[{
       RowBox[{"traceOption", ">", "0"}], "&&", 
       RowBox[{
        RowBox[{
         RowBox[{"bestOrd", "[", 
          RowBox[{"List", "@@", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=!=", 
        RowBox[{"List", "@@", "x"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"x__", "\[Wedge]", "y__"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"tr", "[", 
         RowBox[{"x", "\[Wedge]", "y"}], "]"}], "=", "0"}], ")"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SymQ", "[", 
          RowBox[{"Wedge", "[", "x", "]"}], "]"}], "&&", 
         RowBox[{"AntisymQ", "[", 
          RowBox[{"Wedge", "[", "y", "]"}], "]"}]}], "||", 
        RowBox[{
         RowBox[{"SymQ", "[", 
          RowBox[{"Wedge", "[", "y", "]"}], "]"}], "&&", 
         RowBox[{"AntisymQ", "[", 
          RowBox[{"Wedge", "[", "x", "]"}], "]"}]}]}], ")"}]}]}], ";", 
    RowBox[{
     RowBox[{"tr", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"x", " ", "matDimension"}], "/;", 
      RowBox[{"!", 
       RowBox[{"MatQ", "[", "x", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"toComponents", "[", 
      RowBox[{
       RowBox[{"x_", "+", "y_"}], ",", "rul_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"toComponents", "[", 
       RowBox[{"x", ",", "rul"}], "]"}], "+", 
      RowBox[{"toComponents", "[", 
       RowBox[{"y", ",", "rul"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"toComponents", "[", 
      RowBox[{
       RowBox[{"x_.", "*", "y_"}], ",", "rul_"}], "]"}], ":=", 
     RowBox[{"reWrite", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatQ", "[", 
          RowBox[{"x", "*", "y"}], "]"}], ",", 
         RowBox[{"x", "*", "y"}], ",", 
         RowBox[{"x", "*", "y", "*", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IntegerQ", "[", "matDimension", "]"}], ",", 
             "matDimension", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ")"}], "/@", 
                  "rul"}], ",", "MatrixQ"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
        "]"}], "/.", "rul"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"toComponents", "[", 
      RowBox[{
       RowBox[{"x_", "\[Wedge]", "y_"}], ",", "rul_"}], "]"}], ":=", 
     RowBox[{"reWrite", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatQ", "[", 
          RowBox[{"x", "\[Wedge]", "y"}], "]"}], ",", 
         RowBox[{"x", "\[Wedge]", "y"}], ",", 
         RowBox[{
          RowBox[{"x", "\[Wedge]", "y"}], "*", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IntegerQ", "[", "matDimension", "]"}], ",", 
             "matDimension", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ")"}], "/@", 
                  "rul"}], ",", "MatrixQ"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
        "]"}], "/.", "rul"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FormDegree", "[", "x_Plus", "]"}], ":=", 
     RowBox[{"FormDegree", "[", 
      RowBox[{"First", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x_Times", "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"FormDegree", "/@", 
       RowBox[{"List", "@@", "x"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x_Wedge", "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"FormDegree", "/@", 
       RowBox[{"List", "@@", "x"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", 
      RowBox[{"d", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FormDegree", "[", 
       RowBox[{"d", "[", "x", "]"}], "]"}], "=", 
      RowBox[{"1", "+", 
       RowBox[{"FormDegree", "[", "x", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x_List", "]"}], ":=", 
     RowBox[{"FormDegree", "[", 
      RowBox[{"Last", "[", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", 
      RowBox[{"tr", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"FormDegree", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FormDegree", "[", 
       RowBox[{"Bar", "[", "x", "]"}], "]"}], "=", 
      RowBox[{"FormDegree", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", "0", ",", 
       RowBox[{"FormDegree", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"FormDegree", "[", "x_", "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{"x_List", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FormCoef", "[", 
         RowBox[{"#", ",", "y"}], "]"}], "&"}], ")"}], "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{"x_Plus", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FormCoef", "[", 
         RowBox[{"#1", ",", "y"}], "]"}], "&"}], ")"}], "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{
       RowBox[{"x_.", "*", "y_"}], ",", "y_"}], "]"}], ":=", "x"}], ";", 
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{"x_", ",", "y_Wedge"}], "]"}], ":=", 
     RowBox[{"Fold", "[", 
      RowBox[{"FormCoef", ",", "x", ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"List", "@@", "y"}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"d", "[", "y", "]"}], "\[Rule]", 
          RowBox[{"d", "[", "$J$", "]"}]}]}], ",", "y"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "/.", 
             RowBox[{
              RowBox[{"d", "[", "y", "]"}], "\[Rule]", 
              RowBox[{"d", "[", "$J$", "]"}]}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "/.", 
              RowBox[{
               RowBox[{"d", "[", "y", "]"}], "\[Rule]", 
               RowBox[{"d", "[", "$J$", "]"}]}]}], "/.", 
             RowBox[{"y", "\[Rule]", "0"}]}], ")"}]}], ")"}], "/.", 
         RowBox[{"y", "\[Rule]", "1"}]}], "/.", 
        RowBox[{
         RowBox[{"d", "[", "$J$", "]"}], "\[Rule]", 
         RowBox[{"d", "[", "y", "]"}]}]}], ")"}], "/;", 
      RowBox[{"EvenQ", "[", 
       RowBox[{"FormDegree", "[", "y", "]"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"FormCoef", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "/.", 
             RowBox[{
              RowBox[{"d", "[", "y", "]"}], "\[Rule]", 
              RowBox[{"d", "[", "$J$", "]"}]}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "/.", 
              RowBox[{
               RowBox[{"d", "[", "y", "]"}], "\[Rule]", 
               RowBox[{"d", "[", "$J$", "]"}]}]}], "/.", 
             RowBox[{"y", "\[Rule]", "0"}]}], ")"}]}], ")"}], "/.", 
         RowBox[{
          RowBox[{"d", "[", "$J$", "]"}], "\[Rule]", 
          RowBox[{"d", "[", "y", "]"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{"Wedge", "[", 
            RowBox[{"p___", ",", "y", ",", "q___"}], "]"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"{", "q", "}"}], ",", 
               RowBox[{
                RowBox[{"OddQ", "[", 
                 RowBox[{"FormDegree", "[", "#", "]"}], "]"}], "&"}]}], "]"}],
              "]"}]}], 
           RowBox[{"Wedge", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], "}"}]}], ")"}], "/;", 
      RowBox[{"OddQ", "[", 
       RowBox[{"FormDegree", "[", "y", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DeclareMatrixForms", "[", "z__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"{", 
           RowBox[{"{", "z", "}"}], "}"}]}], ",", "xi", ",", "rxi", ",", "h", 
         ",", "ht", ",", "k", ",", "min1", ",", 
         RowBox[{"tmp", "=", "AllMatrices"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "===", "List"}], 
          ",", 
          RowBox[{"x", "=", 
           RowBox[{"First", "[", "x", "]"}]}]}], "]"}], ";", 
        RowBox[{"Unprotect", "[", "Transpose", "]"}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xi", "=", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "xi", "]"}], "<", "3"}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\<Missing symbol for transposed matrix\>\"", 
               "]"}], ";", 
              RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"xi", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "===", 
               RowBox[{"xi", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "||", 
              RowBox[{
               RowBox[{"xi", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "===", 
               RowBox[{"-", 
                RowBox[{"xi", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", 
             RowBox[{"rxi", "=", 
              RowBox[{"{", 
               RowBox[{"xi", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "}"}]}], ",", 
             RowBox[{"rxi", "=", 
              RowBox[{"Rest", "[", "xi", "]"}]}]}], "]"}], ";", 
           RowBox[{
            RowBox[{"matForms", "[", 
             RowBox[{"First", "[", "xi", "]"}], "]"}], "=", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{"matForms", "[", 
               RowBox[{"First", "[", "xi", "]"}], "]"}], ",", "rxi"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AllMatrices", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"AllMatrices", ",", "rxi"}], "]"}]}], ";", 
           RowBox[{"h", "=", 
            RowBox[{"Head", "[", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "xi", "]"}], ">", "0"}], ",", 
             RowBox[{"AllMatForms", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"AllMatForms", ",", "rxi"}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"h", "=!=", "Symbol"}], ",", 
               RowBox[{
                RowBox[{"ZeroHeads", "=", 
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{"{", "h", "}"}], ",", "ZeroHeads"}], "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "=!=", "Times"}], 
                  ",", 
                  RowBox[{"ZeroHeads", "=", 
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Head", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "}"}], ",", 
                    "ZeroHeads"}], "]"}]}]}], "]"}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"h", "===", "Symbol"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"FormDegree", "[", 
                RowBox[{"xi", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", 
               RowBox[{"First", "[", "xi", "]"}]}], ";", 
              RowBox[{
               RowBox[{"BasicMatQ", "[", 
                RowBox[{"xi", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", "True"}], ";", 
              RowBox[{
               RowBox[{"BasicScalFormQ", "[", 
                RowBox[{"xi", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", "False"}], ";", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"xi", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", 
               RowBox[{"xi", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"xi", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "===", 
                 RowBox[{"-", 
                  RowBox[{"xi", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"tr", "[", 
                  RowBox[{"xi", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", "0"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=!=", 
                   RowBox[{"xi", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FormDegree", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "=", 
                    RowBox[{"First", "[", "xi", "]"}]}], ";", 
                   RowBox[{
                    RowBox[{"BasicMatQ", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "=", "True"}], ";", 
                   RowBox[{
                    RowBox[{"BasicScalFormQ", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "=", "False"}], 
                   ";", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "=", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                   RowBox[{
                    RowBox[{"tr", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "=", 
                    RowBox[{"tr", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"FormDegree", "[", "_h", "]"}], "=", 
               RowBox[{"First", "[", "xi", "]"}]}], ";", 
              RowBox[{
               RowBox[{"BasicMatQ", "[", "_h", "]"}], "=", "True"}], ";", 
              RowBox[{
               RowBox[{"BasicScalFormQ", "[", "_h", "]"}], "=", "False"}], 
              ";", 
              RowBox[{"ht", "=", 
               RowBox[{"Head", "[", 
                RowBox[{"xi", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ht", "===", "Times"}], ",", 
                RowBox[{
                 RowBox[{"min1", "=", 
                  RowBox[{"-", "1"}]}], ";", 
                 RowBox[{"ht", "=", "h"}], ";", 
                 RowBox[{
                  RowBox[{"tr", "[", 
                   RowBox[{"h", "[", "k__", "]"}], "]"}], "=", "0"}]}], ",", 
                RowBox[{
                 RowBox[{"min1", "=", "1"}], ";", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ht", "=!=", "h"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"FormDegree", "[", "_ht", "]"}], "=", 
                    RowBox[{"First", "[", "xi", "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"BasicMatQ", "[", "_ht", "]"}], "=", "True"}], 
                    ";", 
                    RowBox[{
                    RowBox[{"BasicScalFormQ", "[", "_ht", "]"}], "=", 
                    "False"}], ";", 
                    RowBox[{
                    RowBox[{"tr", "[", 
                    RowBox[{"ht", "[", "k__", "]"}], "]"}], "=", 
                    RowBox[{"tr", "[", 
                    RowBox[{"h", "[", "k", "]"}], "]"}]}]}]}], "]"}]}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"h", "[", "k__", "]"}], "]"}], "=", 
               RowBox[{"min1", " ", 
                RowBox[{"ht", "[", "k", "]"}]}]}], ";", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"ht", "[", "k__", "]"}], "]"}], "=", 
               RowBox[{"min1", " ", 
                RowBox[{"h", "[", "k", "]"}]}]}]}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"Protect", "[", "Transpose", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AllDifForms", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"AllScalForms", ",", "AllMatForms"}], "]"}]}], ";", 
        RowBox[{"AllSymbols", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"AllDifForms", ",", "AllMatrices"}], "]"}]}], ";", 
        RowBox[{"MatFormHeadList", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"Head", "/@", "AllMatForms"}], ",", "MatFormHeadList"}], 
            "]"}], ",", 
           RowBox[{"{", "Symbol", "}"}]}], "]"}]}], ";", 
        RowBox[{"AllMatHeads", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"ZeroHeads", ",", "MatFormHeadList"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"HeadList", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Head", "/@", "AllSymbols"}], "]"}]}], ";", 
        RowBox[{"DifFormSymbols", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"AllDifForms", ",", 
           RowBox[{"-", 
            RowBox[{"Length", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"ScalHeadList", ",", "MatFormHeadList"}], "]"}], 
             "]"}]}]}], "]"}]}], ";", 
        RowBox[{"nodHeads", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"nodHeads", ",", "ZeroHeads"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Blank", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"ScalHeadList", ",", "MatFormHeadList"}], "]"}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"FormVars", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"_Wedge", ",", "_d", ",", 
            RowBox[{"Union", "[", 
             RowBox[{"k", ",", 
              RowBox[{"Bar", "[", "k", "]"}]}], "]"}], ",", 
            RowBox[{"Union", "[", 
             RowBox[{"DifFormSymbols", ",", 
              RowBox[{"Bar", "[", "DifFormSymbols", "]"}]}], "]"}], ",", 
            "_tr"}], "}"}], "]"}]}], ";", 
        RowBox[{"ZeroMatSymbols", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"matForms", "[", "0", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Length", "[", "ZeroHeads", "]"}]}]}], "]"}]}], ";", 
        RowBox[{"ZeroVars", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"_Wedge", ",", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{"Thread", "[", 
               RowBox[{"Blank", "[", "ZeroHeads", "]"}], "]"}], ",", 
              RowBox[{"Bar", "[", 
               RowBox[{"Thread", "[", 
                RowBox[{"Blank", "[", "ZeroHeads", "]"}], "]"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"Union", "[", 
             RowBox[{"ZeroMatSymbols", ",", 
              RowBox[{"Bar", "[", "ZeroMatSymbols", "]"}]}], "]"}], ",", 
            "_tr"}], "}"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Print", "[", "\"\<OK\>\"", "]"}]}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"DeclareForms", "[", "z__", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DclFrmNoOK", "[", "z", "]"}], ";", 
      RowBox[{"Print", "[", "\"\<OK\>\"", "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DclFrmNoOK", "[", "z__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"h", ",", 
         RowBox[{"x", "=", 
          RowBox[{"{", 
           RowBox[{"{", "z", "}"}], "}"}]}], ",", "xi", ",", "rxi", ",", 
         "k"}], "}"}], ",", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "===", "List"}], 
          ",", 
          RowBox[{"x", "=", 
           RowBox[{"First", "[", "x", "]"}]}]}], "]"}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xi", "=", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", 
           RowBox[{"rxi", "=", 
            RowBox[{"Rest", "[", "xi", "]"}]}], ";", 
           RowBox[{
            RowBox[{"Forms", "[", 
             RowBox[{"First", "[", "xi", "]"}], "]"}], "=", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{"Forms", "[", 
               RowBox[{"First", "[", "xi", "]"}], "]"}], ",", "rxi"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AllScalForms", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"AllScalForms", ",", "rxi"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"h", "=", 
               RowBox[{"Head", "[", 
                RowBox[{"rxi", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"h", "===", "Symbol"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FormDegree", "[", 
                   RowBox[{"rxi", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "=", 
                  RowBox[{"First", "[", "xi", "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"BasicScalFormQ", "[", 
                   RowBox[{"rxi", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "=", "True"}], ";", 
                 RowBox[{
                  RowBox[{"BasicMatQ", "[", 
                   RowBox[{"rxi", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "=", "False"}], 
                 ";"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FormDegree", "[", "_h", "]"}], "=", 
                  RowBox[{"First", "[", "xi", "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"BasicScalFormQ", "[", "_h", "]"}], "=", "True"}], 
                 ";", 
                 RowBox[{
                  RowBox[{"BasicMatQ", "[", "_h", "]"}], "=", "False"}], 
                 ";"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "rxi", "]"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AllDifForms", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"AllScalForms", ",", "AllMatForms"}], "]"}]}], ";", 
        RowBox[{"ScalHeadList", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"Head", "/@", "AllScalForms"}], ",", "ScalHeadList"}], 
            "]"}], ",", 
           RowBox[{"{", "Symbol", "}"}]}], "]"}]}], ";", 
        RowBox[{"AllSymbols", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"AllDifForms", ",", "AllMatrices"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"HeadList", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Head", "/@", "AllSymbols"}], "]"}]}], ";", 
        RowBox[{"DifFormSymbols", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"AllDifForms", ",", 
           RowBox[{"-", 
            RowBox[{"Length", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"ScalHeadList", ",", "MatFormHeadList"}], "]"}], 
             "]"}]}]}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Blank", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"ScalHeadList", ",", "MatFormHeadList"}], "]"}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"FormVars", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"_Wedge", ",", "_d", ",", 
            RowBox[{"Union", "[", 
             RowBox[{"k", ",", 
              RowBox[{"Bar", "[", "k", "]"}]}], "]"}], ",", 
            RowBox[{"Union", "[", 
             RowBox[{"DifFormSymbols", ",", 
              RowBox[{"Bar", "[", "DifFormSymbols", "]"}]}], "]"}], ",", 
            "_tr"}], "}"}], "]"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"NoDif", "[", "z__", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nodHeads", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"nodHeads", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "z", "}"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"z", "===", "interiorProduct"}], "||", 
         RowBox[{"z", "===", "int$Prod"}], "||", 
         RowBox[{"z", "===", "LieDcartan"}]}], ",", 
        RowBox[{"Return", "[", "]"}], ",", 
        RowBox[{"Print", "[", "\"\<OK\>\"", "]"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BasicMatQ", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"BasicMatQ", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", 
      RowBox[{"d", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"BasicMatQ", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x_List", "]"}], "=", "True"}], ";", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MatQ", "[", 
      RowBox[{"x_Times", "|", "x_Wedge", "|", "x_Plus"}], "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"MatQ", "/@", 
       RowBox[{"List", "@@", "x"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"MatQ", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"MatQ", "/@", 
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"MatQ", "[", "x_", "]"}], ":=", 
     RowBox[{"BasicMatQ", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BasicScalFormQ", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"tr", "[", "x_", "]"}], "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}]}], ";", 
    RowBox[{
     RowBox[{"BasicScalFormQ", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"BasicScalFormQ", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"BasicScalFormQ", "[", 
      RowBox[{"d", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"!", 
      RowBox[{"BasicMatQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"BasicScalFormQ", "[", "x_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalFormQ", "[", "x_Times", "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"ScalFormQ", "/@", 
       RowBox[{"List", "@@", "x"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"ScalFormQ", "[", 
      RowBox[{"x_Wedge", "|", "x_Plus"}], "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"ScalFormQ", "/@", 
       RowBox[{"List", "@@", "x"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"ScalFormQ", "[", "x_", "]"}], ":=", 
     RowBox[{"BasicScalFormQ", "[", "x", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Unprotect", "[", "Transpose", "]"}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", "x_Plus", "]"}], ":=", 
     RowBox[{"Transpose", "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Transpose", "/@", 
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"x__", " ", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Transpose", "[", "y", "]"}]}], "/;", 
      RowBox[{"!", 
       RowBox[{"MatQ", "[", "x", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"x__", "\[Wedge]", "y__"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "\[Wedge]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Wedge", "[", "y", "]"}], "]"}]}], ")"}], "/;", 
      RowBox[{"ScalFormQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", "x_Wedge", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"allFDprods", "[", 
        RowBox[{"FormDegree", "/@", 
         RowBox[{"(", 
          RowBox[{"List", "@@", "x"}], ")"}]}], "]"}]}], 
      RowBox[{"Wedge", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{"Transpose", ",", 
         RowBox[{"Reverse", "[", 
          RowBox[{"List", "@@", "x"}], "]"}]}], "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"d", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"d", "[", 
      RowBox[{"Transpose", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Bar", "[", "x_", "]"}], "]"}], "]"}], ":=", 
     RowBox[{"Bar", "[", 
      RowBox[{"Transpose", "[", "x", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Transpose", "[", "x_", "]"}], ":=", 
     RowBox[{"x", "/;", 
      RowBox[{"!", 
       RowBox[{"MatQ", "[", "x", "]"}]}]}]}], ";", 
    RowBox[{"Protect", "[", "Transpose", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymQ", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"SymQ", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"SymQ", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"reWrite", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "x", "]"}], "-", "x"}], "]"}], "}"}], 
        "]"}], "]"}], "===", 
      RowBox[{"{", "0", "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"AntisymQ", "[", 
      RowBox[{"Bar", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"AntisymQ", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"AntisymQ", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"reWrite", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "x", "]"}], "+", "x"}], "]"}], "}"}], 
        "]"}], "]"}], "===", 
      RowBox[{"{", "0", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"d", ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"x_Times", "|", "x_Wedge"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"First", "[", "x", "]"}], "]"}], "\[Wedge]", 
       RowBox[{"Rest", "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"FormDegree", "[", 
         RowBox[{"First", "[", "x", "]"}], "]"}]}], "*", 
       RowBox[{
        RowBox[{"First", "[", "x", "]"}], "\[Wedge]", 
        RowBox[{"d", "[", 
         RowBox[{"Rest", "[", "x", "]"}], "]"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], "|", "x_d"}], "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"d", "[", "matDimension", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"y_", ",", "n_"}], "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"n", " ", 
       RowBox[{"y", "^", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}], " ", 
       RowBox[{"d", "[", "y", "]"}]}], "+", 
      RowBox[{
       RowBox[{"y", "^", "n"}], " ", 
       RowBox[{"Log", "[", "y", "]"}], 
       RowBox[{"d", "[", "n", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"d", "[", "x_Plus", "]"}], ":=", 
     RowBox[{"d", "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"d", "[", 
       RowBox[{"tr", "[", "x_", "]"}], "]"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evalHx", "=", 
         RowBox[{"d", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"tr", "[", "evalHx", "]"}], "/;", 
        RowBox[{
         RowBox[{"Head", "[", "evalHx", "]"}], "=!=", "d"}]}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"d", "[", 
       RowBox[{"Bar", "[", "x_", "]"}], "]"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evalHx", "=", 
         RowBox[{"d", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Bar", "[", "evalHx", "]"}], "/;", 
        RowBox[{
         RowBox[{"Head", "[", "evalHx", "]"}], "=!=", "d"}]}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"x_Rule", "|", "x_Equal"}], "]"}], ":=", 
     RowBox[{"reWrite", "[", 
      RowBox[{"d", "/@", "x"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"d", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
         RowBox[{"d", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ")"}], "+", 
      RowBox[{"Wedge", "[", 
       RowBox[{
        RowBox[{"d", "[", 
         RowBox[{"First", "[", "x", "]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", 
          RowBox[{"First", "[", "x", "]"}]}], "]"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{
       RowBox[{"h_", "[", "y__", "]"}], "/;", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"nodHeads", ",", "h"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"RotateRight", "[", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "y", "}"}], "]"}], "-", "1"}], "}"}]}], 
                   "]"}], ",", "1"}], "]"}], ",", "i"}], "]"}]}], "]"}], "[", 
            "h", "]"}], "[", "y", "]"}], ")"}], 
         RowBox[{"d", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "y", "}"}], "]"}]}], "}"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"FormDegree", "[", 
         RowBox[{"h", "[", "y", "]"}], "]"}], "===", "0"}], "&&", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Integer", ",", "Blank", ",", "Pattern", ",", "Condition"}],
           "}"}], ",", 
         RowBox[{"Head", "[", 
          RowBox[{"First", "[", 
           RowBox[{"{", "y", "}"}], "]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"NoDif", "[", "interiorProduct", "]"}], ";", 
    RowBox[{
     RowBox[{"interiorProduct", "[", 
      RowBox[{"x_List", ",", "0", ",", 
       RowBox[{"$z_", ":", "Null"}]}], "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"interiorProduct", "[", 
      RowBox[{"x_List", ",", "y_", ",", 
       RowBox[{"$z_", ":", "Null"}]}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "y", "]"}], "===", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"interiorProduct", "[", 
      RowBox[{"x_List", ",", "y_", ",", 
       RowBox[{"$z_", ":", "Null"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"reWrite", "[", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"zeroQ", "[", 
          RowBox[{"y", "/.", 
           RowBox[{
            RowBox[{"e", "[", "_", "]"}], "\[Rule]", "0"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "/.", 
               RowBox[{
                RowBox[{"d", "[", "_", "]"}], "\[Rule]", "0"}]}], ")"}], "=!=",
              "y"}], ",", 
            RowBox[{"er$Wrn", "[", "6", "]"}]}], "]"}], ";", 
          RowBox[{"int$Prod", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], ",", 
         RowBox[{"zeroQ", "[", 
          RowBox[{"y", "/.", 
           RowBox[{
            RowBox[{"d", "[", "_", "]"}], "\[Rule]", 
            RowBox[{"0", "&&", 
             RowBox[{
              RowBox[{"FormDegree", "[", 
               RowBox[{"y", "/.", 
                RowBox[{
                 RowBox[{"d", "[", "k_", "]"}], "\[RuleDelayed]", "k"}]}], 
               "]"}], "===", "0"}]}]}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$z", "===", "Null"}], ",", 
           RowBox[{
            RowBox[{"er$Wrn", "[", "4", "]"}], ";", 
            RowBox[{"Return", "[", "]"}]}], ",", 
           RowBox[{
            RowBox[{"dvarTOe", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"d", "/@", "$z"}], ",", 
                 RowBox[{"e", "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "$z", "]"}], "]"}]}]}], "}"}]}], 
              "]"}]}], ";", 
            RowBox[{"eTOdvar", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"e", "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "$z", "]"}], "]"}]}], ",", 
                 RowBox[{"d", "/@", "$z"}]}], "}"}]}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "/.", "dvarTOe"}], ")"}], "=!=", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "/.", "dvarTOe"}], "/.", 
                 RowBox[{
                  RowBox[{"d", "[", "_", "]"}], "\[Rule]", "0"}]}], ")"}]}], 
              ",", 
              RowBox[{"er$Wrn", "[", "6", "]"}]}], "]"}], ";", 
            RowBox[{
             RowBox[{"int$Prod", "[", 
              RowBox[{"x", ",", 
               RowBox[{"y", "/.", "dvarTOe"}]}], "]"}], "/.", "eTOdvar"}]}]}],
           "]"}], ",", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"y", "/.", 
            RowBox[{
             RowBox[{"d", "[", "_", "]"}], "\[Rule]", "0"}]}], "]"}], "&&", 
          RowBox[{"FreeQ", "[", 
           RowBox[{
            RowBox[{"y", "/.", 
             RowBox[{
              RowBox[{"d", "[", "k_", "]"}], "\[RuleDelayed]", "k"}]}], ",", 
            "Wedge"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "]"}], ",", "True", ",", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Head", "/@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "/.", 
                    RowBox[{"Plus", "\[Rule]", "List"}]}], "/.", 
                   RowBox[{"Times", "\[Rule]", "List"}]}], "/.", 
                  RowBox[{"Wedge", "\[Rule]", "List"}]}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"FormDegree", "[", "#", "]"}], "===", "1"}], "&"}]}],
               "]"}]}], "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "tmp", "]"}], "===", "1"}], ",", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{"tmp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"int$Prod", "[", 
               RowBox[{"x", ",", 
                RowBox[{"y", "/.", 
                 RowBox[{"tmp", "\[Rule]", "e"}]}]}], "]"}], "/.", 
              RowBox[{"e", "\[Rule]", "tmp"}]}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"tmp", "/.", 
                 RowBox[{"d", "\[Rule]", 
                  RowBox[{"Sequence", "[", "]"}]}]}], "]"}], "===", "1"}], 
              ",", 
              RowBox[{
               RowBox[{"er$Wrn", "[", "6", "]"}], ";", 
               RowBox[{
                RowBox[{"int$Prod", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"y", "/.", 
                   RowBox[{"tmp", "\[Rule]", "e"}]}]}], "]"}], "/.", 
                RowBox[{"e", "\[Rule]", "tmp"}]}]}], ",", 
              RowBox[{"er$Wrn", "[", "5", "]"}]}], "]"}]}], "]"}]}]}], "]"}], 
       "]"}], "/;", 
      RowBox[{
       RowBox[{"Head", "[", "y", "]"}], "=!=", "Symbol"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"er$Wrn", "[", "4", "]"}], ":=", 
     RowBox[{
     "stPrint", "[", 
      "\"\<Must give ordered list of variables (coordinates) as 3rd \
argument\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"er$Wrn", "[", "5", "]"}], ":=", 
     RowBox[{"stPrint", "[", 
      RowBox[{"\"\<Error: more than one symbol used for 1-forms: \>\"", "<>", 
       RowBox[{"ToString", "[", "tmp", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"er$Wrn", "[", "6", "]"}], ":=", 
     RowBox[{
     "stPrint", "[", 
      "\"\<To complete the calculation, all exterior derivatives must be \
expressed in terms of the basis 1-forms!\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"NoDif", "[", "int$Prod", "]"}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", "0"}], "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{"zeroQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", "y_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"int$Prod", "[", 
        RowBox[{"x", ",", "#"}], "]"}], "&"}], "/@", "y"}]}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "y", "]"}], "===", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", "y_Plus"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"int$Prod", "[", 
        RowBox[{"x", ",", "#"}], "]"}], "&"}], "/@", "y"}]}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"u_", "*", "y_"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"u", "*", 
       RowBox[{"int$Prod", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "u", "]"}], "===", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"e", "[", "b_", "]"}]}], "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"[", "b", "]"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"int$Prod", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"Wedge", "[", 
        RowBox[{
         RowBox[{"e", "[", "k_", "]"}], ",", "p__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "*", 
       RowBox[{"Wedge", "[", "p", "]"}]}], "-", 
      RowBox[{"Wedge", "[", 
       RowBox[{
        RowBox[{"e", "[", "k", "]"}], ",", 
        RowBox[{"int$Prod", "[", 
         RowBox[{"x", ",", 
          RowBox[{"Wedge", "[", "p", "]"}]}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"NoDif", "[", "LieDcartan", "]"}], ";", 
    RowBox[{
     RowBox[{"LieDcartan", "[", 
      RowBox[{"x_", ",", "y_", ",", 
       RowBox[{"$z_", ":", "Null"}]}], "]"}], ":=", 
     RowBox[{"reWrite", "[", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"interiorProduct", "[", 
         RowBox[{"x", ",", "y", ",", "$z"}], "]"}], "]"}], "+", 
       RowBox[{"interiorProduct", "[", 
        RowBox[{"x", ",", 
         RowBox[{"d", "[", "y", "]"}], ",", "$z"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"newSer$", "[", 
     RowBox[{"x_SeriesData", ",", "k_"}], "]"}], ":=", 
    RowBox[{"SeriesData", "[", 
     RowBox[{
      RowBox[{"First", "[", "x", "]"}], ",", 
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", "-", "1"}], "}"}]}], "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"k", " ", 
       RowBox[{"x", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ",", 
      RowBox[{"k", " ", 
       RowBox[{"x", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ",", 
      RowBox[{"k", " ", 
       RowBox[{"Last", "[", "x", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Wedge", "[", "x_", "]"}], ":=", 
    RowBox[{"x", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "x", "}"}], "]"}], "<", "2"}], "&&", 
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", "Pattern"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Default", "[", "Wedge", "]"}], ":=", "1"}], ";", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"Wedge", ",", 
      RowBox[{"{", 
       RowBox[{"Flat", ",", "OneIdentity"}], "}"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"0", ",", "y__"}], "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x__", ",", "0"}], "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_SeriesData", ",", "y_SeriesData"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "x$", ",", "y$", ",", "s1$", ",", "s2$", ",", "re$", ",", "x3$", ",",
           "y3$"}], "}"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "x", "]"}], "===", 
            RowBox[{"Last", "[", "y", "]"}]}], ",", 
           RowBox[{
            RowBox[{"x$", "=", "x"}], ";", 
            RowBox[{"y$", "=", "y"}]}], ",", 
           RowBox[{
            RowBox[{"x$", "=", 
             RowBox[{"newSer$", "[", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"LCM", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "x", "]"}], ",", 
                  RowBox[{"Last", "[", "y", "]"}]}], "]"}], "/", 
                RowBox[{"Last", "[", "x", "]"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y$", "=", 
             RowBox[{"newSer$", "[", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"LCM", "[", 
                 RowBox[{
                  RowBox[{"Last", "[", "x", "]"}], ",", 
                  RowBox[{"Last", "[", "y", "]"}]}], "]"}], "/", 
                RowBox[{"Last", "[", "y", "]"}]}]}], "]"}]}]}]}], "]"}], ";", 
         RowBox[{"s1$", "=", 
          RowBox[{
           RowBox[{"x$", "[", 
            RowBox[{"[", 
             RowBox[{"-", "3"}], "]"}], "]"}], "+", 
           RowBox[{"y$", "[", 
            RowBox[{"[", 
             RowBox[{"-", "3"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"s2$", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "+", 
             RowBox[{"y$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "3"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"x$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "3"}], "]"}], "]"}], "+", 
             RowBox[{"y$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"x$", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
            RowBox[{
             RowBox[{"x$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "-", 
             RowBox[{"x$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"x3$", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"x$", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x$", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"x$", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "3"}], "]"}], "]"}], "-", 
                  RowBox[{"Length", "[", 
                   RowBox[{"x$", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              "]"}]}], ",", 
           RowBox[{"x3$", "=", 
            RowBox[{"x$", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"y$", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
            RowBox[{
             RowBox[{"y$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "-", 
             RowBox[{"y$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"y3$", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"y$", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"y$", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"y$", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "3"}], "]"}], "]"}], "-", 
                  RowBox[{"Length", "[", 
                   RowBox[{"y$", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              "]"}]}], ",", 
           RowBox[{"y3$", "=", 
            RowBox[{"y$", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"s2$", "===", "s1$"}], ",", 
           RowBox[{"re$", "=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{
            RowBox[{"s2$", "-", "s1$"}], "===", 
            RowBox[{
             RowBox[{"x$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "-", 
             RowBox[{"x$", "[", 
              RowBox[{"[", 
               RowBox[{"-", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"re$", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Wedge", "[", 
                  RowBox[{
                   RowBox[{"x3$", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                ",", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", "-", "1"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Drop", "[", 
                   RowBox[{"y3$", ",", 
                    RowBox[{
                    RowBox[{"-", "i"}], "+", "1"}]}], "]"}]}], "]"}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "x3$", "]"}]}], "}"}]}], "]"}]}], ",", 
           "True", ",", 
           RowBox[{"re$", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Wedge", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"y3$", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "&"}], ",", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", "-", "1"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Drop", "[", 
                   RowBox[{"x3$", ",", 
                    RowBox[{
                    RowBox[{"-", "i"}], "+", "1"}]}], "]"}]}], "]"}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "y3$", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}], ";", 
         RowBox[{"SeriesData", "[", 
          RowBox[{
           RowBox[{"First", "[", "x$", "]"}], ",", 
           RowBox[{"x$", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "re$", ",", "s1$", ",", 
           "s2$", ",", 
           RowBox[{"Last", "[", "x$", "]"}]}], "]"}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", "x", "]"}], "===", 
        RowBox[{"First", "[", "y", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "===", 
        RowBox[{"y", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"y_", ",", "x_SeriesData"}], "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Wedge", "[", 
           RowBox[{"y", ",", "#"}], "]"}], "&"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_SeriesData", ",", "y_"}], "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Wedge", "[", 
           RowBox[{"#", ",", "y"}], "]"}], "&"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x__", ",", "y_Plus"}], "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Wedge", "[", 
          RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
        RowBox[{"List", "@@", "y"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_Plus", ",", "y__"}], "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Wedge", "[", 
          RowBox[{"#", ",", "y"}], "]"}], "&"}], ",", 
        RowBox[{"List", "@@", "x"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"z__", ",", 
       RowBox[{"Times", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Wedge", "[", 
         RowBox[{"z", ",", "y"}], "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"NumericQ", "[", "x", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
         RowBox[{"!", 
          RowBox[{"MatQ", "[", "x", "]"}]}]}], ")"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{
       RowBox[{"Times", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", "z__"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Wedge", "[", 
         RowBox[{"y", ",", "z"}], "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"NumericQ", "[", "x", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
         RowBox[{"!", 
          RowBox[{"MatQ", "[", "x", "]"}]}]}], ")"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{
       RowBox[{"x_", "^", "n_."}], ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "n"}], "*", "y"}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
       RowBox[{"!", 
        RowBox[{"MatQ", "[", "x", "]"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"y_", ",", 
       RowBox[{"x_", "^", "n_."}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "n"}], "*", "y"}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
       RowBox[{"!", 
        RowBox[{"MatQ", "[", "x", "]"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_", ",", "y___", ",", "x_"}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{
       RowBox[{"OddQ", "[", 
        RowBox[{"FormDegree", "[", "x", "]"}], "]"}], "&&", 
       RowBox[{"ScalFormQ", "[", "x", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x__", ",", "y__"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], "*", 
          RowBox[{"FormDegree", "[", "y", "]"}]}], ")"}]}], "*", 
       RowBox[{"y", "\[Wedge]", "x"}]}], "/;", 
      RowBox[{
       RowBox[{"MatQ", "[", "x", "]"}], "&&", 
       RowBox[{"ScalFormQ", "[", "y", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", "x__", "]"}], ":=", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"doubL", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FormDegree", "/@", 
              RowBox[{"{", "x", "}"}]}], ",", 
             RowBox[{"{", "x", "}"}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"Signature", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"doubL", ",", 
            RowBox[{
             RowBox[{"OddQ", "[", 
              RowBox[{"First", "[", "#", "]"}], "]"}], "&"}]}], "]"}], "]"}], 
         RowBox[{"Wedge", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#1", "]"}], "&"}], ",", 
            RowBox[{"Sort", "[", "doubL", "]"}]}], "]"}]}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"BasicScalFormQ", "/@", 
          RowBox[{"{", "x", "}"}]}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], "&&", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#1", "]"}], "&"}], ",", 
          RowBox[{"Sort", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FormDegree", "/@", 
               RowBox[{"{", "x", "}"}]}], ",", 
              RowBox[{"{", "x", "}"}]}], "}"}], "]"}], "]"}]}], "]"}], "=!=", 
        RowBox[{"{", "x", "}"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
          RowBox[{"!", 
           RowBox[{"MatQ", "[", 
            RowBox[{"Last", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "]"}]}]}], 
         ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"FormDegree", "[", "y", "]"}], "===", "0"}], "&&", 
          RowBox[{"!", 
           RowBox[{"MatQ", "[", 
            RowBox[{"Last", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", "y", "]"}], "]"}], "]"}], "]"}]}]}], 
         ")"}]}], ",", 
       RowBox[{"Dot", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"Inner", "[", 
        RowBox[{"Wedge", ",", "x", ",", "y"}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_", ",", "y_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"FormDegree", "[", "y", "]"}], "===", "0"}], "&&", 
           RowBox[{"!", 
            RowBox[{"MatQ", "[", 
             RowBox[{"Last", "[", 
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", "y", "]"}], "]"}], "]"}], "]"}]}]}], 
          ")"}]}], ",", 
        RowBox[{"x", "*", "y"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Wedge", "[", 
            RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", "y"}], "]"}]}], "]"}],
       "/;", 
      RowBox[{"!", 
       RowBox[{"MatQ", "[", "x", "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"Wedge", "[", 
      RowBox[{"x_List", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "y", "]"}], "===", "0"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
           RowBox[{"!", 
            RowBox[{"MatQ", "[", 
             RowBox[{"Last", "[", 
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "]"}]}]}], 
          ")"}]}], ",", 
        RowBox[{"x", "*", "y"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Wedge", "[", 
            RowBox[{"#", ",", "y"}], "]"}], "&"}], ",", "x"}], "]"}]}], "]"}],
       "/;", 
      RowBox[{"!", 
       RowBox[{"MatQ", "[", "y", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"simpRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"x_.", "*", 
         RowBox[{
          RowBox[{"Cos", "[", "h_", "]"}], "^", "2"}]}], "+", 
        RowBox[{"x_.", "*", 
         RowBox[{
          RowBox[{"Sin", "[", "h_", "]"}], "^", "2"}]}]}], "\[RuleDelayed]", 
       "x"}], "}"}]}], ";", 
    RowBox[{"varList", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"reWrite", ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_Equal", "]"}], ":=", 
     RowBox[{"Equal", "[", 
      RowBox[{
       RowBox[{"reWrite", "[", 
        RowBox[{
         RowBox[{"First", "[", "x", "]"}], "-", 
         RowBox[{"Last", "[", "x", "]"}]}], "]"}], ",", "0"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_Rule", "]"}], ":=", 
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"First", "[", "x", "]"}], ",", 
       RowBox[{"reWrite", "[", 
        RowBox[{"Last", "[", "x", "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_RuleDelayed", "]"}], ":=", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"First", "[", "x", "]"}], ",", 
        RowBox[{"reWrite", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "/.", 
      RowBox[{"Rule", "\[Rule]", "RuleDelayed"}]}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
        RowBox[{"reWrite", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ")"}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_Condition", "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"reWrite", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"x", "/.", "simpRules"}], ",", "FormVars", ",", 
          "bestFacRul"}], "]"}], "/.", "simpRules"}], ")"}], "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"x", "/.", "simpRules"}], ",", "ZeroVars", ",", 
          "bestFacRul"}], "]"}], "/.", "simpRules"}], ")"}], "/;", 
      RowBox[{"MatQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"reWrite", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"bestFacRul", "[", 
       RowBox[{"x", "/.", "simpRules"}], "]"}], "/.", "simpRules"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FreeALLQ", "[", 
      RowBox[{"x_", ",", "y_List"}], "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"x", ",", "#"}], "]"}], "&"}], "/@", "y"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"bestFacRul", "[", "x_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"varList", "===", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{"FreeALLQ", "[", 
         RowBox[{"x", ",", "varList"}], "]"}]}], ",", 
       RowBox[{"minFacRul", "[", "x", "]"}], ",", 
       RowBox[{"varFacRul", "[", "x", "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"varFacRul", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", "x", "]"}], "/.", "simpRules"}], ",", 
        "varList", ",", "Factor"}], "]"}], "/.", "simpRules"}]}], ";", 
    RowBox[{
     RowBox[{"minFacRul", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Factor", "[", 
       RowBox[{
        RowBox[{"Expand", "[", "x", "]"}], "/.", "simpRules"}], "]"}], "/.", 
      "simpRules"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"Unprotect", "[", "SeriesData", "]"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "5"}], ",", 
      RowBox[{
       RowBox[{"Times", "[", 
        RowBox[{"x_SeriesData", ",", "0"}], "]"}], "^=", "0"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"SeriesData", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"Plus", "@@", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x2", "===", "Infinity"}], ",", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#", "]"}], "/", 
              RowBox[{"x1", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x4", "+", 
                   RowBox[{"Last", "[", "#", "]"}], "-", "1"}], ")"}], "/", 
                 "x6"}], ")"}]}]}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"x3", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "x3", "]"}], "]"}]}], "}"}], "]"}]}], 
           "]"}], "+", 
          RowBox[{"SeriesData", "[", 
           RowBox[{"x1", ",", "x2", ",", 
            RowBox[{"{", "}"}], ",", "x4", ",", "x5", ",", "x6"}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#", "]"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x4", "+", 
                   RowBox[{"Last", "[", "#", "]"}], "-", "1"}], ")"}], "/", 
                 "x6"}], ")"}]}]}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"x3", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "x3", "]"}], "]"}]}], "}"}], "]"}]}], 
           "]"}], "+", 
          RowBox[{"SeriesData", "[", 
           RowBox[{"x1", ",", "x2", ",", 
            RowBox[{"{", "}"}], ",", "x4", ",", "x5", ",", "x6"}], "]"}]}]}], 
        "]"}]}], "/;", 
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"x3", ",", "x1"}], "]"}], "||", 
         RowBox[{"NumericQ", "[", "x1", "]"}]}], ")"}]}]}]}], ";", 
    RowBox[{"Protect", "[", "SeriesData", "]"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"subMatDR", "[", 
      RowBox[{"m_", ",", "p_", ",", "q_"}], "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Drop", "[", 
          RowBox[{"m", ",", "p"}], "]"}], "]"}], ",", "q"}], "]"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"subMatTK", "[", 
      RowBox[{"m_", ",", "p_", ",", "q_"}], "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"m", ",", "p"}], "]"}], "]"}], ",", "q"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FlatOuter", "[", 
      RowBox[{
       RowBox[{"x_", "?", "MatrixQ"}], ",", 
       RowBox[{"y_", "?", "MatrixQ"}]}], "]"}], ":=", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "x", ",", "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "x", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Dimensions", "[", "y", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FlatOuter", "[", "x__", "]"}], ":=", 
     RowBox[{
      RowBox[{"Fold", "[", 
       RowBox[{"FlatOuter", ",", 
        RowBox[{"First", "[", 
         RowBox[{"{", "x", "}"}], "]"}], ",", 
        RowBox[{"Rest", "[", 
         RowBox[{"{", "x", "}"}], "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "x", "}"}], "]"}], ">", "2"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectSum", "[", 
      RowBox[{
       RowBox[{"x_", "?", "MatrixQ"}], ",", 
       RowBox[{"y_", "?", "MatrixQ"}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n$1", "=", 
          RowBox[{"Dimensions", "[", "x", "]"}]}], ",", 
         RowBox[{"n$2", "=", 
          RowBox[{"Dimensions", "[", "y", "]"}]}], ",", "zr$"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"zr$", "[", "__", "]"}], "=", "0"}], ";", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Array", "[", 
               RowBox[{"zr$", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"n$1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"n$2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Array", "[", 
               RowBox[{"zr$", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"n$2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"n$1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
              "y"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectSum", "[", "x__", "]"}], ":=", 
     RowBox[{
      RowBox[{"Fold", "[", 
       RowBox[{"DirectSum", ",", 
        RowBox[{"First", "[", 
         RowBox[{"{", "x", "}"}], "]"}], ",", 
        RowBox[{"Rest", "[", 
         RowBox[{"{", "x", "}"}], "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "x", "}"}], "]"}], ">", "2"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"DeclareMatrixForms", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "$", ",", "$t"}], "}"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"CHrule", "=", "CHrul"}], ";", 
    RowBox[{
     RowBox[{"CHcoef", "[", 
      RowBox[{"x_", ",", "0"}], "]"}], "=", "1"}], ";", 
    RowBox[{
     RowBox[{"CHcoef", "[", 
      RowBox[{"x_", ",", "1"}], "]"}], ":=", 
     RowBox[{"tr", "[", "x", "]"}]}], ";", 
    RowBox[{
     RowBox[{"CHcoef", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CHcoef", "[", 
       RowBox[{"x", ",", "n"}], "]"}], "=", 
      RowBox[{"reWrite", "[", 
       RowBox[{
        RowBox[{"tr", "[", 
         RowBox[{"CHeq", "[", 
          RowBox[{"x", ",", "n"}], "]"}], "]"}], "/", "n"}], "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CHeq", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"reWrite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CHcoef", "[", 
         RowBox[{"x", ",", 
          RowBox[{"n", "-", "1"}]}], "]"}], "\[Wedge]", "x"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], 
          RowBox[{
           RowBox[{"CHcoef", "[", 
            RowBox[{"x", ",", 
             RowBox[{"n", "-", "i"}]}], "]"}], "\[Wedge]", 
           RowBox[{"Wedge", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CHrul", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"x_", ":", "$"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cn", "=", 
          RowBox[{"CHeq", "[", 
           RowBox[{"x", ",", "n"}], "]"}]}], ",", "cn0", ",", "rul", ",", 
         "tmp", ",", "r1", ",", "r2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"x", ",", "\"\< is not a 0-form matrix\>\""}], "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"matDimension", "=", "n"}], ";", 
        RowBox[{"rul", "=", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"cn", "\[Equal]", "cn0"}], ",", 
             RowBox[{"Wedge", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}], "]"}], "/.", 
          RowBox[{"cn0", "\[Rule]", 
           RowBox[{
            RowBox[{"tr", "[", "cn", "]"}], "/", "n"}]}]}]}], ";", 
        RowBox[{"rul", "=", 
         RowBox[{"reWrite", "[", "rul", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "===", "$"}], ",", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"MapAt", "[", 
             RowBox[{"HoldPattern", ",", 
              RowBox[{"rul", "/.", 
               RowBox[{"Rule", "\[Rule]", "RuleDelayed"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"r1", "=", 
            RowBox[{"tmp", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           RowBox[{"r2", "=", 
            RowBox[{"r1", "/.", 
             RowBox[{"$", "\[Rule]", 
              RowBox[{"Pattern", "[", 
               RowBox[{"$", ",", 
                RowBox[{"Blank", "[", "]"}]}], "]"}]}]}]}], ";", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Rule", "[", 
               RowBox[{"r2", ",", 
                RowBox[{
                 RowBox[{"tmp", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], "/;", 
                 RowBox[{
                  RowBox[{"MatQ", "[", "$", "]"}], "&&", 
                  RowBox[{
                   RowBox[{"FormDegree", "[", "$", "]"}], "===", "0"}], "&&", 
                  RowBox[{"matDimension", "===", "n"}]}]}]}], "]"}], "}"}], "/.", 
             RowBox[{"Rule", "\[Rule]", "RuleDelayed"}]}]}]}], ",", 
          RowBox[{"tmp", "=", "rul"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"detTOtr", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"A_", ":", "$"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"expr", "=", 
         RowBox[{
          RowBox[{"CHrul", "[", "n", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "matDimension"}], ")"}]}], " ", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"List", "@@", "expr"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MatQ", "[", "#1", "]"}], "===", "False"}], "&"}]}], 
           "]"}]}]}], "/.", 
        RowBox[{"$", "\[Rule]", "A"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Protect", "[", 
     RowBox[{
     "CHeq", ",", "CHrul", ",", "CHrule", ",", "detTOtr", ",", "indepCoefs", 
      ",", "FormCoef", ",", "subMatTK", ",", "subMatDR", ",", "FlatOuter", 
      ",", "DirectSum"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"TrigRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x_.", "*", 
          RowBox[{
           RowBox[{"Cos", "[", "h_", "]"}], "^", "2"}]}], "+", 
         RowBox[{"x_.", "*", 
          RowBox[{
           RowBox[{"Sin", "[", "h_", "]"}], "^", "2"}]}]}], "\[RuleDelayed]", 
        "x"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x_.", "*", 
          RowBox[{
           RowBox[{"Cot", "[", "h_", "]"}], "^", "2"}]}], "+", 
         RowBox[{"y_.", "*", 
          RowBox[{
           RowBox[{"Csc", "[", "h_", "]"}], "^", "2"}]}]}], "\[RuleDelayed]", 
        RowBox[{"y", "/;", 
         RowBox[{
          RowBox[{"x", "+", "y"}], "===", "0"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cot", "[", "h_", "]"}], "-", 
           RowBox[{"Csc", "[", "h_", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cot", "[", "h_", "]"}], "+", 
           RowBox[{"Csc", "[", "h_", "]"}]}], ")"}]}], "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "}"}]}], ";", 
    RowBox[{"HypTrigRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x_.", "*", 
          RowBox[{
           RowBox[{"Cosh", "[", "h_", "]"}], "^", "2"}]}], "+", 
         RowBox[{"y_.", "*", 
          RowBox[{
           RowBox[{"Sinh", "[", "h_", "]"}], "^", "2"}]}]}], "\[RuleDelayed]", 
        RowBox[{"x", "/;", 
         RowBox[{
          RowBox[{"x", "+", "y"}], "===", "0"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x_.", "*", 
          RowBox[{
           RowBox[{"Coth", "[", "h_", "]"}], "^", "2"}]}], "+", 
         RowBox[{"y_.", "*", 
          RowBox[{
           RowBox[{"Csch", "[", "h_", "]"}], "^", "2"}]}]}], "\[RuleDelayed]", 
        RowBox[{"x", "/;", 
         RowBox[{
          RowBox[{"x", "+", "y"}], "===", "0"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", "x_", "]"}], "-", 
           RowBox[{"Sinh", "[", "x_", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", "x_", "]"}], "+", 
           RowBox[{"Sinh", "[", "x_", "]"}]}], ")"}]}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coth", "[", "h_", "]"}], "-", 
           RowBox[{"Csch", "[", "h_", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coth", "[", "h_", "]"}], "+", 
           RowBox[{"Csch", "[", "h_", "]"}]}], ")"}]}], "\[Rule]", "1"}]}], 
      "}"}]}], ";", 
    RowBox[{"imgTrigRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "x_", "]"}], "-", 
           RowBox[{"I", " ", 
            RowBox[{"Sin", "[", "x_", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "x_", "]"}], "+", 
           RowBox[{"I", " ", 
            RowBox[{"Sin", "[", "x_", "]"}]}]}], ")"}]}], "\[Rule]", "1"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "x_", "]"}], "+", 
           RowBox[{"I", " ", 
            RowBox[{"Sin", "[", "x_", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"I", " ", 
            RowBox[{"Cos", "[", "x_", "]"}]}], "+", 
           RowBox[{"Sin", "[", "x_", "]"}]}], ")"}]}], "\[Rule]", "I"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "x_", "]"}], "-", 
           RowBox[{"I", " ", 
            RowBox[{"Sin", "[", "x_", "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"Cos", "[", "x_", "]"}]}], "+", 
           RowBox[{"Sin", "[", "x_", "]"}]}], ")"}]}], "\[Rule]", 
        RowBox[{"-", "I"}]}]}], "}"}]}], ";", 
    RowBox[{"RootRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x_"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x_"}], ")"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            RowBox[{"x_", "^", "2"}]}], "]"}]}]}], "\[RuleDelayed]", 
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"x", "^", "2"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x_"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x_"}], ")"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x_", "^", "2"}], "-", "1"}], "]"}]}]}], "\[RuleDelayed]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"x", "^", "2"}], "-", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x_."}], "+", 
           RowBox[{"Sqrt", "[", "y_", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"x_.", "+", 
           RowBox[{"Sqrt", "[", "y_", "]"}]}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{"y", "-", 
         RowBox[{"x", "^", "2"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x_", "-", 
           RowBox[{"Sqrt", "[", "y_", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"x_", "+", 
           RowBox[{"Sqrt", "[", "y_", "]"}]}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", "y"}], "+", 
         RowBox[{"x", "^", "2"}]}]}]}], "}"}]}], ";", 
    RowBox[{"BasicRules", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
      "TrigRules", ",", "HypTrigRules", ",", "RootRules", ",", 
       "imgTrigRules"}], "]"}]}], ";", 
    RowBox[{"$RGTCversion", "=", "389"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"FaSi", ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"FaSi", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"FaSi", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
        RowBox[{"FaSi", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ")"}]}], ";", 
    RowBox[{
     RowBox[{"FaSi", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "/.", "simpRules"}], "&"}], ")"}], "/@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"varList", "===", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{"FreeALLQ", "[", 
          RowBox[{"x", ",", "varList"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Factor", "[", 
          RowBox[{"x", "/.", "simpRules"}], "]"}], "/.", "simpRules"}], ",", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"x", "/.", "simpRules"}], ",", "varList", ",", "Factor"}], 
          "]"}], "/.", "simpRules"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"FacSimp", ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"FacSimp", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"FacSimp", "[", "x_Equal", "]"}], ":=", 
     RowBox[{"Equal", "[", 
      RowBox[{
       RowBox[{"FacSimp", "[", 
        RowBox[{
         RowBox[{"First", "[", "x", "]"}], "-", 
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"FacSimp", "[", "x_Rule", "]"}], ":=", 
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"First", "[", "x", "]"}], ",", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"FacSimp", "[", "x_SeriesData", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
        RowBox[{"FacSimp", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ")"}]}], ";", 
    RowBox[{
     RowBox[{"FacSimp", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", "simpRules"}], "]"}], "&"}], "/@", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"x", "/.", "simpRules"}], ",", "FormVars", ",", "FaSi"}], 
         "]"}]}], ")"}], "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"FacSimp", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "/.", "simpRules"}], "&"}], ")"}], "/@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"varList", "===", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{"FreeALLQ", "[", 
          RowBox[{"x", ",", "varList"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Factor", "[", 
          RowBox[{"x", "/.", "simpRules"}], "]"}], "/.", "simpRules"}], ",", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"x", "/.", "simpRules"}], ",", "varList", ",", "Factor"}], 
          "]"}], "/.", "simpRules"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"nonZeroL", "[", "x_", "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "x", "}"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"zeroQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"nonZeroN", "[", "x_", "]"}], ":=", 
    RowBox[{"Length", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "x", "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"zeroQ", "[", "#", "]"}]}], "&"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"indep$cTerms", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"opt_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"redPlus", "[", 
      RowBox[{"redTimes", "[", 
       RowBox[{
        RowBox[{"nonZeroL", "[", "x", "]"}], ",", "opt"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"redTimes", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"opt_", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp$", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#1", "]"}], "===", "Times"}], "&"}]}], 
          "]"}]}], ",", "rxi"}], "}"}], ",", 
      RowBox[{
       RowBox[{"rxi", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"x", ",", "tmp$"}], "]"}]}], ";", 
       RowBox[{"Union", "[", 
        RowBox[{"rxi", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"numb2", "[", 
             RowBox[{"#", ",", "opt"}], "]"}], "&"}], ",", "tmp$"}], "]"}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"numb1", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"opt_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"1", "/;", 
      RowBox[{"NumericQ", "[", "x", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"numb1", "[", 
      RowBox[{
       RowBox[{"x_", "^", "y_."}], ",", 
       RowBox[{"opt_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"1", "/;", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"opt", ",", "x"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"numb1", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"opt_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", "x"}], ";", 
    RowBox[{
     RowBox[{"numb2", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"opt_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"Times", "@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"numb1", "[", 
          RowBox[{"#", ",", "opt"}], "]"}], "&"}], ",", 
        RowBox[{"Level", "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"redPlus", "[", "x_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp$", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#1", "]"}], "===", "Plus"}], "&"}]}], 
           "]"}]}], ",", "cmn$", ",", "rst$", ",", "i$", ",", "negi$"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"rst$", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"x", ",", "tmp$"}], "]"}]}], ";", 
        RowBox[{"cmn$", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{"tmp$", ",", 
           RowBox[{"-", "tmp$"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"cmn$", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", "x", "]"}]}], "]"}], ";", 
        RowBox[{"i$", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"i$", "<", 
           RowBox[{"Length", "[", "cmn$", "]"}]}], ",", 
          RowBox[{
           RowBox[{"negi$", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"cmn$", ",", 
              RowBox[{
               RowBox[{"#1", "===", 
                RowBox[{"-", 
                 RowBox[{"cmn$", "[", 
                  RowBox[{"[", "i$", "]"}], "]"}]}]}], "&"}]}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"negi$", "=!=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"cmn$", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"cmn$", ",", "negi$"}], "]"}]}]}], "]"}], ";", 
           RowBox[{"i$", "=", 
            RowBox[{"i$", "+", "1"}]}]}]}], "]"}], ";", 
        RowBox[{"Union", "[", 
         RowBox[{"rst$", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{"tmp$", ",", 
            RowBox[{"-", "cmn$"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemSym", "[", "h_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"a_", ",", "a_", ",", "c_", ",", "d_"}], "]"}], "=", "0"}], 
       ";", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "c_"}], "]"}], "=", "0"}], 
       ";", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"h", "[", 
           RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}]}], "/;", 
         RowBox[{"a", ">", "b"}]}]}], ";", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"h", "[", 
           RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"c", ">", "d"}]}]}], ";", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"c", ",", "d", ",", "a", ",", "b"}], "]"}], "/;", 
         RowBox[{
          RowBox[{"a", ">", "c"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "===", "c"}], "&&", 
            RowBox[{"b", ">", "d"}]}], ")"}]}]}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"epsilon", "[", "a__", "]"}], ":=", 
     RowBox[{"Signature", "[", 
      RowBox[{"{", "a", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"zeroTensor", "[", "rnk1_", "]"}], ":=", 
     RowBox[{"Fold", "[", 
      RowBox[{"Table", ",", "0", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{"Dim", ",", 
          RowBox[{"{", "rnk1", "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FuncRepRules", "[", 
      RowBox[{
       RowBox[{"z_", "[", "y__", "]"}], ",", "g_", ",", 
       RowBox[{"ord_", ":", "2"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FuncRepRules", "[", 
       RowBox[{
        RowBox[{"z", "[", "y", "]"}], ",", "g", ",", "ord"}], "]"}], "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tmp$", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"z", "[", "y", "]"}], "\[Rule]", "g"}], "}"}]}], ",", 
          RowBox[{"indL", "=", 
           RowBox[{"indexList", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "y", "}"}], "]"}], ",", "ord"}], "]"}]}]}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"tmp$", "=", 
            RowBox[{"{", 
             RowBox[{"tmp$", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Derivative", "[", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"indL", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", "z", "]"}], 
                "[", "y", "]"}], "\[Rule]", 
               RowBox[{"Expand", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{"D", "[", 
                  RowBox[{"g", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "y", "}"}], ",", 
                    RowBox[{"indL", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}]}], "]"}],
                  "]"}], "]"}]}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "indL", "]"}]}], "}"}]}], "]"}], ";", 
         RowBox[{"Flatten", "[", "tmp$", "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"indexList", "[", 
     RowBox[{"varNo_", ",", "ord_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp$", ",", "indL"}], "}"}], ",", 
      RowBox[{
       RowBox[{"tmp$", "=", 
        RowBox[{"NestList", "[", 
         RowBox[{"RotateRight", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"varNo", "-", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"varNo", "-", "1"}]}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ord", ">", "1"}], ",", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"indL", "=", "tmp$"}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"tmp$", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"tmp$", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Plus", "[", 
                    RowBox[{
                    RowBox[{"indL", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                   ",", "indL"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "varNo"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ord", "-", "1"}], "}"}]}], "]"}]}], "]"}], ";", 
       RowBox[{"Union", "[", "tmp$", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"M$F", "[", "x_", "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ByteCount", "[", "x", "]"}], "<", 
        RowBox[{"40000", "/", "Dim"}]}], ",", 
       RowBox[{"MatrixForm", "[", "x", "]"}], ",", 
       RowBox[{
        RowBox[{"ByteCount", "[", "x", "]"}], "<", "60000"}], ",", "x", ",", 
       "True", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Short", "[", 
           RowBox[{"#", ",", 
            RowBox[{"30", "/", "Dim"}]}], "]"}], "&"}], ",", "x", ",", "2"}], 
        "]"}]}], "]"}]}], ";", 
    RowBox[{"DclFrmNoOK", "[", 
     RowBox[{"1", ",", 
      RowBox[{"e", "[", "_", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "6."}], ",", 
     RowBox[{
      RowBox[{"st$pr6$", "[", "x__", "]"}], ":=", 
      RowBox[{"StylePrint", "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{"st$pr6$", "[", "x__", "]"}], ":=", 
      RowBox[{"Print", "[", 
       RowBox[{"Style", "[", "x", "]"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stPrint", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"y_", ":", "Null"}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "===", "Null"}], ",", 
       RowBox[{"st$pr6$", "[", 
        RowBox[{"x", ",", 
         RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
         RowBox[{"FontSlant", "\[Rule]", "\"\<Italic\>\""}], ",", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"st$pr6$", "[", 
        RowBox[{"x", ",", 
         RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
         RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"timePrint", "[", 
      RowBox[{"x_", ",", "sT_"}], "]"}], ":=", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"x", "<>", "\"\< computed in \>\""}], ",", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}], ",", "\"\< sec\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"testSER", "[", 
      RowBox[{"x_", ",", "y_String", ",", 
       RowBox[{"z_", ":", "\"\<\>\""}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "k"}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"x", ",", "SeriesData"}], "]"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dim", "===", "2"}], "&&", 
            RowBox[{
             RowBox[{"TensRnk", "[", "x", "]"}], "<", "4"}]}], ")"}]}], ",", 
         RowBox[{"y", "<>", "z"}], ",", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Which", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"TensRnk", "[", "x", "]"}], "===", "4"}], ",", 
                   RowBox[{"Raise", "[", 
                    RowBox[{"x", ",", "1", ",", "2"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"TensRnk", "[", "x", "]"}], ">", "1"}], ",", 
                   RowBox[{"Raise", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], ",", "True", ",", "x"}], 
                  "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#", "]"}], "===", "SeriesData"}], 
                 "&"}]}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}], "/", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "<", 
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}], "/", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}]}], "&"}]}], "]"}]}], ";", 
          RowBox[{"k", "=", 
           RowBox[{"\"\< to order \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], "-", "1"}], ")"}], "/", 
              RowBox[{"tmp", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";", 
          RowBox[{"y", "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tmp", "]"}], ">", "1"}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"k", "<>", "\"\< or higher\>\""}]}], ",", "k"}], 
            "]"}]}]}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Gn$Cf0", "[", 
      RowBox[{"x_List", ",", "y__"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Gn$Cf0", "[", 
        RowBox[{"#", ",", "y"}], "]"}], "&"}], "/@", "x"}]}], ";", 
    RowBox[{
     RowBox[{"Gn$Cf0", "[", 
      RowBox[{"x_SeriesData", ",", "y_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Gn$Cf0", "[", 
        RowBox[{"x", ",", "#"}], "]"}], "&"}], "/@", "y"}]}], ";", 
    RowBox[{
     RowBox[{"Gn$Cf0", "[", 
      RowBox[{"x_SeriesData", ",", "y__"}], "]"}], ":=", 
     RowBox[{"x", "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"#", ",", "y"}], "]"}], "&"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ";", 
    RowBox[{
     RowBox[{"Gn$Cf0", "[", 
      RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"GenCoef", "[", 
      RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
     RowBox[{"FacSimp", "[", 
      RowBox[{"Gn$Cf0", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"fct$rls", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x_Symbol"}], ")"}], "^", "b_."}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x_Symbol"}], ")"}], "^", "b_."}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"x", "^", "2"}]}], ")"}], "^", "b"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "x_Symbol"}], ")"}], "^", "b_."}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x_Symbol"}], ")"}], "^", "b_."}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", "^", "2"}]}], ")"}], "^", "b"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x_Symbol", "-", "y_Symbol"}], ")"}], "^", "b_."}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x_Symbol", "+", "y_Symbol"}], ")"}], "^", "b_."}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "-", 
           RowBox[{"y", "^", "2"}]}], ")"}], "^", "b"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"er$Wrn", "[", "1", "]"}], ":=", 
     RowBox[{"stPrint", "[", "\"\<coframe does not span space!\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"RGtensors", "[", 
     RowBox[{"gIN_", ",", "xIN_", ",", "opt___"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"frameOpt", "=", "0"}], ",", "eIN", ",", 
           RowBox[{"Ropt", "=", "True"}], ",", 
           RowBox[{"Wopt", "=", "True"}], ",", 
           RowBox[{"Eopt", "=", "True"}], ",", "idMat", ",", "eFrame", ",", 
           "dxRul", ",", "Bmat", ",", "Amat", ",", 
           RowBox[{"NP$", "=", "False"}], ",", "de", ",", "k$", ",", "StrCon",
            ",", "\[Gamma]Udd", ",", "\[Gamma]ddd", ",", "g1ddd", ",", 
           "g2ddd", ",", "Gamddd", ",", "rmn", ",", "tmp", ",", "RUd", ",", 
           "Rg", ",", "gg", ",", "sT", ",", "Cflat", ",", "EinSp"}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{"Clear", "[", 
           RowBox[{
           "GUdd", ",", "covD", ",", "covDiv", ",", "LieD", ",", "\[Omega]Ud",
             ",", "RUddd", ",", "Rdddd", ",", "Rdd", ",", "EUd", ",", "R", 
            ",", "Wdddd", ",", "detg", ",", "p$D", ",", "rtAbsdetg", ",", 
            "eta", ",", "HStar", ",", "Lower", ",", "Raise", ",", "\[Tau]", 
            ",", "\[Kappa]", ",", "\[Rho]", ",", "\[Sigma]", ",", "\[Gamma]", 
            ",", "\[Epsilon]", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Nu]", 
            ",", "$\[Pi]", ",", "\[Lambda]", ",", "\[Mu]", ",", 
            "\[CapitalLambda]", ",", "\[CapitalPsi]", ",", "\[CapitalPhi]", 
            ",", "\[CapitalDelta]", ",", "\[GothicCapitalD]", ",", "\[Delta]",
             ",", "\[Delta]B"}], "]"}], ";", "DEF$covD", ";", "DEF$covDiv", 
          ";", "DEF$LieD", ";", "DEF$LWR", ";", "DEF$RSE", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "xIN", "]"}], "=!=", "List"}], ",", 
            RowBox[{"tmp", "=", "\"\<Coordinates \>\""}], ",", 
            RowBox[{
             RowBox[{"Head", "[", "gIN", "]"}], "=!=", "List"}], ",", 
            RowBox[{"tmp", "=", "\"\<Metric \>\""}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "tmp", "]"}], "===", "String"}], ",", 
            RowBox[{
             RowBox[{"stPrint", "[", 
              RowBox[{"tmp", "<>", "\"\<not defined\>\""}], "]"}], ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
          RowBox[{"Dim", "=", 
           RowBox[{"Length", "[", "xIN", "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Dim", "=!=", 
             RowBox[{"Length", "[", "gIN", "]"}]}], ",", 
            RowBox[{
             RowBox[{
             "stPrint", "[", 
              "\"\<Metric and coordinate dimensions don't match\>\"", "]"}], 
             ";", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Metric \>\"", ",", 
               RowBox[{"Dimensions", "[", "gIN", "]"}], ",", "\"\<   \>\"", 
               ",", "xIN"}], "]"}], ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "gIN", "]"}], "=!=", "gIN"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Short", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"10", "/", "Dim"}]}], "]"}], "&"}], ",", "gIN", 
                 ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", 
               "\"\< is not a symmetric matrix\>\""}], "]"}], ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
          RowBox[{"eFrame", "=", 
           RowBox[{"e", "/@", 
            RowBox[{"Range", "[", "Dim", "]"}]}]}], ";", 
          RowBox[{"coordList", "=", "xIN"}], ";", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"frameOpt", "=", 
             RowBox[{"0", "=", 
              RowBox[{">", "coordFrame"}]}]}], ",", 
            RowBox[{"frameOpt", "=", 
             RowBox[{"1", "=", 
              RowBox[{">", "explicitFrame"}]}]}], ",", 
            RowBox[{"frameOpt", "=", 
             RowBox[{"2", "=", 
              RowBox[{">", "implicitFrame"}]}]}]}], "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "opt", "}"}], "]"}], ">", "0"}], ",", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", "opt", "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "_e"}], "]"}], "&&", 
                    RowBox[{"FreeALLQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"d", "[", "coordList", "]"}]}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"zeroQ", "[", 
                 RowBox[{"tmp", "/.", 
                  RowBox[{"_e", "\[Rule]", "0"}]}], "]"}], "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "tmp", "]"}], ">", "1"}]}], ",", 
               RowBox[{
                RowBox[{
                "stPrint", "[", 
                 "\"\<Evaluate Clear$dx to clear the coordinate \
differentials!\>\"", "]"}], ";", 
                RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"zeroQ", "[", 
                 RowBox[{"tmp", "/.", 
                  RowBox[{"_e", "\[Rule]", "0"}]}], "]"}], "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "tmp", "]"}], "===", "1"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "dxRuleList", "]"}], "===", "List"}], 
                  "&&", 
                  RowBox[{
                   RowBox[{"Head", "[", "deList", "]"}], "===", "List"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"frameOpt", "=", "2"}], ";", 
                  RowBox[{"eIN", "=", "eFrame"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "deList", "]"}], "=!=", "Dim"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"stPrint", "[", 
                    RowBox[{"\"\<Length[deList] is not equal to \>\"", "<>", 
                    RowBox[{"ToString", "[", "Dim", "]"}], "<>", 
                    "\"\<!\>\""}], "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "stPrint", "[", 
                   "\"\<dxRuleList and/or deList have not been defined!\>\"", 
                   "]"}], ";", 
                  RowBox[{"Return", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "opt", "}"}], "]"}], "===", "2"}], "&&", 
                RowBox[{
                 RowBox[{"FormDegree", "[", 
                  RowBox[{
                   RowBox[{"{", "opt", "}"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "1"}]}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"frameOpt", "=!=", "2"}], ",", 
                  RowBox[{
                   RowBox[{"eIN", "=", 
                    RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                   RowBox[{"frameOpt", "=", "1"}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "eIN", "]"}], "=!=", "Dim"}], ",", 
                    RowBox[{
                    RowBox[{"er$Wrn", "[", "1", "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "===", "0"}], ",", 
                  RowBox[{"Ropt", "=", "False"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "===", "0"}], ",", 
                  RowBox[{"Wopt", "=", "False"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "3"}], "&&", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "===", "0"}]}], 
                  ",", 
                  RowBox[{"Eopt", "=", "False"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "opt", "}"}], "]"}], "===", "1"}], "&&", 
                RowBox[{"IntegerQ", "[", 
                 RowBox[{"opt", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"opt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "===", "0"}], ",", 
                  RowBox[{"Ropt", "=", "False"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"opt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
                  RowBox[{"Wopt", "=", "False"}]}], "]"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "3"}], "&&", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "opt", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "===", "0"}]}], 
                  ",", 
                  RowBox[{"Eopt", "=", "False"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "opt", "}"}], "]"}], "===", "1"}], "&&", 
                RowBox[{
                 RowBox[{"FormDegree", "[", 
                  RowBox[{
                   RowBox[{"{", "opt", "}"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "1"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"frameOpt", "=!=", "2"}], ",", 
                 RowBox[{
                  RowBox[{"eIN", "=", "opt"}], ";", 
                  RowBox[{"frameOpt", "=", "1"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "eIN", "]"}], "=!=", "Dim"}], ",", 
                    RowBox[{
                    RowBox[{"er$Wrn", "[", "1", "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "]"}], ",", 
               "True", ",", 
               RowBox[{
                RowBox[{
                "stPrint", "[", "\"\<Wrong optional arguments!\>\"", "]"}], 
                ";", 
                RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"frameOpt", "===", "0"}], ",", 
            RowBox[{"eIN", "=", 
             RowBox[{"d", "/@", "xIN"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gIN", "===", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FreeALLQ", "[", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{"eIN", ",", "xIN", ",", 
                    RowBox[{"{", 
                    RowBox[{"deList", ",", "dxRuleList"}], "}"}]}], "}"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\[Tau]", ",", "\[Kappa]", ",", "\[Rho]", ",", "\[Sigma]", 
                  ",", "\[Gamma]", ",", "\[Epsilon]", ",", "\[Alpha]", ",", 
                  "\[Beta]", ",", "\[Nu]", ",", "$\[Pi]", ",", "\[Lambda]", 
                  ",", "\[Mu]", ",", "\[CapitalLambda]", ",", "\[CapitalPsi]",
                   ",", "\[CapitalPhi]", ",", "\[CapitalDelta]", ",", 
                  "\[GothicCapitalD]", ",", "\[Delta]", ",", "\[Delta]B"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"NP$", "=", "True"}], ",", 
              RowBox[{
              "stPrint", "[", 
               "\"\<NP symbols used in coordinates or frame: they will not be \
defined!\>\"", "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"gIN", ",", "eIN", ",", 
                 RowBox[{"{", "deList", "}"}]}], "}"}], ",", "SeriesData"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{"gIN", ",", "eIN", ",", 
                    RowBox[{"{", "deList", "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "===", "SeriesData"}], 
                  "&"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"xIN", ",", "tmp"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"de", "[", "1", "]"}], "=", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<d\>\"", "<>", 
                   RowBox[{"ToString", "[", "tmp", "]"}]}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{"de", "[", "2", "]"}], "=", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<\[ScriptD]\>\"", "<>", 
                   RowBox[{"ToString", "[", "tmp", "]"}]}], "]"}]}], ";", 
                RowBox[{"DclFrmNoOK", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"\[ScriptD]", "[", "_", "]"}], ",", 
                  RowBox[{"de", "[", "1", "]"}], ",", 
                  RowBox[{"de", "[", "2", "]"}]}], "]"}], ";", 
                RowBox[{
                 RowBox[{"d", "[", "tmp", "]"}], "=", 
                 RowBox[{"de", "[", "1", "]"}]}], ";", 
                RowBox[{
                 RowBox[{"\[ScriptD]", "[", "tmp", "]"}], "=", 
                 RowBox[{"de", "[", "2", "]"}]}], ";", 
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"de", "[", "1", "]"}], "]"}], "=", "0"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"frameOpt", ">", "0"}], "&&", 
                   RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"eIN", ",", 
                    RowBox[{"{", 
                    RowBox[{"deList", ",", "dxRuleList"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Derivative", "[", "1", "]"}], "[", "d", "]"}], 
                    "[", "0", "]"}]}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"stPrint", "[", 
                    RowBox[{"\"\<d[\>\"", "<>", 
                    RowBox[{"ToString", "[", "tmp", "]"}], "<>", 
                    "\"\<] not set equal to \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"de", "[", "1", "]"}], "]"}], "<>", 
                    "\"\<.  Evaluate RGtensors[...] again!\>\""}], "]"}], ";", 
                   RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"d", "[", "tmp", "]"}], "=", "0"}]}], "]"}]}]}], 
           "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"frameOpt", "===", "1"}], ",", 
            RowBox[{
             RowBox[{"DclFrmNoOK", "[", 
              RowBox[{"1", ",", 
               RowBox[{"\[ScriptD]", "[", "_", "]"}]}], "]"}], ";", 
             RowBox[{"eTO$dx", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{"eFrame", ",", 
                  RowBox[{"FacSimp", "[", 
                   RowBox[{"eIN", "/.", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "/@", "xIN"}], ",", 
                    RowBox[{"\[ScriptD]", "/@", "xIN"}]}], "}"}]}], "]"}]}], 
                   "]"}]}], "}"}]}], "]"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"frameOpt", ">", "0"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"FormDegree", "/@", "eIN"}], "]"}], "=!=", 
                RowBox[{"{", "1", "}"}]}], "||", 
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"eIN", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", "k_", "]"}], "\[Rule]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"e", "[", "_", "]"}], "\[Rule]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"y_", "|", 
                    RowBox[{"Bar", "[", "y_", "]"}]}], "\[RuleDelayed]", 
                    RowBox[{"0", "/;", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"DifFormSymbols", ",", "y"}], "]"}]}]}]}], 
                   "}"}]}], "]"}]}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
             "stPrint", "[", "\"\<coframe has incorrect form\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "varList", "]"}], "=!=", "List"}], ",", 
            RowBox[{"varList", "=", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "simpRules", "]"}], "===", "Rule"}], "||", 
             RowBox[{
              RowBox[{"Head", "[", "simpRules", "]"}], "===", 
              "RuleDelayed"}]}], ",", 
            RowBox[{"simpRules", "=", 
             RowBox[{"{", "simpRules", "}"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "simpRules", "]"}], "=!=", "List"}], ",", 
            RowBox[{"simpRules", "=", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", 
          RowBox[{"idMat", "=", 
           RowBox[{"IdentityMatrix", "[", "Dim", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gdd", "=", "gIN"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<gdd = \>\"", ",", 
            RowBox[{"M$F", "[", "gdd", "]"}]}], "]"}], ";", 
          RowBox[{"tmp", "=", 
           RowBox[{"eIN", ".", "gIN", ".", "eIN"}]}], ";", 
          RowBox[{"k$", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"frameOpt", "===", "2"}], ",", "eFrame", ",", 
             RowBox[{"d", "/@", "xIN"}]}], "]"}]}], ";", 
          RowBox[{"k$", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", "k$", ",", "k$"}], "]"}], "]"}], "]"}]}], 
          ";", 
          RowBox[{"LineElement", "=", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "tmp", "]"}], "===", "SeriesData"}], ",", 
              RowBox[{"tmp", "/.", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
                RowBox[{"Collect", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", "k$", ",", "FaSi"}], 
                 "]"}]}]}], ",", 
              RowBox[{"Collect", "[", 
               RowBox[{"tmp", ",", "k$", ",", "FaSi"}], "]"}]}], "]"}], "//.",
             "fct$rls"}]}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<LineElement = \>\"", ",", 
            RowBox[{"Short", "[", 
             RowBox[{"LineElement", ",", 
              RowBox[{"8", "Dim"}]}], "]"}]}], "]"}], ";", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", 
          RowBox[{"gUU", "=", 
           RowBox[{
            RowBox[{"FixedPoint", "[", 
             RowBox[{"FaSi", ",", 
              RowBox[{"Inverse", "[", "gIN", "]"}]}], "]"}], "//.", 
            "fct$rls"}]}], ";", 
          RowBox[{"detg", "=", 
           RowBox[{
            RowBox[{"FixedPoint", "[", 
             RowBox[{"FaSi", ",", 
              RowBox[{"Det", "[", "gIN", "]"}]}], "]"}], "//.", "fct$rls"}]}],
           ";", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<gUU = \>\"", ",", 
            RowBox[{"M$F", "[", "gUU", "]"}]}], "]"}], ";", 
          RowBox[{"timePrint", "[", 
           RowBox[{"\"\<gUU\>\"", ",", "sT"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"frameOpt", "===", "0"}], ",", 
            RowBox[{
             RowBox[{"Amat", "=", "idMat"}], ";", 
             RowBox[{"Bmat", "=", "idMat"}], ";", 
             RowBox[{"dxRul", "=", 
              RowBox[{"{", "}"}]}]}], ",", 
            RowBox[{
             RowBox[{"frameOpt", "===", "1"}], "&&", 
             RowBox[{"zeroQ", "[", 
              RowBox[{"eIN", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"d", "[", "k_", "]"}], "\[Rule]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"y_", "|", 
                   RowBox[{"Bar", "[", "y_", "]"}]}], "\[RuleDelayed]", 
                  RowBox[{"0", "/;", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"DifFormSymbols", ",", "y"}], "]"}]}]}]}], 
                "}"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Bmat", "=", 
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Gn$Cf0", "[", 
                  RowBox[{
                   RowBox[{"eIN", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], ",", 
                   RowBox[{"d", "[", 
                    RowBox[{"xIN", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Dim", ",", "Dim"}], "}"}]}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"FaSi", "[", 
                  RowBox[{"Det", "[", "Bmat", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"sT", "=", 
                 RowBox[{"TimeUsed", "[", "]"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ByteCount", "[", "eIN", "]"}], ">", 
                   RowBox[{"1500", "*", "Dim"}]}], ",", 
                  RowBox[{
                  "stPrint", "[", "\"\<Computing d[coframe]...\>\"", "]"}]}], 
                 "]"}], ";", 
                RowBox[{"Amat", "=", 
                 RowBox[{"FaSi", "[", 
                  RowBox[{"Inverse", "[", "Bmat", "]"}], "]"}]}], ";", 
                RowBox[{"dxRul", "=", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Rule", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "[", "xIN", "]"}], ",", 
                    RowBox[{"Amat", ".", "eFrame"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"tmp", "=", 
                 RowBox[{"indep$cTerms", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Outer", "[", 
                    RowBox[{"Wedge", ",", 
                    RowBox[{"d", "[", "xIN", "]"}], ",", 
                    RowBox[{"d", "[", "xIN", "]"}]}], "]"}], "]"}], "]"}]}], 
                ";", 
                RowBox[{"tmp", "=", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Rule", ",", 
                   RowBox[{"{", 
                    RowBox[{"tmp", ",", 
                    RowBox[{"FacSimp", "[", 
                    RowBox[{"tmp", "/.", "dxRul"}], "]"}]}], "}"}]}], "]"}]}],
                 ";", 
                RowBox[{"de", "=", 
                 RowBox[{"FacSimp", "[", 
                  RowBox[{"d", "[", "eIN", "]"}], "]"}]}], ";", 
                RowBox[{"de", "=", 
                 RowBox[{"FacSimp", "[", 
                  RowBox[{"de", "/.", "tmp"}], "]"}]}], ";", 
                RowBox[{"timePrint", "[", 
                 RowBox[{"\"\<d[coframe]\>\"", ",", "sT"}], "]"}], ";", 
                RowBox[{"tmp", "=", 
                 RowBox[{
                  RowBox[{"d", "[", "xIN", "]"}], "/.", "dxRul"}]}], ";", 
                RowBox[{"MapThread", "[", 
                 RowBox[{"Set", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"d", "[", "xIN", "]"}], ",", "tmp"}], "}"}]}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"er$Wrn", "[", "1", "]"}], ";", 
                RowBox[{"Return", "[", "]"}]}]}], "]"}]}], ",", 
            RowBox[{"frameOpt", "===", "2"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{"dxRuleList", ",", "deList"}], "]"}], ",", 
                  RowBox[{"e", "[", "0", "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{
                "stPrint", "[", 
                 "\"\<The notation e[0] cannot be used; renumber the frame \
components as e[1]...e[Dim]\>\"", "]"}], ";", 
                RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
             RowBox[{"de", "=", "deList"}], ";", 
             RowBox[{"dxRul", "=", "dxRuleList"}], ";", 
             RowBox[{"tmp", "=", 
              RowBox[{
               RowBox[{"d", "[", "xIN", "]"}], "/.", "dxRul"}]}], ";", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Set", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"d", "[", "xIN", "]"}], ",", "tmp"}], "}"}]}], "]"}],
              ";", 
             RowBox[{"Amat", "=", 
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Gn$Cf0", "[", 
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], ",", 
                   RowBox[{"eIN", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Dim", ",", "Dim"}], "}"}]}], "]"}]}]}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"frameOpt", "===", "2"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "SeriesData"}], "]"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"deList", ",", "dxRuleList"}], "}"}]}], "]"}], 
                 "]"}], ">", "1"}], "||", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"gIN", ",", "SeriesData"}], "]"}]}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"deList", ",", "SeriesData"}], "]"}], "||", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"dxRuleList", ",", "SeriesData"}], "]"}]}], 
                 ")"}]}]}], ")"}]}], ",", 
            RowBox[{
            "stPrint", "[", 
             "\"\<RGtensors will run faster if both deList and dxRuleList are \
expanded in series\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rtAbsdetg", "=", 
           RowBox[{"PowerExpand", "[", 
            RowBox[{
             RowBox[{"Factor", "[", 
              RowBox[{"detg", "^", "2"}], "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "/", "4"}], ")"}]}], "]"}]}], ";", 
          RowBox[{"SetAttributes", "[", 
           RowBox[{"HStar", ",", 
            RowBox[{"{", "Listable", "}"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", "0", "]"}], "=", "0"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{"NP$", ",", 
            RowBox[{"rtAbsdetg", "=", "I"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", "x_SeriesData", "]"}], ":=", 
           RowBox[{"x", "/.", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
             RowBox[{"HStar", "/@", 
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", "x_Plus", "]"}], ":=", 
           RowBox[{"FacSimp", "[", 
            RowBox[{"HStar", "/@", "x"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", 
            RowBox[{"x_", "*", "y_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"x", "*", 
             RowBox[{"HStar", "[", "y", "]"}]}], "/;", 
            RowBox[{
             RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", "x_", "]"}], ":=", 
           RowBox[{
            RowBox[{"x", "*", "rtAbsdetg", "*", 
             RowBox[{"Wedge", "@@", "eFrame"}]}], "/;", 
            RowBox[{
             RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", "x_Wedge", "]"}], ":=", 
           RowBox[{
            RowBox[{"rtAbsdetg", "/", "detg"}], "/;", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], "===", "Dim"}]}]}], ";", 
          RowBox[{
           RowBox[{"HStar", "[", 
            RowBox[{"x_Wedge", "|", "x_e"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"HStar", "[", "x", "]"}], "=", 
            RowBox[{"rtAbsdetg", "*", 
             RowBox[{"FacSimp", "[", 
              RowBox[{"inn", "[", 
               RowBox[{"x", ",", 
                RowBox[{"Wedge", "@@", "eFrame"}]}], "]"}], "]"}]}]}]}], ";", 
          RowBox[{
           RowBox[{"eta", "[", "]"}], ":=", 
           RowBox[{
            RowBox[{"eta", "[", "]"}], "=", 
            RowBox[{"rtAbsdetg", "*", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Signature", "[", 
                 RowBox[{"{", "##", "}"}], "]"}], "&"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{"Dim", ",", 
                 RowBox[{"{", "Dim", "}"}]}], "]"}]}], "]"}]}]}]}], ";", 
          RowBox[{
           RowBox[{"eta", "[", "a__", "]"}], ":=", 
           RowBox[{
            RowBox[{"eta", "[", "a", "]"}], "=", 
            RowBox[{"Raise", "[", 
             RowBox[{
              RowBox[{"eta", "[", "]"}], ",", "a"}], "]"}]}]}], ";", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"frameOpt", ">", "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"d", "[", 
               RowBox[{"e", "[", "a_", "]"}], "]"}], ":=", 
              RowBox[{"de", "[", 
               RowBox[{"[", "a", "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"StrCon", "[", 
               RowBox[{"c_", ",", "a_", ",", "a_"}], "]"}], "=", "0"}], ";", 
             RowBox[{
              RowBox[{"StrCon", "[", 
               RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"StrCon", "[", 
                 RowBox[{"c", ",", "b", ",", "a"}], "]"}]}], "/;", 
               RowBox[{"a", ">", "b"}]}]}], ";", 
             RowBox[{
              RowBox[{"StrCon", "[", 
               RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
              RowBox[{
               RowBox[{"StrCon", "[", 
                RowBox[{"c", ",", "a", ",", "b"}], "]"}], "=", 
               RowBox[{"-", 
                RowBox[{"Gn$Cf0", "[", 
                 RowBox[{
                  RowBox[{"de", "[", 
                   RowBox[{"[", "c", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"e", "[", "a", "]"}], "\[Wedge]", 
                   RowBox[{"e", "[", "b", "]"}]}]}], "]"}]}]}]}], ";", 
             RowBox[{"\[Gamma]Udd", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"StrCon", ",", 
                RowBox[{"{", 
                 RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}]}], 
             ";", 
             RowBox[{"\[Gamma]ddd", "=", 
              RowBox[{"gdd", ".", "\[Gamma]Udd"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{"NP$", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"d$f$", "[", "0", "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"de", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Wedge]", 
                   RowBox[{"e", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
                   RowBox[{"de", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", 
                RowBox[{
                 RowBox[{"d$f$", "[", "2", "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"de", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Wedge]", 
                   RowBox[{"e", "[", "4", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
                   RowBox[{"de", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";", 
                RowBox[{
                 RowBox[{"d$f$", "[", "1", "]"}], "=", 
                 RowBox[{"FacSimp", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"de", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Wedge]", 
                    RowBox[{"e", "[", "4", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
                    RowBox[{"de", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"de", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Wedge]", 
                    RowBox[{"e", "[", "1", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
                    RowBox[{"de", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "/", "2"}], 
                  "]"}]}], ";"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Gamma]Udd", "=", 
              RowBox[{"zeroTensor", "[", "3", "]"}]}], ";", 
             RowBox[{"\[Gamma]ddd", "=", "\[Gamma]Udd"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"*", "Tests"}], "**)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"frameOpt", ">", "0"}], ",", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"Union", "[", 
                   RowBox[{"Flatten", "[", "gdd", "]"}], "]"}], "]"}], "/.", 
                 "dxRul"}], ")"}], "/.", 
               RowBox[{
                RowBox[{"e", "[", "_", "]"}], "\[Rule]", "0"}]}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", "tmp", "]"}]}], ",", 
               RowBox[{
                RowBox[{
                "stPrint", "[", 
                 "\"\<Warning: d[] on some symbols not defined!\>\"", "]"}], 
                ";", 
                RowBox[{"Print", "[", 
                 RowBox[{"indep$cTerms", "[", 
                  RowBox[{"FacSimp", "[", "tmp", "]"}], "]"}], "]"}]}]}], 
              "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"frameOpt", "===", "2"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ByteCount", "[", "deList", "]"}], "+", 
                    RowBox[{"ByteCount", "[", "dxRuleList", "]"}]}], ")"}], 
                   "/", "Dim"}], "<", "3000"}], ",", 
                 RowBox[{
                  RowBox[{"tmp", "=", 
                   RowBox[{"FacSimp", "[", 
                    RowBox[{"FacSimp", "[", 
                    RowBox[{"d", "[", "deList", "]"}], "]"}], "]"}]}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"zeroQ", "[", "tmp", "]"}], ",", 
                    RowBox[{
                    "Print", "[", "\"\<deList closure verified\>\"", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    "stPrint", "[", 
                    "\"\<Warning: deList not closed! d[deList]=\>\"", "]"}], 
                    ";", 
                    RowBox[{"Print", "[", "tmp", "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"zeroQ", "[", 
                    RowBox[{"tmp", "/.", 
                    RowBox[{
                    RowBox[{"d", "[", "_", "]"}], "\[Rule]", "0"}]}], "]"}]}],
                     ",", 
                    RowBox[{"Return", "[", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                 RowBox[{
                 "stPrint", "[", "\"\<Warning: deList closure not tested\>\"",
                   "]"}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"p$D", "[", 
            RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"p$D", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Amat", "===", "idMat"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"x", ",", 
                RowBox[{"coordList", "[", 
                 RowBox[{"[", "y", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Amat", "[", 
                  RowBox[{"[", 
                   RowBox[{"k$", ",", "y"}], "]"}], "]"}], "*", 
                 RowBox[{"D", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"coordList", "[", 
                    RowBox[{"[", "k$", "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k$", ",", "Dim"}], "}"}]}], "]"}]}], "]"}]}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", 
          RowBox[{
           RowBox[{"g1ddd", "[", 
            RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"g1ddd", "[", 
             RowBox[{"b", ",", "a", ",", "c"}], "]"}], "/;", 
            RowBox[{"a", ">", "b"}]}]}], ";", 
          RowBox[{
           RowBox[{"g1ddd", "[", 
            RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"g1ddd", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], "=", 
            RowBox[{"p$D", "[", 
             RowBox[{
              RowBox[{"gdd", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", "c"}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"g2ddd", "[", 
            RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"g2ddd", "[", 
             RowBox[{"c", ",", "b", ",", "a"}], "]"}], "/;", 
            RowBox[{"a", ">", "b"}]}]}], ";", 
          RowBox[{
           RowBox[{"g2ddd", "[", 
            RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"g2ddd", "[", 
             RowBox[{"c", ",", "a", ",", "b"}], "]"}], "=", 
            RowBox[{"FaSi", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g1ddd", "[", 
                 RowBox[{"a", ",", "c", ",", "b"}], "]"}], "+", 
                RowBox[{"g1ddd", "[", 
                 RowBox[{"b", ",", "c", ",", "a"}], "]"}], "-", 
                RowBox[{"g1ddd", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ")"}], "/", 
              "2"}], "]"}]}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"frameOpt", "===", "0"}], ",", 
            RowBox[{
             RowBox[{"Gamddd", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"g2ddd", ",", 
                RowBox[{"{", 
                 RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Clear", "[", "tmp", "]"}], ";", 
             RowBox[{"k$", "=", 
              RowBox[{"gUU", ".", "Gamddd"}]}], ";", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"c", ",", "b", ",", "a"}], "]"}], "/;", 
               RowBox[{"a", ">", "b"}]}]}], ";", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"c_", ",", "a_", ",", "b_"}], "]"}], ":=", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"c", ",", "a", ",", "b"}], "]"}], "=", 
               RowBox[{"FaSi", "[", 
                RowBox[{"k$", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], "]"}]}]}], 
             ";", 
             RowBox[{"GUdd", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"tmp", ",", 
                RowBox[{"{", 
                 RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}]}]}], 
            ",", 
            RowBox[{
             RowBox[{"Gamddd", "=", 
              RowBox[{"FaSi", "[", 
               RowBox[{
                RowBox[{"Array", "[", 
                 RowBox[{"g2ddd", ",", 
                  RowBox[{"{", 
                   RowBox[{"Dim", ",", "Dim", ",", "Dim"}], "}"}]}], "]"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Gamma]ddd", "+", 
                   RowBox[{"Transpose", "[", "\[Gamma]ddd", "]"}], "-", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"\[Gamma]ddd", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}]}], 
                  ")"}], "/", "2"}]}], "]"}]}], ";", 
             RowBox[{"GUdd", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"NumericQ", "/@", 
                    RowBox[{"Flatten", "[", "gUU", "]"}]}], "]"}], "===", 
                  RowBox[{"{", "True", "}"}]}], "&&", 
                 RowBox[{
                  RowBox[{"nonZeroN", "[", "gUU", "]"}], "===", "Dim"}]}], 
                ",", 
                RowBox[{"gUU", ".", "Gamddd"}], ",", 
                RowBox[{"FaSi", "[", 
                 RowBox[{"gUU", ".", "Gamddd"}], "]"}]}], "]"}]}]}]}], "]"}], 
          ";", 
          RowBox[{"timePrint", "[", 
           RowBox[{"\"\<Gamma\>\"", ",", "sT"}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"frameOpt", ">", "0"}], ",", 
            RowBox[{"\[Omega]Ud", "=", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"GUdd", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "k$", ",", "#2"}], "]"}], "]"}], "*", 
                   RowBox[{"e", "[", "k$", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k$", ",", "Dim"}], "}"}]}], "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"Dim", ",", "Dim"}], "}"}]}], "]"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{"NP$", ",", "NPdefs1"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", 
          RowBox[{"RiemSym", "[", "rmn", "]"}], ";", 
          RowBox[{
           RowBox[{"rmn", "[", 
            RowBox[{"a_", ",", "b_", ",", "c_", ",", "d$_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"rmn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], "=", 
            RowBox[{"FaSi", "[", 
             RowBox[{
              RowBox[{"p$D", "[", 
               RowBox[{
                RowBox[{"Gamddd", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "d$", ",", "b"}], "]"}], "]"}], ",", 
                "c"}], "]"}], "-", 
              RowBox[{"p$D", "[", 
               RowBox[{
                RowBox[{"Gamddd", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "c", ",", "b"}], "]"}], "]"}], ",", 
                "d$"}], "]"}], "+", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"GUdd", "[", 
                   RowBox[{"[", 
                    RowBox[{"k$", ",", "c", ",", "b"}], "]"}], "]"}], "*", 
                  RowBox[{"Gamddd", "[", 
                   RowBox[{"[", 
                    RowBox[{"k$", ",", "d$", ",", "a"}], "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"GUdd", "[", 
                   RowBox[{"[", 
                    RowBox[{"k$", ",", "d$", ",", "b"}], "]"}], "]"}], "*", 
                  RowBox[{"Gamddd", "[", 
                   RowBox[{"[", 
                    RowBox[{"k$", ",", "c", ",", "a"}], "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Gamddd", "[", 
                   RowBox[{"[", 
                    RowBox[{"a", ",", "k$", ",", "b"}], "]"}], "]"}], "*", 
                  RowBox[{"\[Gamma]Udd", "[", 
                   RowBox[{"[", 
                    RowBox[{"k$", ",", "c", ",", "d$"}], "]"}], "]"}]}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"k$", ",", "Dim"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
          RowBox[{"Rdddd", "=", 
           RowBox[{"Array", "[", 
            RowBox[{"rmn", ",", 
             RowBox[{"{", 
              RowBox[{"Dim", ",", "Dim", ",", "Dim", ",", "Dim"}], "}"}]}], 
            "]"}]}], ";", 
          RowBox[{"timePrint", "[", 
           RowBox[{"\"\<Riemann(dddd)\>\"", ",", "sT"}], "]"}], ";", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", "Rdddd", "]"}], ",", 
            RowBox[{
             RowBox[{"stPrint", "[", 
              RowBox[{
               RowBox[{"testSER", "[", 
                RowBox[{
                "Rdddd", ",", "\"\<Flat Space\>\"", ",", "\"\<!\>\""}], "]"}],
                ",", "1"}], "]"}], ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
          RowBox[{"Rg", "=", 
           RowBox[{"gUU", ".", "Rdddd"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{"Ropt", ",", 
            RowBox[{
             RowBox[{"Clear", "[", "rmn", "]"}], ";", 
             RowBox[{
              RowBox[{"rmn", "[", 
               RowBox[{"a_", ",", "b_", ",", "c_", ",", "c_"}], "]"}], "=", 
              "0"}], ";", 
             RowBox[{
              RowBox[{"rmn", "[", 
               RowBox[{"a_", ",", "b_", ",", "c_", ",", "d$_"}], "]"}], ":=", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"rmn", "[", 
                 RowBox[{"a", ",", "b", ",", "d$", ",", "c"}], "]"}]}], "/;", 
               RowBox[{"c", ">", "d$"}]}]}], ";", 
             RowBox[{
              RowBox[{"rmn", "[", 
               RowBox[{"a_", ",", "b_", ",", "c_", ",", "d$_"}], "]"}], ":=", 
              RowBox[{
               RowBox[{"rmn", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], "=", 
               RowBox[{"FaSi", "[", 
                RowBox[{"Rg", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], "]"}], 
                "]"}]}]}], ";", 
             RowBox[{"RUddd", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"rmn", ",", 
                RowBox[{"{", 
                 RowBox[{"Dim", ",", "Dim", ",", "Dim", ",", "Dim"}], "}"}]}],
                "]"}]}], ";", 
             RowBox[{"timePrint", "[", 
              RowBox[{"\"\<Riemann(Uddd)\>\"", ",", "sT"}], "]"}], ";", 
             RowBox[{"Rg", "=", "RUddd"}]}], ",", 
            RowBox[{"stPrint", "[", "\"\<RUddd not computed\>\"", "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", 
          RowBox[{"Rg", "=", 
           RowBox[{"Plus", "@@", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Rg", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "1", ",", "3"}], "}"}]}], 
             "]"}]}]}], ";", 
          RowBox[{"Clear", "[", "tmp", "]"}], ";", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"b", ",", "a"}], "]"}], "/;", 
            RowBox[{"a", ">", "b"}]}]}], ";", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "=", 
            RowBox[{"FaSi", "[", 
             RowBox[{"Rg", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "b"}], "]"}], "]"}], "]"}]}]}], ";", 
          RowBox[{"Rdd", "=", 
           RowBox[{"Array", "[", 
            RowBox[{"tmp", ",", 
             RowBox[{"{", 
              RowBox[{"Dim", ",", "Dim"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"RUd", "=", 
           RowBox[{"gUU", ".", "Rdd"}]}], ";", 
          RowBox[{"R", "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"Plus", "@@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"RUd", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";", 
          RowBox[{"timePrint", "[", 
           RowBox[{"\"\<Ricci\>\"", ",", "sT"}], "]"}], ";", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Wopt", "||", 
             RowBox[{"Dim", "<", "4"}]}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Dim", ">", "3"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"zeroQ", "[", "Rdd", "]"}], ",", 
                 RowBox[{"Wdddd", "=", "Rdddd"}], ",", 
                 RowBox[{
                  RowBox[{"gg", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"Outer", "[", 
                    RowBox[{"Times", ",", "gdd", ",", "gdd"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], 
                    "]"}]}], ";", 
                  RowBox[{"gg", "=", 
                   RowBox[{"gg", "-", 
                    RowBox[{"Transpose", "[", "gg", "]"}]}]}], ";", 
                  RowBox[{"Rg", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"Outer", "[", 
                    RowBox[{"Times", ",", "Rdd", ",", "gdd"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], 
                    "]"}]}], ";", 
                  RowBox[{"Rg", "=", 
                   RowBox[{"Rg", "-", 
                    RowBox[{"Transpose", "[", "Rg", "]"}]}]}], ";", 
                  RowBox[{"Rg", "=", 
                   RowBox[{"Rg", "-", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Rg", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], 
                    "]"}]}]}], ";", 
                  RowBox[{"Clear", "[", "rmn", "]"}], ";", 
                  RowBox[{"RiemSym", "[", "rmn", "]"}], ";", 
                  RowBox[{
                   RowBox[{"rmn", "[", 
                    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d$_"}], "]"}], ":=", 
                   RowBox[{
                    RowBox[{"rmn", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], "=", 
                    RowBox[{"FaSi", "[", 
                    RowBox[{
                    RowBox[{"Rdddd", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], 
                    "]"}], "-", 
                    RowBox[{
                    RowBox[{"Rg", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], 
                    "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"Dim", "-", "2"}], ")"}]}], "+", 
                    RowBox[{"R", "*", 
                    RowBox[{
                    RowBox[{"gg", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d$"}], "]"}], 
                    "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Dim", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"Dim", "-", "2"}], ")"}]}], ")"}]}]}]}], 
                    "]"}]}]}], ";", 
                  RowBox[{"Wdddd", "=", 
                   RowBox[{"Array", "[", 
                    RowBox[{"rmn", ",", 
                    RowBox[{"{", 
                    RowBox[{"Dim", ",", "Dim", ",", "Dim", ",", "Dim"}], 
                    "}"}]}], "]"}]}]}]}], "]"}], ",", 
               RowBox[{"Wdddd", "=", 
                RowBox[{"zeroTensor", "[", "4", "]"}]}]}], "]"}], ";", 
             RowBox[{"timePrint", "[", 
              RowBox[{"\"\<Weyl\>\"", ",", "sT"}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"zeroQ", "[", "Wdddd", "]"}], ",", 
               RowBox[{
                RowBox[{"Cflat", "=", "True"}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dim", "=!=", "3"}], ",", 
                  RowBox[{"stPrint", "[", 
                   RowBox[{
                    RowBox[{"testSER", "[", 
                    RowBox[{"Wdddd", ",", "\"\<Conformally Flat\>\""}], "]"}],
                     ",", "1"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"tmp", "=", 
                    RowBox[{"CF3d", "[", "Wopt", "]"}]}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroQ", "[", "tmp", "]"}], ",", 
                    RowBox[{"stPrint", "[", 
                    RowBox[{
                    RowBox[{"testSER", "[", 
                    RowBox[{"tmp", ",", "\"\<Conformally Flat\>\""}], "]"}], 
                    ",", "1"}], "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}], ",", 
            RowBox[{
            "stPrint", "[", "\"\<Weyl tensor not computed\>\"", "]"}]}], 
           "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{"NP$", ",", "NPdefs2"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"sT", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{"Eopt", ",", 
            RowBox[{"EUd", "=", 
             RowBox[{"FaSi", "[", 
              RowBox[{"RUd", "-", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "*", "R", "*", "idMat"}]}], "]"}]}], 
            ",", 
            RowBox[{
            "stPrint", "[", "\"\<Einstein tensor not computed\>\"", "]"}]}], 
           "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", "Rdd", "]"}], ",", 
            RowBox[{"stPrint", "[", 
             RowBox[{
              RowBox[{"testSER", "[", 
               RowBox[{"Rdd", ",", "\"\<Ricci Flat\>\""}], "]"}], ",", "1"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"Eopt", ",", 
               RowBox[{"timePrint", "[", 
                RowBox[{"\"\<Einstein\>\"", ",", "sT"}], "]"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Eopt", "&&", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"EUd", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", 
                    RowBox[{"1", "/", "Dim"}]}], ")"}], "*", "R", "*", 
                   "idMat"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"stPrint", "[", 
                 RowBox[{
                  RowBox[{"testSER", "[", 
                   RowBox[{
                    RowBox[{"Rdd", "-", 
                    RowBox[{
                    RowBox[{"1", "/", "Dim"}], "*", "R", "*", "gdd"}]}], ",", 
                    "\"\<Einstein Space\>\""}], "]"}], ",", "1"}], "]"}], ";", 
                RowBox[{"EinSp", "=", "True"}]}]}], "]"}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Dim", ">", "2"}], "&&", "Cflat", "&&", "EinSp"}], "||", 
             RowBox[{
              RowBox[{"Dim", "===", "2"}], "&&", 
              RowBox[{"zeroQ", "[", 
               RowBox[{"FaSi", "[", 
                RowBox[{"covD", "[", "R", "]"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"stPrint", "[", 
             RowBox[{
              RowBox[{"testSER", "[", 
               RowBox[{
                RowBox[{"Rdd", "-", 
                 RowBox[{
                  RowBox[{"1", "/", "Dim"}], "*", "R", "*", "gdd"}]}], ",", 
                "\"\<Space of Constant Curvature\>\"", ",", "\"\<!\>\""}], 
               "]"}], ",", "1"}], "]"}]}], "]"}], ";", 
          "\"\<All tasks completed in \>\""}]}], "]"}], "//", "Timing"}], "//", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#2", "<>", 
           RowBox[{"ToString", "[", "#1", "]"}], "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"$VersionNumber", ">", "5.5"}], ",", "\"\< seconds\>\"", 
             ",", "\"\<\>\""}], "]"}]}], "&"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", 
              RowBox[{"Return", "[", "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", "Null"}]}], ",", 
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
              "\"\<Aborted after \>\""}]}], ",", "#"}], "]"}], "/.", 
          RowBox[{"Second", "\[Rule]", "\"\<seconds\>\""}]}]}], "]"}], 
       "&"}]}], "//", "Print"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CF3d", "[", "x_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{
        "stPrint", "[", "\"\<Testing for 3-dim conformal flatness...\>\"", 
         "]"}], ";", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tmp$", "=", 
            RowBox[{
             RowBox[{"covD", "[", "Rdd", "]"}], "-", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", "gdd", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"covD", "[", "R", "]"}], "/", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{"Dim", "-", "1"}], ")"}]}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"FaSi", "[", 
           RowBox[{"tmp$", "-", 
            RowBox[{"Transpose", "[", 
             RowBox[{"tmp$", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
         "]"}]}], ",", 
       RowBox[{
        RowBox[{
        "stPrint", "[", "\"\<3-dim conformal flatness not tested\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "1", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"NPdefs1", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"$\[Pi]", "=", 
       RowBox[{"GenCoef", "[", 
        RowBox[{
         RowBox[{"d$f$", "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "3", "]"}]}]}], "]"}]}], ";", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"GenCoef", "[", 
        RowBox[{
         RowBox[{"d$f$", "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}], ";", 
      RowBox[{"\[Tau]", "=", 
       RowBox[{"-", 
        RowBox[{"GenCoef", "[", 
         RowBox[{
          RowBox[{"d$f$", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}]}], ";", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{"-", 
        RowBox[{"GenCoef", "[", 
         RowBox[{
          RowBox[{"d$f$", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}]}], ";", 
      RowBox[{"tmp$", "=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{
         RowBox[{"d$f$", "[", "0", "]"}], "+", 
         RowBox[{"\[Tau]", " ", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "+", 
         RowBox[{"\[Rho]", " ", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}]}]}]}], "]"}]}], ";", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{
        RowBox[{"GenCoef", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}]}]}], "]"}], "/", "2"}]}], ";", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{
        RowBox[{"GenCoef", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "]"}], "/", "2"}]}], ";", 
      RowBox[{"\[Sigma]", "=", 
       RowBox[{"-", 
        RowBox[{"GenCoef", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}]}], ";", 
      RowBox[{"\[Kappa]", "=", 
       RowBox[{"-", 
        RowBox[{"GenCoef", "[", 
         RowBox[{"tmp$", ",", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}]}], ";", 
      RowBox[{"tmp$", "=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{
         RowBox[{"d$f$", "[", "2", "]"}], "-", 
         RowBox[{"$\[Pi]", " ", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}], "-", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
           RowBox[{"e", "[", "4", "]"}]}]}]}], "]"}]}], ";", 
      RowBox[{"\[Gamma]", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"GenCoef", "[", 
          RowBox[{"tmp$", ",", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
            RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
            RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}], "/", "2"}]}], ";", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"GenCoef", "[", 
          RowBox[{"tmp$", ",", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
            RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
            RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}], "/", "2"}]}], ";", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"GenCoef", "[", 
        RowBox[{"tmp$", ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "2", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "3", "]"}]}]}], "]"}]}], ";", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"GenCoef", "[", 
        RowBox[{"tmp$", ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "3", "]"}], "\[Wedge]", 
          RowBox[{"e", "[", "4", "]"}]}]}], "]"}]}], ";", 
      RowBox[{
      "Print", "[", 
       "\"\<Spin coefficients \[Tau], \[Kappa], \[Rho], \[Sigma], \[Gamma], \
\[Epsilon], \[Alpha], \[Beta], \[Nu], $\[Pi], \[Lambda], \[Mu] defined\>\"", 
       "]"}], ";", 
      RowBox[{
       RowBox[{"Bar", "[", 
        RowBox[{"e", "[", "1", "]"}], "]"}], "=", 
       RowBox[{"e", "[", "1", "]"}]}], ";", 
      RowBox[{
       RowBox[{"Bar", "[", 
        RowBox[{"e", "[", "2", "]"}], "]"}], "=", 
       RowBox[{"e", "[", "2", "]"}]}], ";", 
      RowBox[{
       RowBox[{"Bar", "[", 
        RowBox[{"e", "[", "4", "]"}], "]"}], "=", 
       RowBox[{"e", "[", "3", "]"}]}], ";", 
      RowBox[{
       RowBox[{"Bar", "[", 
        RowBox[{"e", "[", "3", "]"}], "]"}], "=", 
       RowBox[{"e", "[", "4", "]"}]}], ";", 
      RowBox[{
       RowBox[{"Bar", "[", "x_", "]"}], ":=", "x"}], ";", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", "[", "x_", "]"}], ":=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"p$D", "[", 
         RowBox[{"x", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"\[GothicCapitalD]", "[", "x_", "]"}], ":=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"p$D", "[", 
         RowBox[{"x", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "x_", "]"}], ":=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"-", 
         RowBox[{"p$D", "[", 
          RowBox[{"x", ",", "4"}], "]"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"\[Delta]B", "[", "x_", "]"}], ":=", 
       RowBox[{"FacSimp", "[", 
        RowBox[{"-", 
         RowBox[{"p$D", "[", 
          RowBox[{"x", ",", "3"}], "]"}]}], "]"}]}], ";", 
      RowBox[{
      "Print", "[", 
       "\"\<Differential Operators \[GothicCapitalD][x_], \
\[CapitalDelta][x_], \[Delta][x_], \[Delta]B[x_] defined\>\"", "]"}], ";"}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"NPdefs2", ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"0", ",", "0"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Rdd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Rdd", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Rdd", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Rdd", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Rdd", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Rdd", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "1"}], "]"}], "]"}]}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Rdd", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Rdd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "/", "2"}]}], ";", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "=", 
        RowBox[{"FaSi", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Rdd", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{"Rdd", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ")"}], "/", "4"}], 
         "]"}]}], ";", 
       RowBox[{"\[CapitalLambda]", "=", 
        RowBox[{
         RowBox[{"-", "R"}], "/", "24"}]}], ";", 
       RowBox[{
       "tmp$", "=", 
        "\"\<NP variables \[CapitalPhi][i,j], \[CapitalLambda] \>\""}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "Wdddd", "]"}], "=!=", "Symbol"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalPsi]", "[", "0", "]"}], "=", 
           RowBox[{"-", 
            RowBox[{"Wdddd", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4", ",", "2", ",", "4"}], "]"}], "]"}]}]}], 
          ";", 
          RowBox[{
           RowBox[{"\[CapitalPsi]", "[", "1", "]"}], "=", 
           RowBox[{"Wdddd", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "4", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"\[CapitalPsi]", "[", "2", "]"}], "=", 
           RowBox[{"-", 
            RowBox[{"Wdddd", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "]"}]}]}], 
          ";", 
          RowBox[{
           RowBox[{"\[CapitalPsi]", "[", "3", "]"}], "=", 
           RowBox[{"Wdddd", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1", ",", "3", ",", "1"}], "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"\[CapitalPsi]", "[", "4", "]"}], "=", 
           RowBox[{"-", 
            RowBox[{"Wdddd", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1", ",", "3", ",", "1"}], "]"}], "]"}]}]}], 
          ";", 
          RowBox[{"tmp$", "=", 
           RowBox[{"tmp$", "<>", "\"\<and \[CapitalPsi][i] \>\""}]}]}]}], 
        "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"tmp$", "<>", "\"\<defined\>\""}], "]"}], ";"}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{"y_Wedge", ",", "x_"}], "]"}], ":=", 
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "y", "]"}], ",", 
       RowBox[{"inn", "[", 
        RowBox[{
         RowBox[{"First", "[", "y", "]"}], ",", "x"}], "]"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a_", "]"}], ",", 
       RowBox[{"x_", "+", "y_"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"inn", "[", 
       RowBox[{
        RowBox[{"e", "[", "a", "]"}], ",", "x"}], "]"}], "+", 
      RowBox[{"inn", "[", 
       RowBox[{
        RowBox[{"e", "[", "a", "]"}], ",", "y"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a_", "]"}], ",", 
       RowBox[{"x_", "*", "y_"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"x", "*", 
       RowBox[{"inn", "[", 
        RowBox[{
         RowBox[{"e", "[", "a", "]"}], ",", "y"}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a_", "]"}], ",", "x_"}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{
       RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}], ";", 
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a_", "]"}], ",", "x_Wedge"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"inn", "[", 
        RowBox[{
         RowBox[{"e", "[", "a", "]"}], ",", 
         RowBox[{"First", "[", "x", "]"}]}], "]"}], "*", 
       RowBox[{"Rest", "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"FormDegree", "[", 
         RowBox[{"First", "[", "x", "]"}], "]"}]}], "*", 
       RowBox[{
        RowBox[{"First", "[", "x", "]"}], "\[Wedge]", 
        RowBox[{"inn", "[", 
         RowBox[{
          RowBox[{"e", "[", "a", "]"}], ",", 
          RowBox[{"Rest", "[", "x", "]"}]}], "]"}]}]}]}]}], ";", 
    RowBox[{
     RowBox[{"inn", "[", 
      RowBox[{
       RowBox[{"e", "[", "a_", "]"}], ",", 
       RowBox[{"e", "[", "b_", "]"}]}], "]"}], ":=", 
     RowBox[{"gUU", "[", 
      RowBox[{"[", 
       RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"TensRnk", "[", "x_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "x", "]"}], "===", "List"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}], ",", "0"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveIndex", "[", 
      RowBox[{"x_", ",", "i_", ",", "g_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rnk1", "=", 
          RowBox[{"TensRnk", "[", "x", "]"}]}], ",", "indL"}], "}"}], ",", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"i", "===", "1"}], ",", 
         RowBox[{"g", ".", "x"}], ",", 
         RowBox[{"i", "===", "rnk1"}], ",", 
         RowBox[{"x", ".", "g"}], ",", "True", ",", 
         RowBox[{
          RowBox[{"indL", "=", 
           RowBox[{
            RowBox[{"Range", "[", "rnk1", "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "\[Rule]", "1"}], ",", 
              RowBox[{"1", "\[Rule]", "i"}]}], "}"}]}]}], ";", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"g", ".", 
             RowBox[{"Transpose", "[", 
              RowBox[{"x", ",", "indL"}], "]"}]}], ",", "indL"}], "]"}]}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    "\n", 
   RowBox[{"DEF$LWR", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Lower", "[", 
        RowBox[{"x_", ",", "i__"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Lower", "[", 
         RowBox[{"x", ",", "i"}], "]"}], "=", 
        RowBox[{"FacSimp", "[", 
         RowBox[{
          RowBox[{"FoldList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MoveIndex", "[", 
              RowBox[{"#1", ",", "#2", ",", "gdd"}], "]"}], "&"}], ",", "x", 
            ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", "i", "}"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"DEF$RSE", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Raise", "[", 
        RowBox[{"x_", ",", "i__"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Raise", "[", 
         RowBox[{"x", ",", "i"}], "]"}], "=", 
        RowBox[{"FacSimp", "[", 
         RowBox[{
          RowBox[{"FoldList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MoveIndex", "[", 
              RowBox[{"#1", ",", "#2", ",", "gUU"}], "]"}], "&"}], ",", "x", 
            ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", "i", "}"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"DEF$LWR", ";", "DEF$RSE", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"multiDot", "[", 
      RowBox[{"x_", ",", "y_", ",", "indPr__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rnk1", "=", 
          RowBox[{"TensRnk", "[", "x", "]"}]}], ",", 
         RowBox[{"rnk2", "=", 
          RowBox[{"TensRnk", "[", "y", "]"}]}], ",", 
         RowBox[{"indL", "=", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", "indPr", "}"}], "]"}]}]}], ",", 
         RowBox[{"ordPr", "=", 
          RowBox[{"Sort", "[", 
           RowBox[{"{", "indPr", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"And", "@@", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SameQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x", "]"}], "[", 
                  RowBox[{"[", "#1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "y", "]"}], "[", 
                  RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
              RowBox[{"Transpose", "[", "ordPr", "]"}]}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"er$Wrn", "[", "3", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"First", "[", "indL", "]"}], "]"}], "=!=", 
            RowBox[{"First", "[", "indL", "]"}]}], "||", 
           RowBox[{
            RowBox[{"indL", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ">", "rnk1"}], "||", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"indL", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{"indL", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "||", 
           RowBox[{
            RowBox[{"Last", "[", 
             RowBox[{"indL", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "rnk2"}]}], ",", 
          RowBox[{
           RowBox[{"er$Wrn", "[", "2", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ordPr", "]"}], "===", "1"}], ",", 
          RowBox[{"FacSimp", "[", 
           RowBox[{"dotOne", "[", 
            RowBox[{"x", ",", "y", ",", "indPr"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"rnk1", "===", "rnk2"}], "&&", 
           RowBox[{"rnk1", "===", 
            RowBox[{"Length", "[", "ordPr", "]"}]}]}], ",", 
          RowBox[{"FacSimp", "[", 
           RowBox[{"FacSimp", "[", 
            RowBox[{"dotAll", "[", 
             RowBox[{"x", ",", "y", ",", "ordPr"}], "]"}], "]"}], "]"}], ",", 
          "True", ",", 
          RowBox[{"OKindCon", "[", 
           RowBox[{
            RowBox[{"dotOne", "[", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"First", "[", "ordPr", "]"}]}], "]"}], ",", 
            RowBox[{"newPrList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a_", ",", "b_"}], "}"}], "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", 
                    RowBox[{"b", "+", "rnk1"}]}], "}"}]}]}], "]"}], "&"}], "/@",
               "ordPr"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dotOne", "[", 
      RowBox[{"x_", ",", "y_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rnk1", "=", 
          RowBox[{"TensRnk", "[", "x", "]"}]}], ",", 
         RowBox[{"rnk2", "=", 
          RowBox[{"TensRnk", "[", "y", "]"}]}], ",", "tmp$"}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}], "||", 
             RowBox[{"MatQ", "[", 
              RowBox[{"Last", "[", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "]"}]}], 
            ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FormDegree", "[", "y", "]"}], ">", "0"}], "||", 
             RowBox[{"MatQ", "[", 
              RowBox[{"Last", "[", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", "y", "]"}], "]"}], "]"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"tmp$", "=", "Wedge"}], ",", 
          RowBox[{"tmp$", "=", "Dot"}]}], "]"}], ";", 
        RowBox[{"tmp$", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"x", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ",", 
              RowBox[{"RotateRight", "[", 
               RowBox[{"Range", "[", 
                RowBox[{"i", ",", "rnk1"}], "]"}], "]"}]}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"y", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"RotateLeft", "[", 
               RowBox[{"Range", "[", "j", "]"}], "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", "rnk2"}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dotAll", "[", 
      RowBox[{"x_", ",", "y_", ",", "indPr_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s$", ",", "allInd", ",", "sumInd", ",", "tmp$"}], "}"}], ",", 
       RowBox[{
        RowBox[{"allInd", "=", 
         RowBox[{"s$", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "indPr", "]"}], "]"}]}]}], ";", 
        RowBox[{"allInd", "=", 
         RowBox[{"{", 
          RowBox[{"allInd", ",", 
           RowBox[{"allInd", "/.", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Rule", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
              RowBox[{"RotateLeft", "/@", "indPr"}]}], "]"}]}]}], "}"}]}], 
        ";", 
        RowBox[{"sumInd", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "[", "allInd", "]"}], ",", 
            RowBox[{"Dimensions", "[", "x", "]"}]}], "}"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}], "||", 
             RowBox[{"MatQ", "[", 
              RowBox[{"Last", "[", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", "x", "]"}], "]"}], "]"}], "]"}]}], 
            ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FormDegree", "[", "y", "]"}], ">", "0"}], "||", 
             RowBox[{"MatQ", "[", 
              RowBox[{"Last", "[", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", "y", "]"}], "]"}], "]"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"tmp$", "=", "Wedge"}], ",", 
          RowBox[{"tmp$", "=", "Times"}]}], "]"}], ";", 
        RowBox[{"Sum", "@@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Unevaluated", "[", 
            RowBox[{"tmp$", "[", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"First", "[", "allInd", "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"allInd", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"Sequence", "@@", "sumInd"}]}], "}"}]}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Contract", "[", 
      RowBox[{"x_", ",", "indPr__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rnk1", "=", 
          RowBox[{"TensRnk", "[", "x", "]"}]}], ",", 
         RowBox[{"indL", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "indPr", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"And", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SameQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "x", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
               "&"}], ",", 
              RowBox[{"{", "indPr", "}"}]}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"er$Wrn", "[", "3", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Union", "[", "indL", "]"}], "]"}], "<", 
            RowBox[{"Length", "[", "indL", "]"}]}], "||", 
           RowBox[{
            RowBox[{"Length", "[", "indL", "]"}], ">", "rnk1"}], "||", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", "indL", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ">", "rnk1"}]}], ",", 
          RowBox[{
           RowBox[{"er$Wrn", "[", "2", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}], ",", 
          RowBox[{"OKindCon", "[", 
           RowBox[{"x", ",", 
            RowBox[{"Sort", "[", 
             RowBox[{"Sort", "/@", 
              RowBox[{"{", "indPr", "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"newPrList", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Rest", "[", "x", "]"}], "-", "1"}], "/.", 
      RowBox[{"k_", "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"k", "-", "1"}], "/;", 
        RowBox[{"k", ">", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", "1"}]}]}]}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OKindCon", "[", 
      RowBox[{"x_", ",", "indPr_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FacSimp", "[", 
       RowBox[{"ConOne", "[", 
        RowBox[{"x", ",", 
         RowBox[{"First", "[", "indPr", "]"}]}], "]"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Length", "[", "indPr", "]"}], "===", "1"}]}]}], ";", 
    RowBox[{
     RowBox[{"OKindCon", "[", 
      RowBox[{"x_", ",", "indPr_"}], "]"}], ":=", 
     RowBox[{"OKindCon", "[", 
      RowBox[{
       RowBox[{"ConOne", "[", 
        RowBox[{"x", ",", 
         RowBox[{"First", "[", "indPr", "]"}]}], "]"}], ",", 
       RowBox[{"newPrList", "[", "indPr", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConOne", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rnk1", "=", 
          RowBox[{"TensRnk", "[", "x", "]"}]}], ",", "tr1List", ",", 
         "tr2List"}], "}"}], ",", 
       RowBox[{
        RowBox[{"tr1List", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", "rnk1", "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"j", "\[Rule]", "i"}], "}"}]}], ")"}], "/.", 
          RowBox[{"k_", "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"k", "-", "1"}], "/;", 
            RowBox[{"k", ">", "j"}]}]}]}]}], ";", 
        RowBox[{"tr2List", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"Range", "[", 
             RowBox[{"i", ",", 
              RowBox[{"rnk1", "-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"x", ",", "tr1List"}], "]"}], ",", "tr2List"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"rnk1", "-", "2"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"er$Wrn", "[", "2", "]"}], ":=", 
     RowBox[{
     "stPrint", "[", "\"\<Wrong tensor rank or number(s) of indices!\>\"", 
      "]"}]}], ";", 
    RowBox[{
     RowBox[{"er$Wrn", "[", "3", "]"}], ":=", 
     RowBox[{
     "stPrint", "[", "\"\<Summed indices have unequal dimensions!\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"DEF$covD", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"covD", "[", 
        RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"covD", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "=", 
        RowBox[{"c$D", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"covD", "[", 
        RowBox[{"x_", ",", "y_List"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], ">", "0"}], ",", 
         RowBox[{"er$Wrn", "[", "2", "]"}], ",", 
         RowBox[{"covD", "[", "x", "]"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"covD", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"covD", "[", "x", "]"}], "=", 
        RowBox[{"c$D", "[", "x", "]"}]}]}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"c$D", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"UpList_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", "=", 
         RowBox[{"TensRnk", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "UpList", "]"}], ">", "0"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], ">", "k"}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ">", "k"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"er$Wrn", "[", "2", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "x", "]"}], "===", "List"}], ",", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"cDcomp", "[", 
             RowBox[{"x", ",", "k", ",", "UpList"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"Dim", ",", 
              RowBox[{"{", 
               RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"FaSi", "[", 
           RowBox[{"Array", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p$D", "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"{", "Dim", "}"}]}], "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"cDcomp", "[", 
       RowBox[{"x_", ",", "rnk1_", ",", 
        RowBox[{"UpList_", ":", 
         RowBox[{"{", "}"}]}]}], "]"}], "[", "y__", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i$", ",", "j$", ",", 
         RowBox[{"y$", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "y", "}"}], ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ",", 
         RowBox[{"z$", "=", 
          RowBox[{"Last", "[", 
           RowBox[{"{", "y", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"FaSi", "[", 
        RowBox[{
         RowBox[{"p$D", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"Sequence", "@@", "y$"}], "]"}], "]"}], ",", "z$"}], 
          "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"UpList", ",", "i$"}], "]"}], ",", 
             RowBox[{
              RowBox[{"GUdd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"y$", "[", 
                  RowBox[{"[", "i$", "]"}], "]"}], ",", "z$", ",", "j$"}], 
                "]"}], "]"}], 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"y$", ",", "j$", ",", "i$"}], "]"}]}], "]"}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"GUdd", "[", 
                RowBox[{"[", 
                 RowBox[{"j$", ",", "z$", ",", 
                  RowBox[{"y$", "[", 
                   RowBox[{"[", "i$", "]"}], "]"}]}], "]"}], "]"}]}], 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"y$", ",", "j$", ",", "i$"}], "]"}]}], "]"}], 
               "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j$", ",", "Dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i$", ",", "rnk1"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"DEF$covDiv", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"covDiv", "[", 
        RowBox[{"x_", ",", "UpList_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"covDiv", "[", 
         RowBox[{"x", ",", "UpList"}], "]"}], "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"k", "=", 
             RowBox[{"TensRnk", "[", "x", "]"}]}], ",", "divInd", ",", "j$", 
            ",", "z$", ",", 
            RowBox[{"FlUpL", "=", 
             RowBox[{"Flatten", "[", "UpList", "]"}]}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "FlUpL", "]"}], ">", "k"}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Sort", "[", "FlUpL", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], ">", "k"}], "||", 
              RowBox[{
               RowBox[{"Head", "[", "x", "]"}], "=!=", "List"}]}], ",", 
             RowBox[{
              RowBox[{"er$Wrn", "[", "2", "]"}], ";", 
              RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "UpList", "]"}], ">", "1"}], ",", 
             RowBox[{"divInd", "=", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{"UpList", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "List"}], "&"}]}],
                  "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"divInd", "=", 
              RowBox[{"FlUpL", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "===", "1"}], ",", 
             RowBox[{"FaSi", "[", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"p$D", "[", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "z$", "]"}], "]"}], ",", "z$"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z$", ",", "Dim"}], "}"}]}], "]"}], "+", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"GUdd", "[", 
                   RowBox[{"[", 
                    RowBox[{"z$", ",", "z$", ",", "j$"}], "]"}], "]"}], 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "j$", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j$", ",", "Dim"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z$", ",", "Dim"}], "}"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{"cDIVcomp", "[", 
                RowBox[{"x", ",", "k", ",", "divInd", ",", "FlUpL"}], "]"}], 
               ",", 
               RowBox[{"Table", "[", 
                RowBox[{"Dim", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", "-", "1"}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}]}]}], "]"}]}]}], ";"}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"cDIVcomp", "[", 
       RowBox[{"x_", ",", "rnk1_", ",", "divInd_", ",", 
        RowBox[{"UpList_", ":", 
         RowBox[{"{", "}"}]}]}], "]"}], "[", "y__", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z$", ",", "y$", ",", "i$", ",", "j$"}], "}"}], ",", 
       RowBox[{
        RowBox[{"y$", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", "z$", ",", "divInd"}], "]"}]}], ";", 
        RowBox[{"FaSi", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"p$D", "[", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", "y$"}], "]"}], "]"}], ",", "z$"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z$", ",", "Dim"}], "}"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"UpList", ",", "i$"}], "]"}], ",", 
              RowBox[{
               RowBox[{"GUdd", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y$", "[", 
                   RowBox[{"[", "i$", "]"}], "]"}], ",", "z$", ",", "j$"}], 
                 "]"}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{"y$", ",", "j$", ",", "i$"}], "]"}]}], "]"}], 
                "]"}]}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"GUdd", "[", 
                 RowBox[{"[", 
                  RowBox[{"j$", ",", "z$", ",", 
                   RowBox[{"y$", "[", 
                    RowBox[{"[", "i$", "]"}], "]"}]}], "]"}], "]"}]}], 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{"y$", ",", "j$", ",", "i$"}], "]"}]}], "]"}], 
                "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j$", ",", "Dim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i$", ",", "rnk1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z$", ",", "Dim"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"DEF$LieD", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"LieD", "[", 
        RowBox[{"x_List", ",", "y_List", ",", "z_List"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"LieD", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], "=", 
        RowBox[{"LieDerv", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"LieD", "[", 
        RowBox[{"x_List", ",", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"LieD", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "=", 
        RowBox[{"LieDerv", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], ";"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LieDerv", "[", 
      RowBox[{"h_List", ",", "x_", ",", 
       RowBox[{"UpList_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "=", 
          RowBox[{"TensRnk", "[", "x", "]"}]}], ",", "hjdU", ",", "hUjd", ",",
          "i$", ",", 
         RowBox[{"ASgam", "=", 
          RowBox[{"GUdd", "-", 
           RowBox[{"Transpose", "[", 
            RowBox[{"GUdd", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}]}]}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Dimensions", "[", "h", "]"}], "]"}], "=!=", "1"}], ",", 
          RowBox[{
           RowBox[{
           "stPrint", "[", "\"\<First argument not a vector!\>\"", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "UpList", "]"}], ">", "0"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], ">", "k"}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Flatten", "[", "UpList", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ">", "k"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"er$Wrn", "[", "2", "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"hjdU", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"p$D", "[", 
             RowBox[{"h", ",", "#1"}], "]"}], "&"}], ",", 
           RowBox[{"{", "Dim", "}"}]}], "]"}]}], ";", 
        RowBox[{"hUjd", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "hjdU", "]"}], "+", 
          RowBox[{"ASgam", ".", "h"}]}]}], ";", 
        RowBox[{"hjdU", "=", 
         RowBox[{"Transpose", "[", "hUjd", "]"}]}], ";", 
        RowBox[{"FaSi", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FormDegree", "[", "x", "]"}], ">", "0"}], ",", 
            RowBox[{"LieDcartan", "[", 
             RowBox[{"h", ",", "x", ",", "coordList"}], "]"}], ",", 
            RowBox[{"h", ".", 
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"p$D", "[", 
                 RowBox[{"x", ",", "#1"}], "]"}], "&"}], ",", 
               RowBox[{"{", "Dim", "}"}]}], "]"}]}]}], "]"}], "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "x", "]"}], "===", "List"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"i$", "===", "1"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"UpList", ",", "i$"}], "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"hUjd", ".", "x"}]}], ",", 
                  RowBox[{"hjdU", ".", "x"}]}], "]"}], ",", 
                RowBox[{"i$", "===", "k"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"UpList", ",", "i$"}], "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"x", ".", "hjdU"}]}], ",", 
                  RowBox[{"x", ".", "hUjd"}]}], "]"}], ",", "True", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"Inner", "[", 
                   RowBox[{"Times", ",", "x", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"UpList", ",", "i$"}], "]"}], ",", 
                    RowBox[{"-", "hjdU"}], ",", "hUjd"}], "]"}], ",", "Plus", 
                    ",", "i$"}], "]"}], ",", 
                  RowBox[{"OrdN", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"i$", "-", "1"}], "]"}], ",", 
                    RowBox[{"RotateRight", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"i$", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i$", ",", "k"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"OrdN", "[", "x_List", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"x", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Sort", "[", "x", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Laplacian", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Xx", "^", "2"}], "+", 
       RowBox[{"Yy", "^", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Xx", ",", "Yy"}], "}"}]}], "]"}], ";", 
    RowBox[{"Unprotect", "[", "Laplacian", "]"}], ";", 
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"UpList_", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"covDiv", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"covD", "[", 
          RowBox[{"x", ",", "UpList"}], "]"}], ".", "gUU"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{"UpList", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"TensRnk", "[", "x", "]"}], "+", "1"}], "}"}], "}"}]}], 
         "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"UpList", "===", 
        RowBox[{"{", "}"}]}], "||", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Head", "/@", 
          RowBox[{"Flatten", "[", "UpList", "]"}]}], "]"}], "===", 
        RowBox[{"{", "Integer", "}"}]}]}]}]}], ";", 
    RowBox[{"s1$", "=", 
     RowBox[{"DownValues", "[", "Laplacian", "]"}]}], ";", 
    RowBox[{"s2$", "=", 
     RowBox[{"Position", "[", 
      RowBox[{"s1$", ",", "UpList"}], "]"}]}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"s2$", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=!=", "1"}], ",", 
      RowBox[{
       RowBox[{"DownValues", "[", "Laplacian", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s1$", "[", 
           RowBox[{"[", 
            RowBox[{"s2$", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "}"}], ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"s1$", ",", 
           RowBox[{"{", 
            RowBox[{"s2$", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
        "]"}]}]}], "]"}], ";", 
    RowBox[{"Clear", "[", 
     RowBox[{"s1$", ",", "s2$"}], "]"}], ";", 
    RowBox[{"Off", "[", 
     RowBox[{"Laplacian", "::", "argtu"}], "]"}], ";", 
    RowBox[{"Protect", "[", "Laplacian", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Grad2Norm", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"y_", ":", "Null"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FaSi", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", "===", "Null"}], ",", 
         RowBox[{"gUU", ".", 
          RowBox[{"covD", "[", "x", "]"}], ".", 
          RowBox[{"covD", "[", "x", "]"}]}], ",", 
         RowBox[{"gUU", ".", 
          RowBox[{"covD", "[", "x", "]"}], ".", 
          RowBox[{"covD", "[", "y", "]"}]}]}], "]"}], "]"}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "x", "]"}], "=!=", "List"}], "&&", 
       RowBox[{
        RowBox[{"Head", "[", "y", "]"}], "=!=", "List"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Bianchi", "[", "0", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp$", "=", 
         RowBox[{"covD", "[", "Rdddd", "]"}]}], "}"}], ",", 
       RowBox[{"indep$cTerms", "[", 
        RowBox[{"FaSi", "[", 
         RowBox[{"indep$cTerms", "[", 
          RowBox[{"tmp$", "+", 
           RowBox[{"Transpose", "[", 
            RowBox[{"tmp$", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "3"}], "}"}]}], 
            "]"}], "+", 
           RowBox[{"Transpose", "[", 
            RowBox[{"tmp$", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "5", ",", "3", ",", "4"}], "}"}]}], 
            "]"}]}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Bianchi", "[", "1", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp$", "=", 
         RowBox[{"covD", "[", "Rdd", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RUddd", "]"}], "===", "Symbol"}], ",", 
          RowBox[{"RUddd", "=", 
           RowBox[{"Raise", "[", 
            RowBox[{"Rdddd", ",", "1"}], "]"}]}]}], "]"}], ";", 
        RowBox[{"indep$cTerms", "[", 
         RowBox[{"FaSi", "[", 
          RowBox[{"indep$cTerms", "[", 
           RowBox[{
            RowBox[{"covDiv", "[", 
             RowBox[{"RUddd", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "+", "tmp$", "-", 
            RowBox[{"Transpose", "[", 
             RowBox[{"tmp$", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], "]"}], 
          "]"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Bianchi", "[", "2", "]"}], ":=", 
     RowBox[{"indep$cTerms", "[", 
      RowBox[{"covDiv", "[", 
       RowBox[{"EUd", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Clear$dx", ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "coordList", "]"}], "===", "Symbol"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<OK\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"Head", "/@", 
           RowBox[{"d", "/@", "coordList"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "Symbol"}], "}"}]}], "]"}], "===", 
        RowBox[{"{", 
         RowBox[{"d", ",", "Symbol"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dxRuleList", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Clear", "[", 
            RowBox[{"dxRuleList", ",", "deList"}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "varList", "]"}], ">", "0"}], ",", 
             RowBox[{"stPrint", "[", "\"\<varList cleared\>\"", "]"}]}], 
            "]"}], ";", 
           RowBox[{
           "stPrint", "[", "\"\<deList and dxRuleList also cleared\>\"", 
            "]"}]}], ",", 
          RowBox[{"Print", "[", "\"\<OK\>\"", "]"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}], ",", "True", ",", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"var$", ",", "z$", ",", 
            RowBox[{"i$", "=", "1"}]}], "}"}], ",", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i$", "\[LessEqual]", "Dim"}], ",", 
            RowBox[{
             RowBox[{"var$", "=", 
              RowBox[{"coordList", "[", 
               RowBox[{"[", "i$", "]"}], "]"}]}], ";", 
             RowBox[{"z$", "=", 
              RowBox[{"\"\<d\>\"", "<>", 
               RowBox[{"ToString", "[", "var$", "]"}]}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"d", "[", "var$", "]"}], "]"}], "=!=", "d"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d", "[", "var$", "]"}], ")"}], "=."}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"FormDegree", "[", 
                 RowBox[{"ToExpression", "[", "z$", "]"}], "]"}], "===", 
                "1"}], ",", 
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"z$", "<>", "\"\<=.\>\""}], "]"}], ";", 
                RowBox[{
                 RowBox[{"d", "[", "var$", "]"}], "=", 
                 RowBox[{"ToExpression", "[", "z$", "]"}]}]}]}], "]"}], ";", 
             RowBox[{"i$", "=", 
              RowBox[{"i$", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "varList", "]"}], "===", "0"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", "dxRuleList", "]"}], "===", "Symbol"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", "deList", "]"}], "===", "Symbol"}]}], ",", 
          RowBox[{"Print", "[", "\"\<OK\>\"", "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "varList", "]"}], ">", "0"}], ",", 
          RowBox[{"stPrint", "[", "\"\<varList cleared\>\"", "]"}]}], "]"}], 
        ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "dxRuleList", "]"}], "===", "List"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", "deList", "]"}], "===", "List"}]}], ",", 
          RowBox[{
          "stPrint", "[", "\"\<deList and dxRuleList also cleared\>\"", 
           "]"}]}], "]"}], ";", 
        RowBox[{"Clear", "[", 
         RowBox[{"eTO$dx", ",", "dxRuleList", ",", "deList"}], "]"}], ";", 
        RowBox[{"varList", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Head", "/@", 
             RowBox[{"d", "/@", 
              RowBox[{"e", "/@", 
               RowBox[{"Range", "[", "Dim", "]"}]}]}]}], "]"}], "=!=", 
           RowBox[{"{", "d", "}"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d", "[", 
             RowBox[{"e", "[", "a_", "]"}], "]"}], ")"}], "=."}]}], "]"}]}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"metric", "[", 
      RowBox[{"LinEl_", ",", "x_List"}], "]"}], ":=", 
     RowBox[{"FacSimp", "[", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"indepTerms", "[", 
            RowBox[{
             RowBox[{"d", "[", "x", "]"}], "/.", 
             RowBox[{
              RowBox[{"e", "[", "_", "]"}], "\[Rule]", "0"}]}], "]"}], "]"}], 
          "===", 
          RowBox[{"Length", "[", "x", "]"}]}]}], ",", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"LinEl", "/", "2"}], ",", 
             RowBox[{"d", "[", 
              RowBox[{"x", "[", 
               RowBox[{"[", "#1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"d", "[", 
              RowBox[{"x", "[", 
               RowBox[{"[", "#2", "]"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"x", "===", 
          RowBox[{"e", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "x", "]"}], "]"}]}]}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"indepTerms", "[", 
             RowBox[{"d", "[", "x", "]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"indepTerms", "[", 
              RowBox[{"x", "/.", 
               RowBox[{
                RowBox[{"e", "[", "_", "]"}], "\[Rule]", "0"}]}], "]"}], 
             "]"}], "===", 
            RowBox[{"Length", "[", "x", "]"}]}]}], ")"}]}], ",", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"LinEl", "/", "2"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", "#1", "]"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"indepTerms", "[", 
            RowBox[{
             RowBox[{"d", "[", "x", "]"}], "/.", 
             RowBox[{
              RowBox[{"e", "[", "_", "]"}], "\[Rule]", "0"}]}], "]"}], "]"}], 
          "<", 
          RowBox[{"Length", "[", "x", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
         "stPrint", "[", 
          "\"\<The metric components are given with respect to the coframe \
{e[1],...,e[n}}\>\"", "]"}], ";", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"LinEl", "/", "2"}], ",", 
              RowBox[{"e", "[", "#1", "]"}], ",", 
              RowBox[{"e", "[", "#2", "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "x", "]"}], ",", 
             RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ",", 
        "True", ",", 
        RowBox[{
        "stPrint", "[", 
         "\"\<The second argument must be either the list of coordinates, or \
the coframe list {e[1],...,e[n}}\>\"", "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dot$2", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"multiDot", "[", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"tr$2", "[", "x_", "]"}], ":=", 
     RowBox[{"Contract", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Plebanski", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R2d4", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", "x", ",", "y"}], "]"}], "+", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", "y", ",", "x"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"Rg", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"tr", "[", 
                 RowBox[{"y", ".", "gUU"}], "]"}], "x"}], "+", 
               RowBox[{
                RowBox[{"tr", "[", 
                 RowBox[{"x", ".", "gUU"}], "]"}], "y"}]}], ",", "gdd"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"gg", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "gdd", ",", "gdd"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"Rsq", "=", 
          RowBox[{"FaSi", "[", 
           RowBox[{
            RowBox[{"x", ".", "gUU", ".", "y"}], "+", 
            RowBox[{"y", ".", "gUU", ".", "x"}]}], "]"}]}], ",", "trRsq", ",",
          "R2g", ",", "Rscal"}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{"x", "-", 
               RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "]"}]}], "||", 
           RowBox[{"!", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{"y", "-", 
               RowBox[{"Transpose", "[", "y", "]"}]}], "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"stPrint", "[", "\"\<Not a symmetric tensor!\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"R2d4", "=", 
         RowBox[{"R2d4", "-", 
          RowBox[{"Transpose", "[", "R2d4", "]"}]}]}], ";", 
        RowBox[{"Rg", "=", 
         RowBox[{"Rg", "-", 
          RowBox[{"Transpose", "[", "Rg", "]"}]}]}], ";", 
        RowBox[{"Rg", "=", 
         RowBox[{"Rg", "-", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Rg", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", 
        RowBox[{"gg", "=", 
         RowBox[{"gg", "-", 
          RowBox[{"Transpose", "[", "gg", "]"}]}]}], ";", 
        RowBox[{"trRsq", "=", 
         RowBox[{"Contract", "[", 
          RowBox[{
           RowBox[{"Rsq", ".", "gUU"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"R2g", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "Rsq", ",", "gdd"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"R2g", "=", 
         RowBox[{"R2g", "-", 
          RowBox[{"Transpose", "[", "R2g", "]"}]}]}], ";", 
        RowBox[{"R2g", "=", 
         RowBox[{"R2g", "-", 
          RowBox[{"Transpose", "[", 
           RowBox[{"R2g", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", 
        RowBox[{"Rscal", "=", 
         RowBox[{"Contract", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"gUU", ".", "Rg", ".", "gUU"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"Dim", "-", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"FaSi", "[", 
         RowBox[{"R2d4", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rg", "-", "R2g"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"Dim", "-", "2"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Rscal", "-", "trRsq"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Dim", "-", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"Dim", "-", "2"}], ")"}]}], ")"}]}], " ", "gg"}]}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Plebanski", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R2d4", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "x", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"Rg", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "x", ",", "gdd"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"gg", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "gdd", ",", "gdd"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
         ",", 
         RowBox[{"Rsq", "=", 
          RowBox[{"FaSi", "[", 
           RowBox[{"x", ".", "gUU", ".", "x"}], "]"}]}], ",", "trRsq", ",", 
         "R2g", ",", 
         RowBox[{"Rscal", "=", 
          RowBox[{"Contract", "[", 
           RowBox[{
            RowBox[{"x", ".", "gUU"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"zeroQ", "[", 
            RowBox[{"FaSi", "[", 
             RowBox[{"x", "-", 
              RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"stPrint", "[", "\"\<Not a symmetric tensor!\>\"", "]"}], 
           ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        RowBox[{"R2d4", "=", 
         RowBox[{"R2d4", "-", 
          RowBox[{"Transpose", "[", "R2d4", "]"}]}]}], ";", 
        RowBox[{"Rg", "=", 
         RowBox[{"Rg", "-", 
          RowBox[{"Transpose", "[", "Rg", "]"}]}]}], ";", 
        RowBox[{"Rg", "=", 
         RowBox[{"Rg", "-", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Rg", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", 
        RowBox[{"gg", "=", 
         RowBox[{"gg", "-", 
          RowBox[{"Transpose", "[", "gg", "]"}]}]}], ";", 
        RowBox[{"trRsq", "=", 
         RowBox[{"Contract", "[", 
          RowBox[{
           RowBox[{"Rsq", ".", "gUU"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"R2g", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "Rsq", ",", "gdd"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"R2g", "=", 
         RowBox[{"R2g", "-", 
          RowBox[{"Transpose", "[", "R2g", "]"}]}]}], ";", 
        RowBox[{"R2g", "=", 
         RowBox[{"R2g", "-", 
          RowBox[{"Transpose", "[", 
           RowBox[{"R2g", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", 
        RowBox[{"FaSi", "[", 
         RowBox[{"R2d4", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Rscal", " ", "Rg"}], "-", "R2g"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"Dim", "-", "2"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Rscal", "^", "2"}], "-", "trRsq"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Dim", "-", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"Dim", "-", "2"}], ")"}]}], ")"}]}], " ", "gg"}]}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Classify", "[", "x_", "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Dimensions", "[", "x", "]"}], "]"}], "]"}], "=!=", 
        RowBox[{"{", "4", "}"}]}], ",", 
       RowBox[{
        RowBox[{
        "stPrint", "[", 
         "\"\<Classification defined for 4-d tensors only!\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "x", "]"}], "=!=", "List"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "x", "]"}], "=!=", 
          RowBox[{"{", 
           RowBox[{"4", ",", "4"}], "}"}]}], "&&", 
         RowBox[{
          RowBox[{"Dimensions", "[", "x", "]"}], "=!=", 
          RowBox[{"{", 
           RowBox[{"4", ",", "4", ",", "4", ",", "4"}], "}"}]}]}]}], ",", 
       RowBox[{
        RowBox[{
        "stPrint", "[", "\"\<Undefined or incorrect-rank tensor!\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "x", "]"}], "===", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4", ",", "4", ",", "4"}], "}"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"x", "+", 
             RowBox[{"Transpose", "[", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "]"}]}],
             "]"}], "]"}], "&&", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"x", "+", 
             RowBox[{"Transpose", "[", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], "]"}]}],
             "]"}], "]"}], "&&", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"x", "-", 
             RowBox[{"Transpose", "[", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4", ",", "1", ",", "2"}], "}"}]}], "]"}]}],
             "]"}], "]"}], "&&", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"Contract", "[", 
            RowBox[{
             RowBox[{"x", ".", "gUU"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"ClassifyWeyl", "[", "x", "]"}], ",", 
         RowBox[{
          RowBox[{"stPrint", "[", "\"\<Not a Weyl-type tensor!\>\"", "]"}], 
          ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "x", "]"}], "===", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroQ", "[", 
          RowBox[{"FaSi", "[", 
           RowBox[{"x", "-", 
            RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"tmp$", "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"Plus", "@@", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", ".", "gUU"}], "/", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", "tmp$", "]"}], ",", 
            RowBox[{"ClassifyRic09", "[", "x", "]"}], ",", 
            RowBox[{"ClassifyRic10", "[", 
             RowBox[{"x", ",", "tmp$"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"stPrint", "[", "\"\<Not a symmetric tensor!\>\"", "]"}], 
          ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"indx$Ruls", "[", "1", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "1"}], ",", 
         RowBox[{"#2", "\[Rule]", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "1"}], ",", 
         RowBox[{"#2", "\[Rule]", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "1"}], ",", 
         RowBox[{"#2", "\[Rule]", "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "2"}], ",", 
         RowBox[{"#2", "\[Rule]", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "2"}], ",", 
         RowBox[{"#2", "\[Rule]", "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "3"}], ",", 
         RowBox[{"#2", "\[Rule]", "4"}]}], "}"}]}], "}"}]}], ";", 
    RowBox[{
     RowBox[{"indx$Ruls", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"indx$Ruls", "[", "1", "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "\[Rule]", "#3"}], ",", 
        RowBox[{"#2", "\[Rule]", "#4"}]}], "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"indx$Ruls", "[", "12", "]"}], "=", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"indx$Ruls", "[", "1", "]"}], "[", 
           RowBox[{"[", "#1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"indx$Ruls", "[", "2", "]"}], "[", 
           RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassifyWeyl", "[", "x_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zeroQ", "[", "x", "]"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Type O\>\"", "]"}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "0", "}"}], "]"}]}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"gg", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "gdd", ",", "gdd"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}], 
           ",", "j$", ",", "ID$4"}], "}"}], ",", 
         RowBox[{
          RowBox[{"ID$4", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Raise", "[", 
               RowBox[{
                RowBox[{"gg", "-", 
                 RowBox[{"Transpose", "[", "gg", "]"}]}], ",", "3", ",", 
                "4"}], "]"}], "-", 
              RowBox[{"j$", " ", 
               RowBox[{"eta", "[", 
                RowBox[{"3", ",", "4"}], "]"}]}]}], ")"}], "/", "4"}]}], ";", 
          RowBox[{"gg", "=", 
           RowBox[{"indep$cTerms", "[", 
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"PowerExpand", "[", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"dot$2", "[", 
                   RowBox[{"ID$4", ",", "ID$4"}], "]"}], "-", "ID$4"}], "]"}],
                 "]"}], "]"}], ",", "j$", ",", "FaSi"}], "]"}], "]"}]}], ";", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{"gg", "/.", 
               RowBox[{"j$", "\[Rule]", "I"}]}], "]"}], "]"}], ",", 
            RowBox[{"j$", "=", "I"}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{"gg", "/.", 
               RowBox[{"j$", "\[Rule]", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"j$", "=", "1"}], ",", "True", ",", 
            RowBox[{
             RowBox[{
             "stPrint", "[", 
              "\"\<Cannot perform classification; try different coordinates \
or frame!\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
          RowBox[{"Off", "[", 
           RowBox[{"General", "::", "pspec"}], "]"}], ";", 
          RowBox[{"ID$4", "=", 
           RowBox[{
            RowBox[{"ID$4", "[", 
             RowBox[{"[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}], "]"}], "/.", 
            RowBox[{"indx$Ruls", "[", "12", "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"CW$", "[", "1", "]"}], "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"-", 
             RowBox[{"ID$4", ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Raise", "[", 
                  RowBox[{"x", ",", "3", ",", "4"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}], 
                 "]"}], "/.", 
                RowBox[{"indx$Ruls", "[", "12", "]"}]}], ")"}]}]}], "]"}]}], 
          ";", 
          RowBox[{"On", "[", 
           RowBox[{"General", "::", "pspec"}], "]"}], ";", 
          RowBox[{
           RowBox[{"CW$", "[", "2", "]"}], "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"2", 
             RowBox[{
              RowBox[{"CW$", "[", "1", "]"}], ".", 
              RowBox[{"CW$", "[", "1", "]"}]}]}], "]"}]}], ";", 
          RowBox[{"Is$2", "=", 
           RowBox[{"tr", "[", 
            RowBox[{"CW$", "[", "2", "]"}], "]"}]}], ";", 
          RowBox[{"Js$3", "=", 
           RowBox[{"FaSi", "[", 
            RowBox[{"Plus", "@@", 
             RowBox[{"FaSi", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "/", "3"}], 
                 RowBox[{
                  RowBox[{"CW$", "[", "1", "]"}], ".", 
                  RowBox[{"CW$", "[", "2", "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
          ";", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", 
             RowBox[{"CW$", "[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Type O\>\"", "]"}], ";", 
             RowBox[{"Return", "[", 
              RowBox[{"{", "0", "}"}], "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"CW$", "[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Type N\>\"", "]"}], ";", 
             RowBox[{"Return", "[", 
              RowBox[{"{", "4", "}"}], "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"{", 
              RowBox[{"Is$2", ",", "Js$3"}], "}"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Type III\>\"", "]"}], ";", 
             RowBox[{"Return", "[", 
              RowBox[{"{", "31", "}"}], "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{
               RowBox[{"Is$2", "^", "3"}], "-", 
               RowBox[{"27", 
                RowBox[{"Js$3", "^", "2"}]}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"CW$", "[", "20", "]"}], "=", 
              RowBox[{"FaSi", "[", 
               RowBox[{
                RowBox[{"CW$", "[", "2", "]"}], "-", 
                RowBox[{
                 RowBox[{"2", "/", "3"}], " ", "Is$2", " ", "ID$4"}]}], 
               "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{
                  RowBox[{"Is$2", "*", 
                   RowBox[{"CW$", "[", "20", "]"}]}], "-", 
                  RowBox[{"3", " ", "Js$3", "*", 
                   RowBox[{"CW$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Type D\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "22", "}"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Type II\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "211", "}"}], "]"}]}]}], "]"}]}], ",", "True", 
            ",", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"zeroQ", "[", "Is$2", "]"}], ",", 
               RowBox[{"Print", "[", "\"\<Type I, invariant I = 0\>\"", "]"}],
                ",", 
               RowBox[{"zeroQ", "[", "Js$3", "]"}], ",", 
               RowBox[{"Print", "[", "\"\<Type I, invariant J = 0\>\"", "]"}],
                ",", "True", ",", 
               RowBox[{"Print", "[", "\"\<Type I - G\>\"", "]"}]}], "]"}], 
             ";", 
             RowBox[{"Return", "[", 
              RowBox[{"{", "1111", "}"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"testSolve", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$ol", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"x", "\[Equal]", "0"}], ",", "y"}], "]"}], "]"}]}], "}"}],
        ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$ol", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"x", "/.", "$ol"}], "]"}], "]"}], ",", "True", ",", 
          "False"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassifyRic09", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ID$4", "=", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ",", "trR", ",", 
         "al$p", ",", "tmp$", ",", "b4$", ",", "c6$"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"SM$", "[", "1", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{"x", ".", "gUU"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"SM$", "[", "2", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "1", "]"}], ".", 
           RowBox[{"SM$", "[", "1", "]"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"SM$", "[", "3", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "2", "]"}], ".", 
           RowBox[{"SM$", "[", "1", "]"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "2", "]"}], "=", 
         RowBox[{"tr", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "2", "]"}], "/", "2"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "3", "]"}], "=", 
         RowBox[{"tr", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "3", "]"}], "/", "2"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "4", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{"Plus", "@@", 
           RowBox[{"FaSi", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", 
               RowBox[{
                RowBox[{"SM$", "[", "2", "]"}], ".", 
                RowBox[{"SM$", "[", "2", "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Print", "[", "\"\<Traceless\>\"", "]"}], ";", 
        RowBox[{"al$p", "=", 
         RowBox[{"zeroQ", "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FaSi", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"trR", "[", "2", "]"}], "^", "2"}], "-", 
              RowBox[{"trR", "[", "4", "]"}]}], "]"}], ",", 
            RowBox[{"trR", "[", "3", "]"}], ",", 
            RowBox[{"trR", "[", "2", "]"}]}], "}"}]}]}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
          RowBox[{"tmp$", "=", "\"\<Quadruple 0\>\""}], ",", 
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], ",", 
          RowBox[{"tmp$", "=", "\"\<Double 0\>\""}], ",", 
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
          RowBox[{"tmp$", "=", "\"\<Single 0\>\""}], ",", "True", ",", 
          RowBox[{"tmp$", "=", "\"\<\>\""}]}], "]"}], ";", 
        RowBox[{"Clear", "[", "al$p", "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", "tmp$", "]"}], ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"tmp$", "<>", "\"\< eigenvalue\>\""}], "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "IV"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"trR", "/@", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", 
             RowBox[{"SM$", "[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(111,1)] (Vacuum)\>\"", "]"}], 
             ";", 
             RowBox[{"Return", "[", "\"\<IV-M1(0)\>\"", "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"SM$", "[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Segre [(11,2)] (Null EM field)\>\"", "]"}], 
             ";", 
             RowBox[{"Return", "[", "\"\<IV-M2(00)\>\"", "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"SM$", "[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(1,3)]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IV-M3(000)\>\"", "]"}]}], ",", 
            "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(4)]??\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IV-G(0000)\>\"", "]"}]}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "IID"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"trR", "[", "3", "]"}], ",", 
             RowBox[{"FaSi", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"trR", "[", "4", "]"}]}]}], "]"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "2", "]"}], "-", 
                 RowBox[{
                  RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Segre [(11)(1,1)] (Non-Null EM field)\>\"", 
              "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IID-M2(01)\>\"", "]"}]}], ",", 
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "3", "]"}], "-", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"SM$", "[", "2", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "3"}], "ID$4"}]}], 
                "]"}], "]"}], ",", 
              RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(11),2]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IID-M3(111)\>\"", "]"}]}], ",", 
            "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [2,2]??\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IID-G(0101)\>\"", "]"}]}]}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b4$", "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "7"}], 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
           RowBox[{"6", 
            RowBox[{"trR", "[", "4", "]"}]}]}], "]"}]}], ";", 
        RowBox[{"c6$", "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], "^", "3"}]}], "+", 
           RowBox[{"3", 
            RowBox[{
             RowBox[{"trR", "[", "3", "]"}], "^", "2"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "III"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"{", 
            RowBox[{"b4$", ",", "c6$"}], "}"}], "]"}], ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "2", "]"}], "+", 
                 RowBox[{"2", 
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "-", 
                 RowBox[{"3", 
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], "ID$4"}]}], 
                "]"}], "]"}], ",", 
              RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Segre [(111),1] or [1(11,1)] (radiation-type perfect \
fluid)\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<III-M2(11)\>\"", "]"}]}], ",", 
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "3", "]"}], "+", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"SM$", "[", "2", "]"}]}], "-", 
                 RowBox[{"5", 
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                 RowBox[{"3", 
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "3"}], "ID$4"}]}], 
                "]"}], "]"}], ",", 
              RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [1(1,2)]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<III-M3(111)\>\"", "]"}]}], ",", 
            "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [1,3]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<III-G(0111)\>\"", "]"}]}]}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "II"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{
             RowBox[{"b4$", "^", "3"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "c6$"}], "-", 
                RowBox[{"3", 
                 RowBox[{"trR", "[", "2", "]"}], "b4$"}]}], ")"}], "^", 
              "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "3", "]"}], "+", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], " ", 
                  RowBox[{"SM$", "[", "2", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"al$p", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "^", "2"}]}], ")"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"al$p", "[", "2", "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}]}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], "ID$4"}]}], 
                "]"}], "]"}], ",", 
              RowBox[{"al$p", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Segre [11(1,1)] or [(11)1,1] or \
[(11),Z\\!\\(\\*OverscriptBox[\\\"Z\\\", \\\"_\\\"]\\)]\>\"", "]"}], ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(010)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(110)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<II-M3(111)\>\"", "]"}]}], "]"}]}], 
            ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [11,2]\>\"", "]"}], ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"zeroQ", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"trR", "[", "3", "]"}], ",", 
                  RowBox[{"FaSi", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"trR", "[", "4", "]"}]}], "]"}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"Return", "[", "\"\<II-G(0100)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"trR", "[", "2", "]"}], ",", 
                  RowBox[{"trR", "[", "4", "]"}]}], "}"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(0010)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"trR", "[", "2", "]"}], ",", 
                  RowBox[{"trR", "[", "3", "]"}]}], "}"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(0001)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"trR", "[", "2", "]"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(0011)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"trR", "[", "3", "]"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(0101)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
                  RowBox[{"trR", "[", "4", "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(0110)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<II-G(0111)\>\"", "]"}]}], 
              "]"}]}]}], "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "I"}], "**)"}], 
        RowBox[{
        "Print", "[", 
         "\"\<Segre [111,1] or [11,Z\\!\\(\\*OverscriptBox[\\\"Z\\\", \\\"_\\\
\"]\\)]\>\"", "]"}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], ",", 
             RowBox[{"trR", "[", "3", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(0001)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], ",", 
             RowBox[{"trR", "[", "4", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(0010)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"trR", "[", "2", "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(0011)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"trR", "[", "3", "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(0101)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
             RowBox[{"trR", "[", "4", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(0110)\>\"", "]"}], ",", "True", ",", 
          RowBox[{"Return", "[", "\"\<I-G(0111)\>\"", "]"}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassifyRic10", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ID$4", "=", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ",", "trR", ",", 
         "al$p", ",", "tmp$", ",", "b4$", ",", "c6$"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"SM$", "[", "1", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{"x", ".", "gUU"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"SM$", "[", "2", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "1", "]"}], ".", 
           RowBox[{"SM$", "[", "1", "]"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"SM$", "[", "3", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "2", "]"}], ".", 
           RowBox[{"SM$", "[", "1", "]"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "1", "]"}], "=", "y"}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "2", "]"}], "=", 
         RowBox[{"tr", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "2", "]"}], "/", "2"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "3", "]"}], "=", 
         RowBox[{"tr", "[", 
          RowBox[{
           RowBox[{"SM$", "[", "3", "]"}], "/", "2"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"trR", "[", "4", "]"}], "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{"Plus", "@@", 
           RowBox[{"FaSi", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", 
               RowBox[{
                RowBox[{"SM$", "[", "2", "]"}], ".", 
                RowBox[{"SM$", "[", "2", "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"al$p", "=", 
         RowBox[{"zeroQ", "/@", 
          RowBox[{"FaSi", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"4", 
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "-", 
              RowBox[{"12", 
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
               RowBox[{"trR", "[", "2", "]"}]}], "+", 
              RowBox[{"3", 
               RowBox[{
                RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
              RowBox[{"8", 
               RowBox[{"trR", "[", "1", "]"}], 
               RowBox[{"trR", "[", "3", "]"}]}], "-", 
              RowBox[{"3", 
               RowBox[{"trR", "[", "4", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "-", 
              RowBox[{"3", 
               RowBox[{"trR", "[", "1", "]"}], 
               RowBox[{"trR", "[", "2", "]"}]}], "+", 
              RowBox[{"trR", "[", "3", "]"}]}], ",", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "-", 
              RowBox[{"trR", "[", "2", "]"}]}], ",", 
             RowBox[{"trR", "[", "1", "]"}]}], "}"}], "]"}]}]}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
          ",", 
          RowBox[{"tmp$", "=", "\"\<Quadruple 0\>\""}], ",", 
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}]}],
           ",", 
          RowBox[{"tmp$", "=", "\"\<Triple 0\>\""}], ",", 
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
            "}"}]}], ",", 
          RowBox[{"tmp$", "=", "\"\<Double 0\>\""}], ",", 
          RowBox[{"al$p", "===", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False", ",", "False", ",", "False"}], 
            "}"}]}], ",", 
          RowBox[{"tmp$", "=", "\"\<Single 0\>\""}], ",", "True", ",", 
          RowBox[{"tmp$", "=", "\"\<\>\""}]}], "]"}], ";", 
        RowBox[{"Clear", "[", "al$p", "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", "tmp$", "]"}], ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"tmp$", "<>", "\"\< eigenvalue\>\""}], "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "IV"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"trR", "[", "2", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "+", 
               RowBox[{"4", 
                RowBox[{"trR", "[", "3", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "+", 
               RowBox[{"8", 
                RowBox[{"trR", "[", "4", "]"}]}]}]}], "}"}], "]"}], "]"}], 
          ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{
               RowBox[{"SM$", "[", "1", "]"}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "/", "2"}], " ", "ID$4"}]}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Segre [(111,1)] (Lamda Term)\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IV-M1(1)\>\"", "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{
               RowBox[{"SM$", "[", "2", "]"}], "-", 
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], " ", 
                RowBox[{"SM$", "[", "1", "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"trR", "[", "1", "]"}], "^", "2"}], "/", "4"}], " ",
                 "ID$4"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(11,2)]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IV-M2(11)\>\"", "]"}]}], ",", 
            RowBox[{"zeroQ", "[", 
             RowBox[{"FaSi", "[", 
              RowBox[{
               RowBox[{"SM$", "[", "3", "]"}], "-", 
               RowBox[{
                RowBox[{"3", "/", "2"}], 
                RowBox[{"trR", "[", "1", "]"}], 
                RowBox[{"SM$", "[", "2", "]"}]}], "+", 
               RowBox[{
                RowBox[{"3", "/", "4"}], 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
                RowBox[{"SM$", "[", "1", "]"}]}], "-", 
               RowBox[{
                RowBox[{"1", "/", "8"}], 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "3"}], "ID$4"}]}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(1,3)]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IV-M3(111)\>\"", "]"}]}], ",", 
            "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(4)]??\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IV-G(1111)\>\"", "]"}]}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "IID"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], "^", "3"}], "-", 
               RowBox[{"3", 
                RowBox[{"trR", "[", "1", "]"}], 
                RowBox[{"trR", "[", "2", "]"}]}], "+", 
               RowBox[{"2", 
                RowBox[{"trR", "[", "3", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"trR", "[", "1", "]"}], "^", "4"}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
                RowBox[{"trR", "[", "2", "]"}]}], "-", 
               RowBox[{
                RowBox[{"trR", "[", "2", "]"}], "^", "2"}], "+", 
               RowBox[{"2", 
                RowBox[{"trR", "[", "4", "]"}]}]}]}], "}"}], "]"}], "]"}], 
          ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "2", "]"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"al$p", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(11)(1,1)]\>\"", "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "2", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<IID-M2(10)\>\"", "]"}], ",", 
               RowBox[{"Return", "[", "\"\<IID-M2(11)\>\"", "]"}]}], "]"}]}], 
            ",", 
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "3", "]"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}]}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], 
                  RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"al$p", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}]}], ")"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                  RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"al$p", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [(11),2]\>\"", "]"}], ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<IID-M3(100)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<IID-M3(110)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{"3", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "3"}], "ID$4"}]}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<IID-M3(011)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "-", 
                    RowBox[{"4", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "^", "3"}], "ID$4"}]}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<IID-M3(101)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<IID-M3(111)\>\"", "]"}]}], "]"}]}],
             ",", "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [2,2]??\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<IID-G(1111)\>\"", "]"}]}]}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b4$", "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], 
            RowBox[{
             RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "+", 
           RowBox[{"16", 
            RowBox[{
             RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
            RowBox[{"trR", "[", "2", "]"}]}], "-", 
           RowBox[{"7", 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "-", 
           RowBox[{"12", 
            RowBox[{"trR", "[", "1", "]"}], 
            RowBox[{"trR", "[", "3", "]"}]}], "+", 
           RowBox[{"6", 
            RowBox[{"trR", "[", "4", "]"}]}]}], "]"}]}], ";", 
        RowBox[{"c6$", "=", 
         RowBox[{"FaSi", "[", 
          RowBox[{
           RowBox[{"4", 
            RowBox[{
             RowBox[{"trR", "[", "1", "]"}], "^", "6"}]}], "-", 
           RowBox[{"24", 
            RowBox[{
             RowBox[{"trR", "[", "1", "]"}], "^", "4"}], 
            RowBox[{"trR", "[", "2", "]"}]}], "+", 
           RowBox[{"39", 
            RowBox[{
             RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "-", 
           RowBox[{"8", 
            RowBox[{
             RowBox[{"trR", "[", "2", "]"}], "^", "3"}]}], "+", 
           RowBox[{"12", 
            RowBox[{
             RowBox[{"trR", "[", "1", "]"}], "^", "3"}], 
            RowBox[{"trR", "[", "3", "]"}]}], "-", 
           RowBox[{"36", 
            RowBox[{"trR", "[", "1", "]"}], 
            RowBox[{"trR", "[", "2", "]"}], 
            RowBox[{"trR", "[", "3", "]"}]}], "+", 
           RowBox[{"12", 
            RowBox[{
             RowBox[{"trR", "[", "3", "]"}], "^", "2"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "III"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"{", 
            RowBox[{"b4$", ",", "c6$"}], "}"}], "]"}], ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "2", "]"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"al$p", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Segre [(111),1] or [1(11,1)] (Perfect fluid)\>\"", "]"}], 
             ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "2", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}],
                  ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<III-M2(01)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "2", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<III-M2(10)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<III-M2(11)\>\"", "]"}]}], "]"}]}], 
            ",", 
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "3", "]"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}]}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], 
                  RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"al$p", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}]}], ")"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                  RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"al$p", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [1(1,2)]\>\"", "]"}], ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<III-M3(100)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<III-M3(110)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{"3", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "3"}], "ID$4"}]}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "1", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<III-M3(011)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "-", 
                    RowBox[{"4", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "^", "3"}], "ID$4"}]}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<III-M3(101)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<III-M3(111)\>\"", "]"}]}], "]"}]}],
             ",", "True", ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [1,3]\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "\"\<III-G(1111)\>\"", "]"}]}]}], "]"}]}],
          "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "II"}], "**)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"b4$", "^", "3"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"c6$", "-", 
                RowBox[{"3", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "+", 
                   RowBox[{"2", 
                    RowBox[{"trR", "[", "2", "]"}]}]}], ")"}], "b4$"}]}], 
               ")"}], "^", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"testSolve", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"SM$", "[", "3", "]"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}], "+", 
                    RowBox[{"al$p", "[", "3", "]"}]}], ")"}], 
                  RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"al$p", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"al$p", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "3", "]"}], 
                    RowBox[{"al$p", "[", "1", "]"}]}]}], ")"}], 
                  RowBox[{"SM$", "[", "1", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"al$p", "[", "1", "]"}], 
                  RowBox[{"al$p", "[", "2", "]"}], 
                  RowBox[{"al$p", "[", "3", "]"}], "ID$4"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"al$p", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Segre [11(1,1)] or [(11)1,1] or \
[(11),Z\\!\\(\\*OverscriptBox[\\\"Z\\\", \\\"_\\\"]\\)]\>\"", "]"}], ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "ID$4"}]}], "]"}], "]"}],
                  ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(001)\>\"", "]"}], ",", 
               RowBox[{"(*", "Impossible", "*)"}], 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(010)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(100)\>\"", "]"}], ",", 
               RowBox[{"(*", "Impossible", "*)"}], 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"al$p", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "^", "2"}]}], ")"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "+", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], "ID$4"}]}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"al$p", "/@", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(011)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], "-", 
                    RowBox[{"al$p", "[", "2", "]"}]}], ")"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"al$p", "[", "1", "]"}], 
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "^", "2"}], "ID$4"}]}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"al$p", "/@", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(101)\>\"", "]"}], ",", 
               RowBox[{"testSolve", "[", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"SM$", "[", "3", "]"}], "-", 
                    RowBox[{"2", 
                    RowBox[{"al$p", "[", "2", "]"}], 
                    RowBox[{"SM$", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"al$p", "[", "2", "]"}], "^", "2"}], 
                    RowBox[{"SM$", "[", "1", "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"al$p", "[", "2", "]"}]}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-M3(110)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<II-M3(111)\>\"", "]"}]}], "]"}]}], 
            ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Segre [11,2]\>\"", "]"}], ";", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "+", 
                    RowBox[{"trR", "[", "3", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"trR", "[", "2", "]"}]}]}], "}"}], "]"}], "]"}], 
               ",", 
               RowBox[{"Return", "[", "\"\<II-G(1001)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"trR", "[", "2", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"8", 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "-", 
                    RowBox[{"8", 
                    RowBox[{"trR", "[", "1", "]"}], 
                    RowBox[{"trR", "[", "3", "]"}]}], "+", 
                    RowBox[{"3", 
                    RowBox[{"trR", "[", "4", "]"}]}]}]}], "}"}], "]"}], "]"}],
                ",", 
               RowBox[{"Return", "[", "\"\<II-G(1010)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"4", 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "-", 
                    RowBox[{"4", 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
                    RowBox[{"trR", "[", "2", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"trR", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{"trR", "[", "4", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "-", 
                    RowBox[{"3", 
                    RowBox[{"trR", "[", "1", "]"}], 
                    RowBox[{"trR", "[", "2", "]"}]}], "+", 
                    RowBox[{"trR", "[", "3", "]"}]}]}], "}"}], "]"}], "]"}], 
               ",", 
               RowBox[{"Return", "[", "\"\<II-G(1100)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "-", 
                  RowBox[{"trR", "[", "2", "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(1011)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "-", 
                  RowBox[{"3", 
                   RowBox[{"trR", "[", "1", "]"}], 
                   RowBox[{"trR", "[", "2", "]"}]}], "+", 
                  RowBox[{"trR", "[", "3", "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(1101)\>\"", "]"}], ",", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"FaSi", "[", 
                 RowBox[{
                  RowBox[{"4", 
                   RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "-", 
                  RowBox[{"12", 
                   RowBox[{
                    RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
                   RowBox[{"trR", "[", "2", "]"}]}], "+", 
                  RowBox[{"3", 
                   RowBox[{
                    RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
                  RowBox[{"8", 
                   RowBox[{"trR", "[", "1", "]"}], 
                   RowBox[{"trR", "[", "3", "]"}]}], "-", 
                  RowBox[{"3", 
                   RowBox[{"trR", "[", "4", "]"}]}]}], "]"}], "]"}], ",", 
               RowBox[{"Return", "[", "\"\<II-G(1110)\>\"", "]"}], ",", 
               "True", ",", 
               RowBox[{"Return", "[", "\"\<II-G(1111)\>\"", "]"}]}], 
              "]"}]}]}], "]"}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Type", " ", "I"}], "**)"}], 
        RowBox[{
        "Print", "[", 
         "\"\<Segre [111,1] or [11,Z\\!\\(\\*OverscriptBox[\\\"Z\\\", \\\"_\\\
\"]\\)]\>\"", "]"}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "+", 
               RowBox[{"trR", "[", "3", "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "+", 
               RowBox[{"trR", "[", "2", "]"}]}]}], "}"}], "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(1001)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "+", 
               RowBox[{"trR", "[", "2", "]"}]}], ",", 
              RowBox[{
               RowBox[{"8", 
                RowBox[{
                 RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "-", 
               RowBox[{"8", 
                RowBox[{"trR", "[", "1", "]"}], 
                RowBox[{"trR", "[", "3", "]"}]}], "+", 
               RowBox[{"3", 
                RowBox[{"trR", "[", "4", "]"}]}]}]}], "}"}], "]"}], "]"}], 
          ",", 
          RowBox[{"Return", "[", "\"\<I-G(1010)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaS", "[", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{
               RowBox[{"trR", "[", "1", "]"}], "^", "2"}]}], "-", 
             RowBox[{"trR", "[", "2", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(1011)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{
               RowBox[{"trR", "[", "1", "]"}], "^", "3"}]}], "-", 
             RowBox[{"3", 
              RowBox[{"trR", "[", "1", "]"}], 
              RowBox[{"trR", "[", "2", "]"}]}], "+", 
             RowBox[{"trR", "[", "3", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(1101)\>\"", "]"}], ",", 
          RowBox[{"zeroQ", "[", 
           RowBox[{"FaSi", "[", 
            RowBox[{
             RowBox[{"4", 
              RowBox[{
               RowBox[{"trR", "[", "1", "]"}], "^", "4"}]}], "-", 
             RowBox[{"12", 
              RowBox[{
               RowBox[{"trR", "[", "1", "]"}], "^", "2"}], 
              RowBox[{"trR", "[", "2", "]"}]}], "+", 
             RowBox[{"3", 
              RowBox[{
               RowBox[{"trR", "[", "2", "]"}], "^", "2"}]}], "+", 
             RowBox[{"8", 
              RowBox[{"trR", "[", "1", "]"}], 
              RowBox[{"trR", "[", "3", "]"}]}], "-", 
             RowBox[{"3", 
              RowBox[{"trR", "[", "4", "]"}]}]}], "]"}], "]"}], ",", 
          RowBox[{"Return", "[", "\"\<I-G(1110)\>\"", "]"}], ",", "True", ",", 
          RowBox[{"Return", "[", "\"\<I-G(1111)\>\"", "]"}]}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"$PrePrint", "=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ByteCount", "[", "#", "]"}], ">", "200000"}], ",", 
        RowBox[{"Short", "[", 
         RowBox[{"#", ",", "100"}], "]"}], ",", "#"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Protect", "[", 
     RowBox[{
     "cDcomp", ",", "CF3d", ",", "ConOne", ",", "c$D", ",", "dot$2", ",", 
      "LieDerv", ",", "dotAll", ",", "dotOne", ",", "epsilon", ",", "FacSimp",
       ",", "FaSi", ",", "GenCoef", ",", "indepTerms", ",", "indep$cTerms", 
      ",", "indexList", ",", "indx$Ruls", ",", "inn", ",", "metric", ",", 
      "M$F", ",", "MoveIndex", ",", "newPrList", ",", "numb1", ",", "numb2", 
      ",", "OKindCon", ",", "redPlus", ",", "redTimes", ",", "RiemSym", ",", 
      "zeroTensor", ",", "testSER", ",", "testSolve", ",", "tr$2", ",", 
      "OrdN"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"On", "[", 
     RowBox[{
      RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
      RowBox[{"General", "::", "\"\<spell1\>\""}], ",", 
      RowBox[{"UpSet", "::", "\"\<write\>\""}]}], "]"}], ";"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.808896168296957*^9, 3.808896200576788*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"95b95621-bd4a-4733-9524-63488c524120"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Classify\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Classify\\\", \\\"[\\\", \\\"x_\\\", \\\"]\\\"}]\\) is \
Protected.\"", 2, 109, 46, 27909425269158350314, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8868088844915333`*^9, 3.8875858072863865`*^9},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"83fffa2e-490d-45ec-87b4-6a50058cfaaf"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Bach-Weyl in external gravitational field (dipole+quadrupole only) \
\>", "Section",
 CellChangeTimes->{{3.816202991781142*^9, 3.816203003408774*^9}, 
   3.81620391774806*^9, {3.8162150070155773`*^9, 3.816215050657749*^9}, {
   3.821075663751465*^9, 3.821075717531461*^9}, {3.82251566641783*^9, 
   3.822515684320017*^9}, {3.822568510765444*^9, 3.82256852105307*^9}, {
   3.826668065454451*^9, 3.826668088831815*^9}, {3.828390121180155*^9, 
   3.828390156507822*^9}},ExpressionUUID->"2d29bc01-aa07-4d62-9c41-\
a0158f856d07"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"<<", "EDCRGTCcode"}], ".", "m"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7882637474342413`*^9, 3.788263761104501*^9}, 
   3.7887622016733*^9, 3.788762334722125*^9, {3.788788146642687*^9, 
   3.788788151224556*^9}, {3.789405806887298*^9, 3.7894058074527893`*^9}, {
   3.797886077937047*^9, 3.797886094750867*^9}, {3.798282365329887*^9, 
   3.7982823737967453`*^9}, {3.820207662155774*^9, 3.820207694309894*^9}, {
   3.8868089074558744`*^9, 3.8868089102468433`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"efe40f72-035a-4ff7-b61c-85bc0720f0ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xCoord", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "\[Rho]", ",", "z", ",", "\[Phi]"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gtt", "[", 
        RowBox[{"\[Rho]", ",", "z"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"g\[Rho]\[Rho]", "[", 
        RowBox[{"\[Rho]", ",", "z"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"g\[Rho]\[Rho]", "[", 
        RowBox[{"\[Rho]", ",", "z"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"g\[Phi]\[Phi]", "[", 
        RowBox[{"\[Rho]", ",", "z"}], "]"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"simpRules", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"TrigRules", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "n_"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}], ")"}]}], "/;", 
        RowBox[{"n", ">", "1"}]}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RGtensors", "[", 
    RowBox[{"g", ",", "xCoord"}], "]"}], " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.788261162470538*^9, 3.788261177410926*^9}, {
   3.788261958407078*^9, 3.7882620604203463`*^9}, {3.788262136345214*^9, 
   3.7882621620427017`*^9}, {3.788262243213032*^9, 3.788262364371111*^9}, {
   3.788263630598551*^9, 3.788263668357122*^9}, {3.7882637161691847`*^9, 
   3.788263719650735*^9}, {3.788790468500113*^9, 3.788790510728136*^9}, {
   3.788794585803482*^9, 3.788794589879018*^9}, {3.788847780228949*^9, 
   3.78884778689262*^9}, {3.7888478187667017`*^9, 3.788847826095735*^9}, {
   3.788849981715602*^9, 3.788849985561303*^9}, {3.788850121497656*^9, 
   3.7888501244700403`*^9}, {3.78893868656645*^9, 3.788938696456583*^9}, {
   3.78940581144098*^9, 3.789405821114646*^9}, {3.789449411110881*^9, 
   3.7894494197142982`*^9}, {3.789449453446063*^9, 3.789449560097208*^9}, {
   3.789449636395473*^9, 3.789449651252345*^9}, {3.791147064828475*^9, 
   3.7911470841663837`*^9}, {3.7911480570555277`*^9, 3.791148057217162*^9}, {
   3.7911481234760733`*^9, 3.791148132085471*^9}, {3.791148174692218*^9, 
   3.7911481848995323`*^9}, {3.7911486812885847`*^9, 3.791148686761629*^9}, 
   3.791188261402913*^9, 3.791193127272107*^9, 3.7911976877671423`*^9, 
   3.791198221095351*^9, 3.791496535265502*^9, 3.791566652832095*^9, {
   3.7915668692652273`*^9, 3.791566873469335*^9}, 3.791566944122773*^9, 
   3.791645823510737*^9, 3.791649389555009*^9, 3.791650605936816*^9, 
   3.791669383784144*^9, {3.791669421192273*^9, 3.791669422848761*^9}, 
   3.791671906200926*^9, {3.791818445930882*^9, 3.791818474022731*^9}, {
   3.7978860990764523`*^9, 3.797886149042838*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"2eb2438f-aac3-46bd-8c3f-498d8875195b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"gtt", "[", 
         RowBox[{"\[Rho]", ",", "z"}], "]"}], "0", "0", "0"},
       {"0", 
        RowBox[{"g\[Rho]\[Rho]", "[", 
         RowBox[{"\[Rho]", ",", "z"}], "]"}], "0", "0"},
       {"0", "0", 
        RowBox[{"g\[Rho]\[Rho]", "[", 
         RowBox[{"\[Rho]", ",", "z"}], "]"}], "0"},
       {"0", "0", "0", 
        RowBox[{"g\[Phi]\[Phi]", "[", 
         RowBox[{"\[Rho]", ",", "z"}], "]"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{
      $CellContext`gtt[$CellContext`\[Rho], $CellContext`z], 0, 0, 0}, {0, 
      $CellContext`g\[Rho]\[Rho][$CellContext`\[Rho], $CellContext`z], 0, 
      0}, {0, 0, 
      $CellContext`g\[Rho]\[Rho][$CellContext`\[Rho], $CellContext`z], 0}, {
     0, 0, 0, 
      $CellContext`g\[Phi]\[Phi][$CellContext`\[Rho], $CellContext`z]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858310977125`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"f191c221-3132-4e9b-9ac1-e352e5eb3ba4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "t", "]"}], "2"], " ", 
      RowBox[{"gtt", "[", 
       RowBox[{"\[Rho]", ",", "z"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "z", "]"}], "2"], " ", 
      RowBox[{"g\[Rho]\[Rho]", "[", 
       RowBox[{"\[Rho]", ",", "z"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "\[Rho]", "]"}], "2"], " ", 
      RowBox[{"g\[Rho]\[Rho]", "[", 
       RowBox[{"\[Rho]", ",", "z"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "\[Phi]", "]"}], "2"], " ", 
      RowBox[{"g\[Phi]\[Phi]", "[", 
       RowBox[{"\[Rho]", ",", "z"}], "]"}]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[$CellContext`d[$CellContext`t]^2 \
$CellContext`gtt[$CellContext`\[Rho], $CellContext`z] + \
$CellContext`d[$CellContext`z]^2 $CellContext`g\[Rho]\[Rho][$CellContext`\
\[Rho], $CellContext`z] + $CellContext`d[$CellContext`\[Rho]]^2 \
$CellContext`g\[Rho]\[Rho][$CellContext`\[Rho], $CellContext`z] + \
$CellContext`d[$CellContext`\[Phi]]^2 \
$CellContext`g\[Phi]\[Phi][$CellContext`\[Rho], $CellContext`z], 32]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.887585831099738*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"0d5e3576-b879-4a51-be36-4a47c83b6985"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         RowBox[{"gtt", "[", 
          RowBox[{"\[Rho]", ",", "z"}], "]"}]], "0", "0", "0"},
       {"0", 
        FractionBox["1", 
         RowBox[{"g\[Rho]\[Rho]", "[", 
          RowBox[{"\[Rho]", ",", "z"}], "]"}]], "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         RowBox[{"g\[Rho]\[Rho]", "[", 
          RowBox[{"\[Rho]", ",", "z"}], "]"}]], "0"},
       {"0", "0", "0", 
        FractionBox["1", 
         RowBox[{"g\[Phi]\[Phi]", "[", 
          RowBox[{"\[Rho]", ",", "z"}], "]"}]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{$CellContext`gtt[$CellContext`\[Rho], $CellContext`z]^(-1), 0,
       0, 0}, {0, $CellContext`g\[Rho]\[Rho][$CellContext`\[Rho], \
$CellContext`z]^(-1), 0, 0}, {
     0, 0, $CellContext`g\[Rho]\[Rho][$CellContext`\[Rho], \
$CellContext`z]^(-1), 0}, {
     0, 0, 0, $CellContext`g\[Phi]\[Phi][$CellContext`\[Rho], \
$CellContext`z]^(-1)}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858311322827`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"a82d6be9-1b8e-48dc-8ab5-9aa03c5656f0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.887585831164797*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"06352e39-2812-4f8f-b594-818bd7df1fa9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858311728334`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"d5548665-2a1b-4e9c-90df-feedb639d833"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.887585831177841*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"6f03600d-4c68-4dc7-b7c5-f17b31911faf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858311826515`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"aa104beb-e543-4ad0-88c1-a69d73a49486"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858311826515`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"b56e5ffd-d712-42a6-9eec-9d45640ce5ae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Weyl computed in \"\>", "\[InvisibleSpace]", 
   "0.015000000000000568`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Weyl computed in ", 0.015000000000000568`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858311891613`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"d8d7dae9-11bc-407b-acc3-d7cb90e90bc8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Einstein computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Einstein computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858312050343`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"6a525012-5f01-4007-b53e-476617cc2c4a"],

Cell[BoxData["\<\"All tasks completed in 0.015625 seconds\"\>"], "Print",
 CellChangeTimes->{3.8210782385505247`*^9, 3.821078400860721*^9, 
  3.822395448482176*^9, 3.822400866774589*^9, 3.822515897741623*^9, 
  3.823472244186565*^9, 3.8237774101797857`*^9, 3.828390289142309*^9, 
  3.8868089007840776`*^9, 3.88680919893869*^9, 3.8875858312154903`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"90a25c6c-41fb-4c98-af78-353d33665a61"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.015625`", ",", 
   RowBox[{"{", 
    RowBox[{"Null", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.791148197805997*^9, 3.7911486910649033`*^9, 3.79118826253091*^9, 
   3.791191958158935*^9, 3.791193137681326*^9, 3.7911976893883677`*^9, 
   3.791197731234395*^9, 3.791198226080553*^9, 3.791496539414214*^9, 
   3.7915666573476267`*^9, 3.791566874543662*^9, 3.791566948421235*^9, {
   3.791645824825242*^9, 3.791645829977639*^9}, 3.791649393582891*^9, {
   3.791650606994244*^9, 3.7916506110379763`*^9}, 3.791669386725972*^9, 
   3.791669423812811*^9, {3.791818449715352*^9, 3.791818474739357*^9}, 
   3.7923359203394623`*^9, 3.7978861061384487`*^9, {3.7978861519231377`*^9, 
   3.79788615763968*^9}, 3.797890497206592*^9, 3.7979819475959997`*^9, 
   3.7980673278224*^9, 3.798444437933977*^9, 3.798465886411655*^9, 
   3.798557087604826*^9, 3.7988352093501577`*^9, 3.798893891252904*^9, 
   3.7988940307899714`*^9, 3.7988974895140123`*^9, 3.798905710086164*^9, 
   3.7989217257771797`*^9, 3.798923695126525*^9, 3.798923730432921*^9, 
   3.817044246594202*^9, 3.817046009044578*^9, 3.8171874119834957`*^9, 
   3.817190371719973*^9, 3.817203819635787*^9, 3.817214450344941*^9, 
   3.817242261779014*^9, 3.817958356244337*^9, 3.818057189373061*^9, 
   3.819262893935473*^9, 3.819368231323724*^9, 3.819745022178385*^9, 
   3.819746858393907*^9, 3.820207700141035*^9, 3.820333676686696*^9, 
   3.820933684907699*^9, {3.821078232627214*^9, 3.82107823865772*^9}, 
   3.8210784009559183`*^9, 3.8223954486452293`*^9, 3.822400866871051*^9, 
   3.822515897830731*^9, 3.823472244278307*^9, 3.823777410349965*^9, 
   3.8283902893053303`*^9, 3.886808900912554*^9, 3.886809923918538*^9, 
   3.887585831217074*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"9bce87db-e0a6-4334-b04f-bfe6b47e0ae2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"g\[Rho]\[Rho]", "[", 
   RowBox[{"\[Rho]_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", " ", "Cf", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"2", " ", "c1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"b", "[", "0", "]"}]}], "-", 
       RowBox[{"2", " ", "z", " ", 
        RowBox[{"b", "[", "1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"w1", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "1", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"w2", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"w3", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "1", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"w4", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "1", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "+", 
       RowBox[{"4", " ", "w1", " ", 
        RowBox[{"(", 
         RowBox[{"w1", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "w2"}], "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"w2", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "+", 
       RowBox[{"4", " ", "w3", " ", 
        RowBox[{"(", 
         RowBox[{"w3", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w3", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "w4"}], "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"w4", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "-", 
       RowBox[{"4", " ", "z", " ", 
        SuperscriptBox["\[Rho]", "2"], " ", 
        RowBox[{"b", "[", "1", "]"}], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox["\[Rho]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["\[Rho]", "4"], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "2", "]"}], "2"]}]}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w1", "-", "z", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w2", "-", "z", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "5"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w3", "-", "z", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w4", "-", "z", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "5"]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w1", "-", "w2", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w2", "-", "w3", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w1", "-", "w4", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"w3", "-", "w4", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
          SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Rho]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"w1", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Rho]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"w2", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"w1", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"w3", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Rho]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"w3", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"w2", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"w4", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Rho]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"w4", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797886182145092*^9, 3.7978861848645897`*^9}, {
   3.7978863678933764`*^9, 3.79788636973917*^9}, 3.7988352188206367`*^9, 
   3.7988357449470873`*^9, {3.79889707676612*^9, 3.7988970781690617`*^9}, {
   3.798897230522986*^9, 3.798897234531138*^9}, {3.798905613476857*^9, 
   3.798905659094733*^9}, {3.798905694337225*^9, 3.798905700512856*^9}, 
   3.798909857063644*^9, {3.798910014011989*^9, 3.798910028978436*^9}, 
   3.798923645353059*^9, {3.798923715004364*^9, 3.798923724037064*^9}, {
   3.8170442314377747`*^9, 3.8170442387344637`*^9}, {3.8170459889174557`*^9, 
   3.817046003133073*^9}, 3.817046157884552*^9, 3.817187393254776*^9, 
   3.817187446133431*^9, 3.817213012502447*^9, 3.8172130449297113`*^9, {
   3.8172422443159122`*^9, 3.817242253223624*^9}, 3.8197468511737127`*^9, {
   3.821078368756521*^9, 3.821078382549881*^9}, 3.8225159312015963`*^9, 
   3.828390325516608*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"dc70d80c-5a62-4479-ae68-58d9e2aa4f5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gtt", "[", 
   RowBox[{"\[Rho]_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"b", "[", "0", "]"}]}], "+", 
       RowBox[{"2", " ", "z", " ", 
        RowBox[{"b", "[", "1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"b", "[", "2", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], " ", 
        RowBox[{"b", "[", "2", "]"}]}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"w1", "-", "z", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
         SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"w3", "-", "z", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
         SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"w2", "-", "z", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
         SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"w4", "-", "z", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
         SuperscriptBox["\[Rho]", "2"]}]]}], 
      ")"}]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Phi]\[Phi]", "[", 
   RowBox[{"\[Rho]_", ",", "z_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"b", "[", "0", "]"}]}], "-", 
      RowBox[{"2", " ", "z", " ", 
       RowBox[{"b", "[", "1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"b", "[", "2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"b", "[", "2", "]"}]}]}]], " ", 
    SuperscriptBox["\[Rho]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"w2", "-", "z", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
        SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"w4", "-", "z", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
        SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w1", "-", "z", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
        SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"w3", "-", "z", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
        SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]]}]}], "Input",
 CellChangeTimes->{{3.797886203803812*^9, 3.797886222881604*^9}, {
  3.797886374258698*^9, 3.797886379512279*^9}, {3.798835222562726*^9, 
  3.7988352254317837`*^9}, {3.798835297298028*^9, 3.798835305797946*^9}, {
  3.798897166358191*^9, 3.798897180780836*^9}, {3.798897220670624*^9, 
  3.798897225051214*^9}, {3.798897470891962*^9, 3.798897482683716*^9}, {
  3.79890555680884*^9, 3.798905567500352*^9}, {3.798909845194973*^9, 
  3.798909852981945*^9}, {3.798922449223568*^9, 3.7989224536519117`*^9}, {
  3.798922484270968*^9, 3.7989224925463552`*^9}, {3.817044203227791*^9, 
  3.8170442165912933`*^9}, {3.8171873567121487`*^9, 3.81718737664755*^9}, {
  3.817212981948621*^9, 3.8172129907346573`*^9}, {3.8172420446036673`*^9, 
  3.817242051834993*^9}, {3.819746789090601*^9, 3.819746832106913*^9}, {
  3.8210783538376904`*^9, 3.821078360714753*^9}, {3.8225159499771338`*^9, 
  3.822515960775823*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"9ea29207-fe97-415f-8385-b1ea5bf593b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gt\[Phi]", "[", 
   RowBox[{"\[Rho]_", ",", "z_"}], "]"}], ":=", "0"}]], "Input",
 CellChangeTimes->{{3.798444743924076*^9, 3.7984447466941643`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"4be9e58c-b45e-4a37-bc23-d40d34570ebd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Einstein", " ", "Equations", " ", "are", " ", "fulfilled", " ", 
    RowBox[{"(", 
     RowBox[{
     "to", " ", "gain", " ", "speed", " ", "some", " ", "numerical", " ", 
      "set", " ", "of", " ", "values", " ", "for", " ", "the", " ", 
      "parameter", " ", "are", " ", "chosen"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"EUd", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w1", "\[Rule]", "1"}], ",", 
        RowBox[{"w2", "\[Rule]", "3"}], ",", 
        RowBox[{"w3", "\[Rule]", "5"}], ",", 
        RowBox[{"w4", "\[Rule]", "7"}], ",", 
        RowBox[{"Cf", "\[Rule]", "12"}], ",", 
        RowBox[{"z", "\[Rule]", "3"}], ",", 
        RowBox[{"\[Rho]", "\[Rule]", "17"}], ",", 
        RowBox[{
         RowBox[{"b", "[", "2", "]"}], "\[Rule]", 
         RowBox[{"3", "/", "2"}]}], ",", 
        RowBox[{
         RowBox[{"b", "[", "0", "]"}], "\[Rule]", 
         RowBox[{"1", "/", "2"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.81719055966952*^9, 3.817190590790447*^9, {3.817199977753283*^9, 
   3.81719997788737*^9}, {3.817200019887167*^9, 3.817200023179826*^9}, {
   3.8172021465368023`*^9, 3.8172021492156763`*^9}, {3.81720388834265*^9, 
   3.817203906974374*^9}, {3.8172093326351*^9, 3.817209336753036*^9}, {
   3.817209367652076*^9, 3.817209368265747*^9}, {3.8172133032983103`*^9, 
   3.8172133448899603`*^9}, {3.81724227779709*^9, 3.817242293396891*^9}, 
   3.8172423412983313`*^9, {3.8210784213779984`*^9, 3.821078465005831*^9}, 
   3.822516005546526*^9, {3.822516154501408*^9, 3.822516155723405*^9}, {
   3.828390349141388*^9, 3.8283904585076838`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"f2ab572e-d27d-42c4-a618-63a30a77284e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8875858817397203`*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"576ac34e-2f07-4804-9e38-205ea50c510b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelTable", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"EUd", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w1", "\[Rule]", "0"}], ",", 
       RowBox[{"w2", "\[Rule]", "4"}], ",", 
       RowBox[{"w3", "\[Rule]", "6"}], ",", 
       RowBox[{"w4", "\[Rule]", "8"}], ",", 
       RowBox[{"Cf", "\[Rule]", "11"}], ",", 
       RowBox[{"z", "\[Rule]", "2"}], ",", 
       RowBox[{"\[Rho]", "\[Rule]", "19"}], ",", 
       RowBox[{
        RowBox[{"b", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"5", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"b", "[", "0", "]"}], "\[Rule]", 
        RowBox[{"3", "/", "2"}]}], ",", 
       RowBox[{"c1", "\[Rule]", "0"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.822516060802421*^9, 3.8225161903135977`*^9}, {
  3.828390332069972*^9, 3.8283903463353243`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"e658ee95-5e5c-4607-b198-0fe00c130b74"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.886809040450943*^9, 3.887585948472227*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"921da252-789a-4a7f-a0d2-aafafe555316"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelTable", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"EUd", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w1", "\[Rule]", "0"}], ",", 
       RowBox[{"w2", "\[Rule]", "4"}], ",", 
       RowBox[{"w3", "\[Rule]", "6"}], ",", 
       RowBox[{"w4", "\[Rule]", "8"}], ",", 
       RowBox[{"Cf", "\[Rule]", "11"}], ",", 
       RowBox[{"z", "\[Rule]", "5"}], ",", 
       RowBox[{"\[Rho]", "\[Rule]", "19"}], ",", 
       RowBox[{
        RowBox[{"b", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"5", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"b", "[", "0", "]"}], "\[Rule]", 
        RowBox[{"3", "/", "2"}]}], ",", 
       RowBox[{"c1", "\[Rule]", "0"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.822516217414637*^9, 3.8225162177072*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"2cbd7496-3fbc-476e-8c62-7366c3a6682a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.822516341293543*^9, 3.828390533444949*^9, 
  3.886809198724615*^9, 3.8875862631522775`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"91988c74-2022-4d2f-842d-b2dead61e77f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["gdd"], "Input",
 CellChangeTimes->{{3.822400885187072*^9, 3.8224008879729013`*^9}, 
   3.822517285930735*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"278f5562-22f8-4d08-b572-9650c58b62fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"b", "[", "0", "]"}]}], "+", 
          RowBox[{"2", " ", "z", " ", 
           RowBox[{"b", "[", "1", "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}]}]], " ", 
        RowBox[{"(", 
         RowBox[{"w1", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"w3", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w2", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"w4", "-", "z", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
            SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]]}], ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"16", " ", "Cf", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"2", " ", "c1"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"b", "[", "0", "]"}]}], "-", 
          RowBox[{"2", " ", "z", " ", 
           RowBox[{"b", "[", "1", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w1", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w2", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w3", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w4", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], " ", 
           SuperscriptBox[
            RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{"4", " ", "w1", " ", 
           RowBox[{"(", 
            RowBox[{"w1", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w1", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "w2"}], "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"w2", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{"4", " ", "w3", " ", 
           RowBox[{"(", 
            RowBox[{"w3", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w3", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "w4"}], "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"w4", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{"4", " ", "z", " ", 
           SuperscriptBox["\[Rho]", "2"], " ", 
           RowBox[{"b", "[", "1", "]"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox["\[Rho]", "2"], " ", 
           SuperscriptBox[
            RowBox[{"b", "[", "2", "]"}], "2"]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           SuperscriptBox["\[Rho]", "4"], " ", 
           SuperscriptBox[
            RowBox[{"b", "[", "2", "]"}], "2"]}]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w2", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "5"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w3", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w4", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "5"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "w2", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w2", "-", "w3", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "w4", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w3", "-", "w4", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w1", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w2", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w1", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"w3", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]}], ")"}], "2"], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w3", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w2", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"w4", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]}], ")"}], "2"], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w4", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}]}], 
       ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"16", " ", "Cf", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"2", " ", "c1"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"b", "[", "0", "]"}]}], "-", 
          RowBox[{"2", " ", "z", " ", 
           RowBox[{"b", "[", "1", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w1", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w2", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w3", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"w4", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "1", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], " ", 
           SuperscriptBox[
            RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{"4", " ", "w1", " ", 
           RowBox[{"(", 
            RowBox[{"w1", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w1", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "w2"}], "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"w2", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{"4", " ", "w3", " ", 
           RowBox[{"(", 
            RowBox[{"w3", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w3", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "w4"}], "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"w4", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{"4", " ", "z", " ", 
           SuperscriptBox["\[Rho]", "2"], " ", 
           RowBox[{"b", "[", "1", "]"}], " ", 
           RowBox[{"b", "[", "2", "]"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox["\[Rho]", "2"], " ", 
           SuperscriptBox[
            RowBox[{"b", "[", "2", "]"}], "2"]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           SuperscriptBox["\[Rho]", "4"], " ", 
           SuperscriptBox[
            RowBox[{"b", "[", "2", "]"}], "2"]}]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w2", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "5"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w3", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w4", "-", "z", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "5"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "w2", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w2", "-", "w3", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w1", "-", "w4", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w3", "-", "w4", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]], "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
             SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w1", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w2", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w1", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"w3", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]}], ")"}], "2"], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w3", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w2", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"w4", "-", "z", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
                SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]}], ")"}], "2"], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w4", "-", "z", "+", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
               SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], "2"]}], ")"}]}], 
       ")"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"b", "[", "0", "]"}]}], "-", 
         RowBox[{"2", " ", "z", " ", 
          RowBox[{"b", "[", "1", "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["z", "2"], " ", 
          RowBox[{"b", "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], " ", 
          RowBox[{"b", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"w2", "-", "z", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w2", "-", "z"}], ")"}], "2"], "+", 
           SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"w4", "-", "z", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w4", "-", "z"}], ")"}], "2"], "+", 
           SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"w1", "-", "z", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w1", "-", "z"}], ")"}], "2"], "+", 
           SuperscriptBox["\[Rho]", "2"]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"w3", "-", "z", "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w3", "-", "z"}], ")"}], "2"], "+", 
           SuperscriptBox["\[Rho]", "2"]}]]}], ")"}]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.822517286642857*^9, 3.8283906012112417`*^9, 
  3.8875862633045073`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"2683cc78-533e-48d4-be61-ae896de9448c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 472},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"000285b9-395a-401d-96f5-46f8355b464a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 172, 3, 98, "Title",ExpressionUUID->"fc423760-45d4-40f3-aabe-a95f96d1c21d"],
Cell[CellGroupData[{
Cell[777, 29, 291, 4, 67, "Section",ExpressionUUID->"fd81dfb5-26cd-4d84-81af-14ec576f95e6"],
Cell[CellGroupData[{
Cell[1093, 37, 348757, 9083, 24334, "Input",ExpressionUUID->"95b95621-bd4a-4733-9524-63488c524120"],
Cell[349853, 9122, 459, 10, 28, "Message",ExpressionUUID->"83fffa2e-490d-45ec-87b4-6a50058cfaaf"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[350361, 9138, 534, 9, 53, "Section",ExpressionUUID->"2d29bc01-aa07-4d62-9c41-a0158f856d07"],
Cell[350898, 9149, 601, 11, 28, "Input",ExpressionUUID->"efe40f72-035a-4ff7-b61c-85bc0720f0ff"],
Cell[CellGroupData[{
Cell[351524, 9164, 3358, 75, 86, "Input",ExpressionUUID->"2eb2438f-aac3-46bd-8c3f-498d8875195b"],
Cell[CellGroupData[{
Cell[354907, 9243, 1758, 43, 72, "Print",ExpressionUUID->"f191c221-3132-4e9b-9ac1-e352e5eb3ba4"],
Cell[356668, 9288, 1698, 41, 23, "Print",ExpressionUUID->"0d5e3576-b879-4a51-be36-4a47c83b6985"],
Cell[358369, 9331, 1878, 47, 112, "Print",ExpressionUUID->"a82d6be9-1b8e-48dc-8ab5-9aa03c5656f0"],
Cell[360250, 9380, 602, 12, 22, "Print",ExpressionUUID->"06352e39-2812-4f8f-b594-818bd7df1fa9"],
Cell[360855, 9394, 608, 12, 22, "Print",ExpressionUUID->"d5548665-2a1b-4e9c-90df-feedb639d833"],
Cell[361466, 9408, 622, 12, 22, "Print",ExpressionUUID->"6f03600d-4c68-4dc7-b7c5-f17b31911faf"],
Cell[362091, 9422, 624, 12, 22, "Print",ExpressionUUID->"aa104beb-e543-4ad0-88c1-a69d73a49486"],
Cell[362718, 9436, 608, 12, 22, "Print",ExpressionUUID->"b56e5ffd-d712-42a6-9eec-9d45640ce5ae"],
Cell[363329, 9450, 643, 12, 22, "Print",ExpressionUUID->"d8d7dae9-11bc-407b-acc3-d7cb90e90bc8"],
Cell[363975, 9464, 614, 12, 22, "Print",ExpressionUUID->"6a525012-5f01-4007-b53e-476617cc2c4a"],
Cell[364592, 9478, 457, 7, 22, "Print",ExpressionUUID->"90a25c6c-41fb-4c98-af78-353d33665a61"]
}, Open  ]],
Cell[365064, 9488, 1838, 30, 32, "Output",ExpressionUUID->"9bce87db-e0a6-4334-b04f-bfe6b47e0ae2"]
}, Open  ]],
Cell[366917, 9521, 12586, 363, 269, "Input",ExpressionUUID->"dc70d80c-5a62-4479-ae68-58d9e2aa4f5d"],
Cell[379506, 9886, 4194, 119, 137, "Input",ExpressionUUID->"9ea29207-fe97-415f-8385-b1ea5bf593b7"],
Cell[383703, 10007, 267, 6, 28, "Input",ExpressionUUID->"4be9e58c-b45e-4a37-bc23-d40d34570ebd"],
Cell[CellGroupData[{
Cell[383995, 10017, 2084, 47, 67, "Input",ExpressionUUID->"f2ab572e-d27d-42c4-a618-63a30a77284e"],
Cell[386082, 10066, 496, 13, 32, "Output",ExpressionUUID->"576ac34e-2f07-4804-9e38-205ea50c510b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[386615, 10084, 1181, 31, 67, "Input",ExpressionUUID->"e658ee95-5e5c-4607-b198-0fe00c130b74"],
Cell[387799, 10117, 516, 13, 32, "Output",ExpressionUUID->"921da252-789a-4a7f-a0d2-aafafe555316"]
}, Open  ]],
Cell[CellGroupData[{
Cell[388352, 10135, 1126, 30, 67, "Input",ExpressionUUID->"2cbd7496-3fbc-476e-8c62-7366c3a6682a"],
Cell[389481, 10167, 565, 14, 32, "Output",ExpressionUUID->"91988c74-2022-4d2f-842d-b2dead61e77f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390083, 10186, 206, 4, 28, "Input",ExpressionUUID->"278f5562-22f8-4d08-b572-9650c58b62fb"],
Cell[390292, 10192, 28872, 807, 546, "Output",ExpressionUUID->"2683cc78-533e-48d4-be61-ae896de9448c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

